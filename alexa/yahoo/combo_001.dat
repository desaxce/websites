YUI.add("autohide_service",function(h){var f=h.ModulePlatform,b={},e=-1,a,c="MPServices",g="AutoHideProvider";a={register:function(i){b[++e]=i;if(!i.triggers){i.triggers=["click"];}return e;},unregister:function(i){delete b[i];}};function d(i){h.Object.each(b,function(n){if(h.Array.indexOf(n.triggers,i.type)>-1){var o=i.target,k=n.targets,l=true,m=0,j=k.length;if(!o.inDoc(document)){l=false;}else{for(;m<j&&l;m++){if(o.compareTo(k[m])||(k[m]&&k[m].contains(o))){l=false;}}}if(l){n.hide();}}});}h.on("click",d,document);h.on("keydown",d,document);h.on("unload",function(){h.detach("click",d,document);h.detach("keydown",d,document);},window);h.namespace(c);h[c][g]={name:"autohide",getService:function(){return a;}};if(f){f.registerService(h[c][g]);}},"1.0");/* Copyright (c) 2014, Yahoo! Inc.  All rights reserved. */
YUI.add("sethomepage_service",function(a){var C=null,w=false,h=true,n=a.ModulePlatform,D,q,j=a.Cookie,p=a.UA,g="MPServices",s="SetHomepageProvider",b="m.",e="click",f="HP",i="ilc",c="keydown",o=27,k="mousedown",y="y-hpset-show",l,B;function t(E){j.set(i,E,{domain:q});}function r(){return j.get(i);}function v(F,E){j.set(f,E,{domain:".yahoo.com"});if(F){t(F);}}function m(){return j.get(f);}function u(E){E=!a.Lang.isUndefined(E)?E:r();var F=window.location.host;if(F.indexOf(b)===0){F=F.substring(2);}return"http://"+F+"/"+(E?"?ilc="+E:"");}function A(){if(l){return true;}return false;}function d(F){var E,H=w;if(l){E=u(F);try{l.setHomePage(E);}catch(G){}H=l.isHomePage(E);if(H){v(F,"1");}}return H;}function z(E){var F=w;if(j.get(f)==1){F=h;}else{if(p.ie){if(window.location.host.indexOf(b)===0){F=window.history.length==1;}else{F=window.history.length==((p.ie<10)?0:1);}}else{if((p.gecko||p.webkit)&&window.history.length==1){F=h;}else{if(p.opera&&window.history.length===0){F=h;}}}}return F;}function x(G,F){var E;G=a.one(G);F=F||{};G.on(e,this._handleClick,this);G.on(c,this._handleKeydown,this);G.on(k,this._handleMousedown,this);E=F.autohideTargets||[];E.push(G);this.autohide=D.getService("autohide");this.autohideId=this.autohide.register({targets:E,hide:a.bind(this.hide,this)});this.instrumentation=D.getService("instrumentation");this.overlay=G;this.options=F;}x.prototype={autohide:C,autohideId:C,instrumentation:C,options:C,overlay:C,_handleClick:function(F){var E=F.target;if(E.hasClass("hs-close")){this.hide();}else{if(E.hasClass("hs-drag-icon")){F.preventDefault();}}},_handleMousedown:function(E){if(E.target.hasClass("hs-drag-icon")){v(this.options.ilc,"1");this.instrumentation.fireBeacon(this.options.dragBeacon);}},_handleKeydown:function(E){if(E.keyCode==o){this.hide();}},getRootNode:function(){return this.overlay;},hide:function(){this.overlay.removeClass(y);},show:function(){var E=this.overlay,F=E.one("h3");E.addClass(y);F.setAttribute("tabIndex","-1").focus();},toggle:function(){if(this.overlay.hasClass(y)){this.hide();}else{this.show();}},destroy:function(){var E=this.overlay;this.hide();E.detach(e,this._handleClick);E.detach(c,this._handleKeydown);E.detach(k,this._handleMousedown);this.autohide.unregister(this.autohideId);this.overlay=C;}};B={createOverlay:function(F,E){return new x(F,E);},isHomepageSet:z,getHpCookie:m,setHpCookie:v,getIlcCookie:r,setIlcCookie:t,setIEHomepage:d,testIESetHomepage:A};a.namespace(g);a[g][s]={name:"sethomepage",getService:function(F,E){if(!D){D=F;q=D.getProperty("cookieDomain");}if(a.UA.ie&&!l){l=document.createElement("DIV");l.id="y-ieshp";l.style.behavior="url(#default#homepage)";document.body.appendChild(l);}return B;}};if(n){n.registerService(a[g][s]);}},"1.0");/* Copyright (c) 2014, Yahoo! Inc.  All rights reserved. */
YUI.add("lazy_image",function(f){var c=f.ModulePlatform,g="lzbg",a="MPServices",e="LazyImageProvider",b;function d(i){var h;if(i.test("img")){h=i.getStyle("backgroundImage");if(/url\(['"](.*?)['"]\)/.test(h)){}else{/url\(["']?(.*?)["']?\)/.test(h);}h=RegExp.$1;if(h&&h.length>0){i.set("src",h);i.setStyle("backgroundImage","");}}i.removeClass(g);}f.later(0,this,function(){var h=f.DOM.viewportRegion(),i=h.bottom+250;f.all("."+g).each(function(j){if((j.getY()<=i)&&(j.get("offsetHeight")>0&&j.get("offsetWidth")>0)){d(j);}});f.onceAfter("scroll",function(j){f.all("."+g).each(function(k){f.later(0,this,d,k);});});});b={LAZY_IMAGE_CLASS:g,loadImage:d};f.namespace(a);f[a][e]={name:"lazyimage",getService:function(i,h){return b;}};if(c){c.registerService(f[a][e]);}},"0.0.1",{requires:["dom","node"]});/* Copyright (c) 2014, Yahoo! Inc.  All rights reserved. */
YUI.add("sticky_position_service",function(h){var f=h.ModulePlatform,b,e,c="MPServices",g="StickyPositionProvider",d=h.Lang,a=[];e=function(j){if(!d.isObject(j)||d.isArray(j)||d.isFunction(j)){throw new Error("sticky service requires an object");}h.Object.each(j,function i(m,l){var n=h.one(l),k;if(!n){return;}if(m.onSticky&&!d.isFunction(m.onSticky)||m.onLoose&&!d.isFunction(m.onLoose)){return;}k=h.Node.create('<div class="sticky-pholder"></div>');n.insert(k,"before");a.push({node:n,top:m.top||0,onSticky:m.onSticky,onLoose:m.onLoose,threshold:k.getY()+n.get("offsetHeight"),pHolderWidth:k.get("offsetWidth"),pHolder:k});});return this;};e.prototype={trigger:function(i,k,j,l){h.Array.each(a,function m(t){var o=t.threshold,p=t.node,s=t.top,q=t.nodeHeight||p.get("offsetHeight"),n=t.stickyToTop,r;if(j==="resize"){t.pHolderWidth=t.pHolder.get("offsetWidth");t.stickyToTop=i.height-t.top>q;n=t.stickyToTop;}if(n){r=o-k-s<=0;}else{r=o-(k+i.height)<=0;}if(r&&!t.disabled&&k!==0&&(h.Lang.isFunction(l)&&l())){if(j==="resize"||!p.hasClass("sticky")){p.addClass("sticky");p.setStyle("width",t.pHolderWidth);t.pHolder.setStyle("height",q);if(n){t.onSticky(p,"top");}else{t.onSticky(p,"bottom");}}}else{p.removeClass("sticky");t.pHolder.setStyle("height","");t.onLoose(p);}});},recalculateThresholds:function(i){var j=h.DOM.docHeight();h.Array.each(a,function k(m){var o=m.node,p=o.get("offsetHeight"),n=m.pHolder.getY(),l=i.height-m.top>p;if(l){m.threshold=n;}else{m.threshold=n+p;}m.stickyToTop=l;m.nodeHeight=p;m.disabled=(j===m.threshold);});}};h.namespace(c);h[c][g]={name:"sticky_position",getService:function(k,j){var i=h.one("html").hasClass("dev-desktop");if(!b){b=k;}if(h.UA.ie!==0&&h.UA.ie<7||i&&(h.UA.os==="android"||h.UA.os==="ios")){return false;}return e;}};if(f){f.registerService(h[c][g]);}},"0.0.1");/* Copyright (c) 2014, Yahoo! Inc.  All rights reserved. */
YUI.add("userinfo_service",function(g){var d=null,c=g.ModulePlatform,a=d,f,b="MPServices",e="UserInfoProvider";f={getDisplayName:function(){return a.getProperty("user");},isLoggedIn:function(){return !!a.getProperty("user");},isRecognized:function(){return !!a.getProperty("userRecognized");},getLocation:function(){var i={},l=a.getProperty("userLocation"),j=["zip","city","state","country","woeid","lat","lon"],h=j.length,k;if(l){while((k=j[--h])){i[k]=l[k]||null;}}return i;}};g.namespace(b);g[b][e]={name:"userinfo",getService:function(i,h){if(!a){a=i;}return f;}};if(c){c.registerService(g[b][e]);}},"1.0");/* Copyright (c) 2014, Yahoo! Inc.  All rights reserved. */
YUI.add("statemgr_service",function(b){var k=b.ModulePlatform,g="MPServices",m="StateMgrProvider",j="MSC",i="fpps",e="fpms",p="_page",l,h,c,d,r,o;function f(){var t=new Date();t.setFullYear(t.getFullYear()+1);return t;}function s(x,v,u){var w=h.getSub(x,v),t=null;if(w){t=c.parse(w)[u];}return t;}function a(z,w,t){var y=h.getSub(z,w),x,v,u;if(y){x=c.parse(y);delete x[t];v=c.stringify(x);u={expires:f(),domain:l,path:"/"};if(v=="{}"){h.removeSub(z,w,u);}else{h.setSub(z,w,v,u);}}}function q(y,u,t,w){var x=h.getSub(y,u),v=x?b.JSON.parse(x):{};v[t]=w;h.setSub(y,u,c.stringify(v),{expires:f(),domain:l,path:"/"});}function n(t){if(!d[t]){d[t]=r.getModuleApi(t).getProperty("trusted")?b.Object(o):{};b.mix(d[t],{getUserModuleState:function(u){return s(e,t,u);},removeUserModuleState:function(u){a(e,t,u);},setUserModuleState:function(u,v){q(e,t,u,v);},saveUserSetting:function(w,x,u){var v=k.getService("userinfo");if(v.isLoggedIn()){u.makeRequest({type:"module",moduleId:u.getId(),args:{_action:"save",_subAction:"userPrefSave",key:w,value:x,noups:1}},{});}else{this.setUserModuleState(w,x);this.update();}}});}return d[t];}o={isUpdated:function(){return !!h.get(j);},update:function(){h.setSub(j,"mod","1",{domain:l,path:"/"});},getUserPageState:function(t){return s(i,p,t);},removeUserPageState:function(t){a(i,p,t);},setUserPageState:function(t,u){q(i,p,t,u);}};b.namespace(g);b[g][m]={name:"statemgr",getService:function(u,t){r=u;h=b.Cookie;c=b.JSON;l=u.getProperty("cookieDomain")||b.config.win.location.hostname;if(!d){d={};}return !t?o:n(t);},destroy:function(){d=null;}};if(k){k.registerService(b[g][m]);}},"1.0");/* Copyright (c) 2014, Yahoo! Inc.  All rights reserved. */
YUI.add("modal_service",function(b){var l=b.ModulePlatform,u,n,g="MPServices",m="ModalProvider",c=(function(){
/*! IS_POSITION_FIXED_SUPPORTED - https://gist.github.com/bobslaede/1221602/ */
var A=document.createElement("div"),z=A.cloneNode(false),w=false,v=document.body||(function(){w=true;return document.documentElement.appendChild(document.createElement("body"));}()),y,x;y=v.style.cssText;v.style.cssText="padding:0;margin:0";A.style.cssText="position:fixed;top:42px";v.appendChild(A);v.appendChild(z);x=A.offsetTop!==z.offsetTop;v.removeChild(A);v.removeChild(z);v.style.cssText=y;if(w){document.documentElement.removeChild(v);}return x;}()),k="modal",r="y-modal",f="y-modal-mask",i="px",s="100%",p="display",j="none",q="0",t=null,d=50,e=100,h=true,o=false;function a(x){var v=b.Node.create("<div></div>"),y=x.width||e,B=b.one(x.srcNode),w=b.one("body").get("dir")==="rtl",A={},z=-Math.floor(y/2);this.modalMask=a._getMask(x);this.modalBody=v;v.addClass(r+" "+x.className);A={width:y,display:j};if(w===true){A.marginRight=z;}else{A.marginLeft=z;}v.setStyles(A);v.append(B);this.modalMask.append(this.modalBody);if(!c){this.listener=b.on("scroll",this._resyncMask,this);}}a._getMask=function(x){var w=b.one("."+f)||t,y,v,z;if(w){return w;}else{v=b.one(document.body);z=b.Object.getValue(x,["zIndex"])||d;w=b.Node.create('<div><div class="y-modal-mask-bg"></div></div>');w.addClass(f);if(c){w.setStyles({position:"fixed",width:s,height:s,top:q,left:q,display:j,zIndex:z});}else{y=b.config.win;w.setStyles({position:"absolute",width:y.get("winWidth")+i,height:y.get("winHeight")+i,top:q,left:q,display:j,zIndex:z});}v.append(w);return w;}};a.prototype={visible:o,setContent:function(v){this.modalBody.setContent(v);},show:function(){this.modalMask.all("."+r).setStyle(p,j);this.modalBody.setStyle(p,"");this.modalMask.setStyle(p,"");this.visible=h;if(!c){this._resyncMask(b.config.win);}this.modalMask.on("click",this.handleClick,this);this.modalBody.on("click",this.handleClick,this);},hide:function(){this.modalMask.setStyle(p,j);this.modalMask.all("."+r).setStyle(p,j);this.visible=o;},handleClick:function(x){var w=x.target,v=false;if(w.hasClass("y-modal-mask-bg")||w.hasClass("modal-close")){v=true;}if(v){this.hide();}},isVisible:function(){return this.visible;},destroy:function(){var v=this.modalMask.all("."+r);this.modalBody.remove();this.modalBody=t;if(v&&v.size()<2){if(this.listener){this.listener.detach();}this.modalMask.remove(true);this.modalMask=t;}},_resyncMask:function(A){if(!this.isVisible()){return;}var B=A.currentTarget||A,v=B.get("docScrollX"),C=B.get("docScrollY"),y=B.get("innerWidth")||B.get("winWidth"),z=B.get("innerHeight")||B.get("winHeight"),x=a._getMask();x.setStyles({top:C+i,left:v+i,width:y+i,height:z+i});}};n={create:function(v){return new a(v);}};b.namespace(g);b[g][m]={name:k,getService:function(w,v){if(!u){u=w;}return n;}};if(l){l.registerService(b[g][m]);}},"0.0.1");/* Copyright (c) 2014, Yahoo! Inc.  All rights reserved. */
YUI.add("tooltip_service",function(b){var m=b.ModulePlatform,n,d,e="MPServices",a="ToolTipProvider",i="hide",l="bottom",f="top",h=null,c="left",j="right",g="px";function k(p){var o;this.options=b.merge({position:{box:"b",arrow:"c"},msg:"<!-- empty -->",className:"y-tooltip-default",pointerClass:"y-glbl-universal",borderClass:"",parentNode:document.body,autohide:false,role:"alert",scrollIntoView:false},p);this.options.parentNode=b.one(this.options.parentNode);if(b.Lang.isArray(this.options.borderClass)){this.options.borderClass=this.options.borderClass.join(" ");}if(b.Lang.isArray(this.options.className)){this.options.className=this.options.className.join(" ");}if(b.Lang.isArray(this.options.pointerClass)){this.options.pointerClass=this.options.pointerClass.join(" ");}o="<div class='y-tooltip "+this.options.className+"'><div class='tooltip hide' role='"+this.options.role+"'><div class='content "+this.options.borderClass+"'></div><span class='"+this.options.pointerClass+" pointer'></span><div class='crnr-rt'></div><div class='crnr-rb'></div></div></div>";this.toolTipBody=b.Node.create(o);this.pointAtMe=h;this.toolTip=this.toolTipBody.one(".tooltip");this.content=this.toolTipBody.one(".content");this.pointer=this.toolTipBody.one(".pointer");this.autohideId=h;this.options.parentNode.insertBefore(this.toolTipBody,this.options.parentNode.get("firstChild"));if(this.options.autohide){this.autohideId=d.getService("autohide").register({targets:[this.toolTip],hide:b.bind(this.hide,this)});}}k.prototype={getNode:function(){return this.toolTipBody;},setContent:function(o){if(typeof(o)==="string"){this.content.set("innerHTML",o);}else{this.content.set("innerHTML","");this.content.appendChild(b.one(o));}return this.content;},positionToolTip:function(s,D){var u,A,z,w,t=D.msg,y=D.position.box,B=D.position.arrow,r=D.position.alignNode,q=this.toolTip,p=this.pointer,v,C,x=D.parentNode.getStyle("direction"),o=D.noMsgUpdate||false;if(x==="rtl"){if(y==="r"){y="l";}else{if(y==="l"){y="r";}}if(B==="l"){B="r";}else{if(B==="r"){B="l";}}}w=this.pointAtMe=b.one(s);if(r){r=b.one(r);}if(!o&&t){this.setContent(t);}u=b.DOM.region(b.Node.getDOMNode(w));A=u.left+(u.width/2);z=u.top+(u.height/2);v=this.toolTip.get("parentNode").get("region");C=this.toolTip.get("region");if(u){switch(y){case"b":q.replaceClass(f,l);break;case"t":q.replaceClass(l,f);break;case"l":q.replaceClass(j,c);break;case"r":q.replaceClass(c,j);break;}switch(B){case"l":p.replaceClass("rightpointer","leftpointer");p.setStyle(c,"");q.setStyle(c,(u.left-v.left)-(this.pointer.getX()-C.left+(this.pointer.get("offsetWidth")/2))+(u.width/2)+g);break;case"c":if(y=="b"||y=="t"){p.setStyle(c,(C.width/2)-(this.pointer.get("offsetHeight")/2)+g);q.setStyle(c,(u.left-(C.width/2)+(u.width/2))-v.left+g);}else{p.setStyle(f,((C.height/2)-(this.pointer.get("offsetHeight")/2))+g);}break;case"r":p.replaceClass("leftpointer","rightpointer");p.setStyle(c,"");q.setStyle(c,((u.right-C.width)-v.left)+g);break;case"t":p.replaceClass("pointerbottom","pointertop");break;case"b":p.replaceClass("pointertop","pointerbottom");break;}switch(y){case"b":q.setStyle(f,(u.top-v.top+u.height+this.pointer.get("offsetHeight"))+g);break;case"t":q.setStyle(f,(u.top-v.top-C.height-this.pointer.get("offsetHeight"))+g);break;case"l":if(r){q.setStyle(f,(r.getY()-v.top)+g);}else{q.setStyle(f,(z-(this.pointer.getY()-C.top)-(this.pointer.get("offsetHeight")/2))-v.top+g);}q.setStyle(c,(u.left-v.left-C.width-this.pointer.get("offsetWidth"))+g);break;case"r":if(r){q.setStyle(f,(r.getY()-v.top)+g);}else{q.setStyle(f,(z-(this.pointer.getY()-C.top)-(this.pointer.get("offsetHeight")/2))-v.top+g);}q.setStyle(c,u.right-v.left+this.pointer.get("offsetWidth")+g);break;}}},show:function(q,o){var p=b.merge(this.options,o);this.toolTip.removeClass(i);if(q){this.positionToolTip(q,p);}this.toolTip.setAttribute("role",p.role);if(p.scrollIntoView){this.content.scrollIntoView();}return this.content;},hide:function(){this.toolTip.addClass(i);},isVisible:function(){return !this.toolTip.hasClass(i);},destroy:function(){if(this.autohideId!==h){d.getService("autohide").unregister(this.autohideId);this.autohideId=h;}this.toolTipBody.get("parentNode").removeChild(this.toolTipBody);this.toolTipBody=this.pointAtMe=this.toolTip=this.content=this.pointer=h;}};n={create:function(o){return new k(o);}};b.namespace(e);b[e][a]={name:"tooltip",getService:function(p,o){if(!d){d=p;}return n;}};if(m){m.registerService(b[e][a]);}},"1.0");/* Copyright (c) 2014, Yahoo! Inc.  All rights reserved. */
YUI.add("aria_service",function(d){var i=d.ModulePlatform,g="MPServices",a="AriaProvider",c,f,h="aria-",e={hidden:["hide","show","isHidden"],disabled:["disable","enable","isDisabled"],selected:["select","unselect","isSelected"]},b=(d.UA.ie>=8||d.UA.gecko>=1.9||d.UA.webkit>=530);f={isSupported:function(){return b;},setRole:function(j,k){return j.setAttribute("role",k);},alert:function(m,j){var n=document,l,k;j=d.Node.getDOMNode(j)||n.body;if(b&&m){k=j.firstChild;while(k){if(d.DOM.hasClass(k,"aria-alert")){l=k;break;}k=k.nextSibling;}if(!l){l=n.createElement("div");l.role="alert";l.setAttribute(h+"live","assertive");l.className="hide-offscreen aria-alert";j.appendChild(l);}l.innerHTML="<p>"+m+"</p>";}this.update();},update:function(){if(!c){c=document.createElement("input");c.type="hidden";c.value=1;document.body.appendChild(c);}c.value=(c.value==1?0:1);},clearState:function(j,k){return j.removeAttribute(h+k);},hasState:function(k,l){var j=h+l;return k.hasAttribute?k.hasAttribute(j):k.getAttribute(j)!==null;},setState:function(j,k){j.setAttribute(h+k,true);},focusable:function(k,j){k.tabIndex=j?0:-1;}};d.Object.each(e,function(j,k){f[j[0]]=function(l){return f.setState(l,k);};f[j[1]]=function(l){return f.clearState(l,k);};f[j[2]]=function(l){return f.hasState(l,k);};});d.namespace(g);d[g][a]={name:"aria",getService:function(k,j){return f;}};if(i){i.registerService(d[g][a]);}},"1.0");/* Copyright (c) 2014, Yahoo! Inc.  All rights reserved. */
YUI.add("iframeshim_service",function(c){var k=c.ModulePlatform,j=c.Node,p=c.Lang.isNumber,e,f="MPServices",a="IFrameShimProvider",o='<iframe class="y-iframe-shim" tabindex="-1" role="presentation" title="For presentation purposes. Please ignore." src="javascript:false"></iframe>',m="auto",g="display",i="parentNode",h="px",n="zIndex",l,b;function d(){var q=j.create(o);q.setStyle("frameBorder","0");q.setStyle("opacity",0);return q;}l=function(q){this.target=null;this.iframe=d();this.retarget(q);};l.prototype={show:function(){this._positionIFrame();this.iframe.setStyle(g,"block");},hide:function(){this.iframe.setStyle(g,"none");},retarget:function(q){this.hide();this.target=c.one(q);this._attachIFrame();},destroy:function(){this.iframe.get(i).removeChild(this.iframe);this.iframe=this.target=null;},_attachIFrame:function(){var r=this.iframe,q=r.get(i),s=this.target;if(s){s.get(i).insertBefore(r,s);}else{if(q){q.removeChild(r);}}},_positionIFrame:function(){if(!this.target){return;}var r=this.iframe,t=this.target,q=parseInt(t.getStyle("top"),10),v=parseInt(t.getStyle("left"),10),u=t.get(n),s=t.get("region");r.setStyles({top:p(q)?q+h:m,left:p(v)?v+h:m,width:s.width+h,height:s.height+h});if(p(u)){r.setStyle(n,u-1);}}};b={create:function(q){return new l(q);},isShimNeeded:function(){return c.UA.ie>5&&c.UA.ie<7;}};c.namespace(f);c[f][a]={name:"iframeshim",getService:function(r,q){if(!e){e=r;}return b;}};if(k){k.registerService(c[f][a]);}},"1.0");/* Copyright (c) 2014, Yahoo! Inc.  All rights reserved. */
YUI.add("menu_service",function(b){var v=false,j=true,z=null,l=b.ModulePlatform,r="data-pos",e="selected",k="px",s="LI",i="visibility",t=38,d=40,n=27,g=13,c,u,a,q=v,m=[],o=b.Lang.isNumber,y=b.DOM,w,h="MPServices",p="MenuProvider";function x(){b.Array.each(m,function(A){A.hide();});}function f(B,A){this.node=b.one(B);this.options=A||{};this._items=[];this._selectedIndex=-1;this._visible=v;this._id=-1;this._shim=z;this._autohideId=-1;this._autohideTimer=z;this._compactFilter=this.options.compactFilter||false;this._init();}f.prototype={_init:function(){if(!c){c=l.getService("aria");q=c.isSupported();}var E=this.node,C=b.Node.getDOMNode(E),B=C.firstChild,F=0,A,D;while(B){if(B.nodeType==3){A=B.nextSibling;C.removeChild(B);B=A;}else{D=b.one(B.getElementsByTagName("a")[0]);if(D){this._items.push({element:B,linkElement:D,url:D.get("href")});if(q){c.setRole(B,"presentation");c.setRole(D,"menuitem");c.focusable(D,v);D.removeAttribute("href");}}else{this._items.push({});}if(!B.id){B.id=b.guid();}B.setAttribute(r,F);B=B.nextSibling;F++;}}if(u.isShimNeeded()){this._shim=u.create(E);}if(q){c.setRole(E,"menu");c.hide(E);}E.on("keydown",this._handleKeyDown,this);E.on("click",this._handleMouseEvents,this);E.on("mouseover",this._handleMouseEvents,this);this._id=m.length;m.push(this);},hide:function(B){if(this._visible){var E=this._shim,C=this.node,D=this.options.focusNode,A=null;C.setStyle(i,"hidden");c.hide(C);this._visible=v;if(E){E.hide();}this._clearAutohide();if(this._compactFilter){if(b.one(".troll-pointer").getStyle("zIndex")==8){A=b.one(".troll-pointer").getDOMNode();A.style.cssText="display: none !important";}else{b.one(".troll-pointer").setStyle("display","none");}b.one(".more-tab").removeClass("more-tab-pressed");}this.fire({type:"hide",target:this});if(B&&D){b.one(D).focus();}}},isVisible:function(){return this._visible;},show:function(B,G,E){if(!this._visible){x();var F=B.left,D=B.right,C=this.node,H=this._shim,A=null;E=E||k;if(o(F)){C.setStyle("left",F+E);}else{if(o(D)){C.setStyle("right",D+E);}}C.setStyle("top",B.top+E).setStyle(i,"visible");if(G){this.options.focusNode=G;}if(q){c.show(C);}this.select(0);if(H){H.show();}this._visible=j;if(this._compactFilter){if(b.one(".troll-pointer").getStyle("zIndex")==8){A=b.one(".troll-pointer").getDOMNode();A.style.cssText="display: block !important";}else{b.one(".troll-pointer").setStyle("display","block");}b.one(".more-tab").addClass("more-tab-pressed");}this.fire({type:"show",target:this});this._clearAutohide();this._autohideTimer=b.later(50,this,function(){this._autohideTimer=z;this._autohideId=a.register({targets:[this.node],hide:b.bind(function(){this.hide();},this)});});}},_clearAutohide:function(){var A=this._autohideTimer;a.unregister(this._autohideId);if(A){A.cancel();this._autohideTimer=z;}},_handleMouseEvents:function(C){var D=C.target,B=(D.get("tagName")==s)?D:D.ancestor(s),A=-1;if(B&&B.hasAttribute(r)){C.preventDefault();A=Number(B.getAttribute(r));switch(C.type){case"click":this.execute(A);break;case"mouseover":this.select(A);break;default:}}},_handleKeyDown:function(C){var D=C.target,B=(D.get("tagName")==s)?D:null,A=v;switch(C.keyCode){case d:this.selectNext(j);A=j;break;case t:this.selectPrevious(j);A=j;break;case n:this.hide(j);break;case g:if(B){this.execute(Number(B.getAttribute(r)));}break;default:}if(A){C.preventDefault();}},destroy:function(){var A=this.node,B=this._shim;if(q){A.detach("keydown",this._handleKeyDown);}A.detach("click",this._handleMouseEvents);A.detach("mouseover",this._handleMouseEvents);this._clearAutohide();if(B){B.destroy();}b.Object.each(this,function(C,E,D){delete D[E];});m[this._id]=null;},getSelectedIndex:function(){return this._selectedIndex;},getItemNode:function(A){return this.getItemNodes().item(A);},getItemNodes:function(){return this.node.all("> li");},getItemUrl:function(A){return this._items[A].url;},execute:function(A){var C=null,B=null;if(A>=0&&A<this._items.length){this.hide(j);if(this._compactFilter){C=b.one(".more-search");C=C.get("children").item(A);B=b.one(".more-menu-selected");if(B!==null){B.removeClass("more-menu-selected");}C.addClass("more-menu-selected");}this.fire({type:"execute",target:this,relatedTarget:this.getItemNode(A),index:A,url:this._items[A].url});}},selectNext:function(A){if(this._selectedIndex<this._items.length-1){this.select(this._selectedIndex+1);}else{if(A){this.select(0);}}},selectPrevious:function(A){if(this._selectedIndex>0){this.select(this._selectedIndex-1);}else{if(A){this.select(this._items.length-1);}}},select:function(B){if(B!=this._selectedIndex){var D=this._selectedIndex,C=this._items[D],A=this._items[B];if(C){y.removeClass(C.element,e);}if(A&&A.hasOwnProperty("element")){y.addClass(A.element,e);if(q){if(C){c.focusable(C.linkElement,v);}c.focusable(A.linkElement,j);}A.linkElement.focus();this._selectedIndex=B;this.fire({type:"select",target:this,toIndex:B,fromIndex:D});}}}};b.augment(f,b.Event.Target);w={create:function(B,A){return new f(B,A);}};b.namespace(h);b[h][p]={name:"menu",getService:function(B,A){if(!c){c=l.getService("aria");u=l.getService("iframeshim");a=l.getService("autohide");}return w;}};if(l){l.registerService(b[h][p]);}});/* Copyright (c) 2014, Yahoo! Inc.  All rights reserved. */
YUI.add("arcade_transport",function(f){var M=null,ag=false,H=true,S,d=f.ModulePlatform,c=M,ah,i=encodeURIComponent,n=f.Lang,l=f.Object,w=f.Array,N,G,D,e,ab=ag,P={},ad={},ai=[],x,g=ag,u,o,X=0,aj=1,s=2,v=3,C=2048,af=131072,p="_status",Z="_txnid",U="POST",B="GET",h="getProperty",R="MPServices",ac="TransportProvider";function K(L,A){c.error("transport",L,A);}function W(O){var L=M,A;switch(O.type){case"moduleload":L={_action:"show",_create:1,_suid:O.contentId};break;case"setpref":L={_action:"save",_subAction:S,_type:"pref",modid:O.moduleId,_create:1};break;case"loadview":if(O.view=="pa"){A=c.queryModules(function(ak){var Y=c.getModuleApi(ak);return Y&&Y.getProperty("type")=="pa";})[0];L={_action:"show",_subAction:"single",modId:O.moduleId,_container:0,_id:A};}else{L={_action:"show",_subAction:O.view=="default"?S:O.view,_id:O.moduleId,_container:O.chrome?1:0};}break;case"arcade":case"module":L=O.args;L._container=O.chrome?1:0;L._id=O.moduleId;break;default:K("Request doesn't have a type.");break;}O=L?f.merge(L,O):f.mix({},O);delete O.type;delete O.moduleId;delete O.args;return O;}function J(L){var A=L.match(/^((?:\w+:\/\/)?[^#?]+)/);return(A&&n.isArray(A))?A[1]:"";}function aa(L){if(!L){return"";}var A=[];l.each(L,function(Y,O){if(n.isValue(Y)){if(!n.isString(Y)){Y=f.JSON.stringify(Y);}A.push(O+"="+i(Y));}});return A.join("&");}function E(O,am,al){if(!al){K("Proxy request: No module id given, unable to look up proxy signature.");}var ak=J(O.url),Y=c.getModuleState(al).proxy[ak],L,A;if(!Y){K("Proxy request: '"+O.url+"' has not been registered for proxying.");}L=G+"?url="+i(O.url)+"&.sig="+Y+"&.crumb="+N;A={method:O.method,data:O.bodyData,on:am,headers:O.headers};return f.io(L,A);}function b(al,aq,L){if(al.type=="xhr"){return E(al,aq,L).id;}D=D?D:"/jsal";var A=D,an={method:B,on:x},ak={_crumb:N,_mode:"json"},am=c[h]("passthru"),ap,ao,Y,O;if(n.isArray(al)){an.method=U;}else{al=[al];}if(e){ak.pgmode=e;ak.reqSource=e;}ak[Z]=new Date().getTime();w.each(al,function(at,ar){al[ar]=W(at);al[ar][Z]=ak[Z];});if(an.method==B){ap=f.merge(al[0],ak);ao=aa(ap);if(ao.length>2000){an.method=U;}else{A=D+"?"+ao;}}if(am){A+=(A.indexOf("?")>-1?"&":"?")+am;}if(an.method==U){an.data=aa(ak)+"&_json="+i(f.JSON.stringify(al));}Y=f.io(A,an);O=Y.id;P[O]={args:arguments,moduleId:L,conn:Y};if(aq){P[O].callback=aq;}return O;}function m(){if(n.isArray(o)){while(o.length>0){var A=o.shift();b.apply(this,A);}u.detach();u=o=M;}g=ag;}function j(A){g=H;if(A){o=[];u=f.on("unload",f.bind(m,this,H),window);}}function z(ak,Y,O){var L=Y.responseText,A;if(L){A=L.indexOf("<!--");if(A>0){L=L.substring(0,A);}}N=L;m();ab=ag;}function T(O,L,A){K("Unable to update crumb.");}function F(){if(ab){return ag;}ab=H;j(H);var A={success:z,failure:T,scope:this};f.io("/?_mode=html&_action=show&_type=pref&_create=1&_subAction=_cFetch",{method:B,on:A});}function r(O,Y,L){if(g){if(n.isArray(o)){var A=f.Array(arguments);o.push(A);return M;}return ag;}return b(O,Y,L);}function a(L){var A=(P[L]&&P[L].conn&&P[L].conn.isInProgress());return A;}function V(A){if(a(A)){P[A].conn.abort();}else{return false;}}function t(A){if(A&&P[A]&&P[A].args){r.apply(M,P[A].args);delete P[A];delete ad[A];return H;}return ag;}function k(ak,O,A){if(n.isUndefined(O)){O=H;}if(n.isFunction(ak)){ak(ak.argument,A);}else{var L=ak.scope||ak,Y=O?ak.success:ak.failure;if(Y){Y.call(L,A,ak.argument);}}}function y(Y,A,L){var O=P[Y].callback;if(O){k(O,L,A);}if(!n.isUndefined(ad[Y])){if(ad[Y]>1){ad[Y]-=1;}else{delete ad[Y];}}if(n.isUndefined(ad[Y])){delete P[Y];}}function Q(al,A){var L=A._errorCode,Y=A._error,ak=P[al].callback,O={message:Y,moduleId:P[al].moduleId};if(A[p]==aj){if(L==af){if(!ab){F();}t(al);}else{K(Y,O);if(O.moduleId){return;}}}if(ak){k(ak,ag,O);}}function ae(){var A=ai.shift(),O,L;if(A){O=A[Z];if(A[p]!=X){Q(O,A);}else{L=c.getService("resourcemgr");if(A.props&&A.props.id){c.registerModule(A);}if(A.res){L.load(A.res,f.bind(y,M,O,A));}else{y(O,A);}}if(ai.length){n.later(1,this,ae);}}}function I(O,L,A){setTimeout(function(){y(O,L,ag);},0);}function q(ak,Y,A){var O;try{O=f.JSON.parse(Y.responseText);}catch(L){}finally{if(!n.isArray(O)){I(ak,Y,A);return;}}w.each(O,function(am){if(am[p]!=X){Q(ak,am);return;}var al;if(am.response){al=am.response;}else{al=[am];}if(!ad[ak]){ad[ak]=0;}ad[ak]+=al.length;w.each(al,function(an,ao){an._partId=ao;an[Z]=ak;if(!an.data){an.data={};}an.data=f.merge(am.data,an.data);});ai=ai.concat(al);});if(ai.length){n.later(1,this,ae);}}ah={E_OK:X,E_FATAL:aj,E_GLOBAL:s,E_MODULE:v,EC_CRUMB_ERR:C,EC_CRUMB_STALE:af,disable:j,enable:m,isEnabled:function(){return !g;},makeRequest:r,abortRequest:V,isRequestPending:a,_reset:function(){ab=ag;P={};ad={};ai=[];o=M;m();}};x={success:q,failure:I,scope:this};f.namespace(R);f[R][ac]={name:"arcade_transport",getService:function(L,A){if(!c){c=L;N=c[h]("crumb");if(n.isUndefined(N)){N=c[h]("dali").crumb;}G=c[h]("proxyUrl");D=c[h]("requestUrlLite");e=c[h]("pgmode");}return A?M:ah;}};if(d){d.registerService(f[R][ac]);}},"1.0",{requires:["event","io"]});/* Copyright (c) 2014, Yahoo! Inc.  All rights reserved. */
YUI.add("tablite_service",function(d){var m=d.ModulePlatform,f,n,c=".tab",j=".panel",l="selected",e="on",b="fw-b",h="show-panel",o="tabs",k="menu",i,g="MPServices",a="TabliteProvider";i=function(p){this.body=p.body;this.tabWidget=p.tabWidget;this.navMode=p.navMode||o;this.moduleApi=p.moduleApi;this.tabs=this.body.all(c);this.panels=this.body.all(j);this.selectedTabNodes={tabNode:this.body.one("."+l),panelNode:this.body.one("."+h)};this.listeners=[];};i.prototype={body:undefined,tabWidget:undefined,moduleApi:undefined,tabs:[],panels:[],listeners:null,navMode:null,selectedTabNodes:{tabNode:undefined,panelNode:undefined},autoHideService:null,autoHideId:null,stateMgr:null,setup:function(){var q=0,p,r=this;this.tabs.each(function(s){if(q!==0){p.insert(s,"after");}s.addClass("loaded");p=s;q++;},this);if(this.tabWidget){this.tabWidget.addClass("tab-"+this.navMode+"-loaded");}if(this.navMode===k){this.autoHideService=m.getService("autohide");this.autohideId=this.autoHideService.register({targets:[this.tabWidget],triggers:["click"],hide:function(){r.tabWidget.removeClass("tab-menu-open");r.tabWidget.one(".wrapper").removeClass("popover");}});}this.body.on("click",this._handleClickEvent,this);if(this.moduleApi){this.stateMgr=this.moduleApi.getService("statemgr");}return;},teardown:function(){this.body.detach("click",this._handleClickEvent);if(this.autoHideService){this.autoHideService.unregister(this.autohideId);}return;},switchTab:function(r){var q={tabNode:this.tabs.item(r),panelNode:this.panels.item(r)},p;if(q.tabNode&&q.panelNode){this.selectedTabNodes.tabNode.removeClass(l);this.selectedTabNodes.tabNode.removeClass(e);q.tabNode.addClass(l);q.tabNode.addClass(e);if(this.navMode===o){this.selectedTabNodes.tabNode.removeClass(b);q.tabNode.addClass(b);}this.selectedTabNodes.panelNode.removeClass(h);q.panelNode.addClass(h);this.selectedTabNodes=q;p=this.selectedTabNodes.tabNode.getAttribute("data-tabid");this.stateMgr.saveUserSetting("st",p,this.moduleApi);}return;},_handleClickEvent:function(q){var p=q.target.ancestor(".tab",true);if(this.navMode===k){if(p){if(this.tabWidget.hasClass("tab-menu-open")){this.handleTabClick(p);this.toggleDropdown("close");return;}}if(!this.tabWidget.hasClass("tab-menu-open")){this.toggleDropdown("open");}}else{if(p&&!p.hasClass("tab-disabled")){this.handleTabClick(p);}}return;},handleTabClick:function(p){var q=this._getTabPos(p);this.switchTab(q);},toggleDropdown:function(p){if(p==="close"){this.tabWidget.removeClass("tab-menu-open");this.tabWidget.one(".wrapper").removeClass("popover");}else{this.tabWidget.addClass("tab-menu-open");this.tabWidget.one(".wrapper").addClass("popover");}this.toggleInactiveBeacons();},toggleInactiveBeacons:function(){this.tabWidget.all(".tab").each(function(p){if(p.hasAttribute("data-b-inactive")){p.setAttribute("data-b",p.getAttribute("data-b-inactive"));p.removeAttribute("data-b-inactive");}else{if(p.hasAttribute("data-b")){p.setAttribute("data-b-inactive",p.getAttribute("data-b"));p.removeAttribute("data-b");}}});},_getTabPos:function(q){var r=null,p=0;if(q){this.tabs.each(function(s){if(s===q){r=p;}p++;},this);}return r;}};d.namespace(g);d[g][a]={name:"tablite",getService:function(q,p){if(!f){f=q;}n=q.getService("login",p);return i;}};if(m){m.registerService(d[g][a]);}},"1.0");/* Copyright (c) 2014, Yahoo! Inc.  All rights reserved. */
YUI.add("carousel_service",function(a){var f=a.ModulePlatform,c="MPServices",h="CarouselProvider",i="tabindex",n="A",g="offsetWidth",p="offsetHeight",l="right",r="mouseout",k="mouseover",b=300,e=true,j=false,o=null,q;function m(v,s,u){var w,t;w=this.node=a.one(v);if(w.hasClass("y-carousel-list")){this._carouselList=w;this.node=w.get("parentNode");}else{this._carouselList=w.query(".y-carousel-list");}this.options=s||{};this._mode=s.mode||"horz";this._loop=s.loop||j;this._autoscrollPlaying=j;this._autoscrollLazyPause=0;this._autoscrollInterval=s.autoscrollInterval||0;this._autoscrollIntervalFirst=s.autoscrollIntervalFirst||this._autoscrollInterval;this._autoscrollTimer=o;t=this._carouselItems=this._carouselList.get("children");this._maxItems=t.size();this._currentIndex=0;this._pixelToEmRatio=0;this._moduleapi=u;this._direction=s.direction||(u.getViewDirection("default")=="rtl")?l:"left";this._scrollActive=false;this._init();}m.prototype={_init:function(){var s=this.node;s.addClass(this._mode);if(this.options.direction){this._direction=this.options.direction;}if(this._autoscrollInterval>0){this.attachEngagingAreaMouseEvents();if(a.UA.ie<8){this.activeElement=document.activeElement;document.onfocusout=a.bind(this.handleIEBlur,this);document.onfocusin=a.bind(this.handleIEFocus,this);}else{a.on("blur",a.bind(this.handleBlur,this),window);a.on("focus",a.bind(this.handleFocus,this),window);}}},_getWrapAroundToPosition:function(C,t){var D,z,s,w,E,A=this._direction,v=this._maxItems,y=this._carouselItems,x=(this._direction==="top")?y.item(0).get(p):y.item(0).get(g),B=v*x,F=y.item(C),u=parseInt(F.getComputedStyle(A),10);u=isNaN(u)?0:u;D=t*x+u;z=u;if(C>t){this._firstWrap=false;D+=B;z+=B;}else{D-=B;z-=B;}F=y.item(t);E=this._carouselList;s=E.getComputedStyle(A);if(s){if(s.indexOf("em")>-1){w=parseInt(s,10);E.setStyle(A,this._convertToPixels(w)+"px");}else{if(s.indexOf("auto")>-1){E.setStyle(A,"0");}}}F.setStyle(A,z+"px");return -D;},_getToPosition:function(u,w){var v,s=this._direction,t=this._carouselItems;this.resetPositioning(u);v=t.item(u);v.setStyle(s,"");v=t.item(w);v.setStyle(s,"");return this._getOffsetByIndex(w);},_getOffsetByIndex:function(s){var t=this._carouselItems,u=(this._direction==="top")?t.item(0).get(p):t.item(0).get(g);return -(s*u);},destroy:function(){var s=this._fontResizeHandle;if(s){s.detach();}this.detachEngagingAreaMouseEvents();this._fontResizeHandle=this.node=this._carouselItems=this._carouselList=o;this.unsubscribeAll();},getItemNode:function(s){return this._carouselItems.item(s);},getCurrentIndex:function(){return this._currentIndex;},_doAutoscroll:function(){if(this._autoscrollPlaying){if(this._autoscrollLazyPause===0){this.next();if(this._autoscrollInterval>0){this._autoscrollTimer=a.later(this._autoscrollInterval*1000,this,this._doAutoscroll);}}else{this._autoscrollTimer=o;}}},play:function(s){if(this._autoscrollIntervalFirst===0){return j;}if(s){if(this._autoscrollLazyPause>0){this._autoscrollLazyPause-=1;}if(this._autoscrollPlaying===j){return;}}if(this._autoscrollLazyPause===0&&(this._autoscrollPlaying===j||this._autoscrollTimer===o)){this._autoscrollTimer=a.later((this._autoscrollIntervalFirst*1000),this,this._doAutoscroll);this._autoscrollPlaying=e;}},pause:function(s){if(s){this._autoscrollLazyPause+=1;}else{this._autoscrollPlaying=j;if(this._autoscrollTimer!==o){this._autoscrollTimer.cancel();this._autoscrollTimer=o;}}},next:function(t){var s=this._currentIndex;if(s==this.getItemCount()-1){if(this._loop||t){s=0;}}else{++s;}this.scrollTo(s);},previous:function(t){var s=this._currentIndex;if(s===0){if(this._loop||t){s=this.getItemCount()-1;}}else{--s;}this.scrollTo(s);},resetPositioning:function(s){if(typeof(s)==="undefined"){s=this._currentIndex;}var t=this._getOffsetByIndex(s);this._carouselList.setStyle(this._direction,t+"px");},scrollTo:function(v,y){var B,s,t=j,w=this._maxItems,A=this._currentIndex,C,z=this._direction,u,x={type:"scroll",fromIndex:A,toIndex:v};if(this.isScrolling()||v==A){return;}s=this.getItemNode(A);this._activateTabIndex(s,j);y=y===undefined||y===o?e:y;if(6==a.UA.ie&&l==z){y=j;}t=(A===0&&v==w-1)||(A==w-1&&v===0);this._currentIndex=v;if(y&&t&&w>2){B=this._getWrapAroundToPosition(A,v);}else{B=this._getToPosition(A,v);}this.fire({type:"beforescroll",fromIndex:A,toIndex:v});u=this.options.animate||f.getProperty("ui.carousel.animate");if(u){C={on:{start:a.bind(function(){this._scrollActive=true;},this)}};switch(z){case"top":C.top=B+"px";break;case"bottom":break;case"left":C.left=B+"px";break;case"right":C.right=B+"px";break;}C.duration=this.options.animDuration||0.5;C.easing=this.options.easing||"ease-in-out";this._carouselList.transition(C,a.bind(function(){this._handleScrollEnd(x);},this));}else{this._carouselList.setStyle(z,B+"px");this._handleScrollEnd(x);}},_handleScrollEnd:function(u){var s,t,x,v,w;this._scrollActive=false;if(a.UA.ie){s=this._direction;w=this._carouselList;x=parseInt(w.getComputedStyle(s),10);v=this._convertToEms(x);if(isFinite(v)){w.setStyle(s,v-0.068+"em");}}t=this.getItemNode(this._currentIndex);this._activateTabIndex(t,e);this.fire(u);},_convertToEms:function(s){return 1/this._calculateEm()*parseInt(s,10);},_convertToPixels:function(s){return this._calculateEm()*parseInt(s,10);},_calculateEm:function(){var s,u,t=this.node;s=t.create('<div style="width: 50em; height: 0; position: absolute;'+this._direction+': -999em;"></div>');t.appendChild(s);u=s.get(g)/50;t.removeChild(s);if(u===0&&this._pixelToEmRatio!==0){u=this._pixelToEmRatio;}else{if(u>0){this._pixelToEmRatio=u;}}return u;},_activateTabIndex:function(u,s){var t=u.queryAll(n);if(t){if(s){t.each(function(v){v.removeAttribute(i);});}else{t.each(function(v){v.setAttribute(i,"-1");});}}},getItemNodes:function(){return this._carouselItems;},getItemCount:function(){return this._maxItems;},isScrolling:function(){return this._scrollActive;},attachEngagingAreaMouseEvents:function(){this.node.on(k,this.handleEngagingAreaMouseover,this);this.node.on(r,this.handleEngagingAreaMouseout,this);},detachEngagingAreaMouseEvents:function(){this.node.detach(k,this.handleEngagingAreaMouseover);this.node.detach(r,this.handleEngagingAreaMouseout);},handleBlur:function(){this.pause(e);this.detachEngagingAreaMouseEvents();},handleFocus:function(){this.play(e);this.attachEngagingAreaMouseEvents();},handleIEBlur:function(){if(this.activeElement){}if(this.activeElement==document.activeElement){this.activeElement=o;this.handleBlur();}},handleIEFocus:function(){if(this.activeElement==o){this.handleFocus();}this.activeElement=document.activeElement;},handleEngagingAreaMouseover:function(s){a.later(b,this,this.pause,e);},handleEngagingAreaMouseout:function(s){a.later(b,this,this.play,e);}};a.augment(m,a.Event.Target);function d(s){this.moduleapi=s;}d.prototype={create:function(t,s){return new m(t,s,this.moduleapi);}};a.namespace(c);a[c][h]={name:"carousel",getService:function(t,s){if(!q){q=t;}return new d(q.getModuleApi(s));}};if(f){f.registerService(a[c][h]);}},"1.0");/* Copyright (c) 2014, Yahoo! Inc.  All rights reserved. */
(function(){var z,w,v,o,G,B,a,b,k,s,E,c,D,h,x,q=false,y=[],u="",e="pa:open",l="pa:close",t="stream:loadsuccess",p="stream:new_content",f="modal:open",i="modal:close",J="apps:resized",A="fp:window:scroll",F="fp:window:resize",g="fp:today:offscreen",m="fp:today:onscreen",I="fp:moneyball:offscreen",n="fp:moneyball:onscreen",d="fp:trendingnow:offscreen",C="fp:trendingnow:onscreen",j="fixed-enabled",H=40,r=500;YModules.type_fp={viewevents:["click","contextmenu"],lastScroll:0,scrollSince:0,scrollTimer:null,safariSearchSetEnabled:false,init:function(K){var L;G=K;a=G.getService("moduleplatform");b=G.getService("yui");k=b.config.win;B=G.getId();z=G.getService("instrumentation");v=G.getService("modal");E=G.getService("sethomepage");s=G.getService("metrologger");w=G.getService("sticky_position");L=b.one("base");if(L){h=L.get("target");}},onviewload:function(R){this.listeners=[];if(R=="default"){var T=G.getContextData("ilc"),N,P,Q,K=G.getContextData("forceIpLocation"),M=G.getService("statemgr"),O,S,L;if(K&&M){M.setUserPageState("bypassUserLocPref",1);}this.body=G.getViewNode(R);this.fixCenterCol=a.getProperty("filters.bar.enable");this.mHeight=b.one("#masthead").get("offsetHeight");this.wrapper=b.one(".main-row-wrapper")||b.one(".main-col-wrapper");this.scrollY=0;if(w){Q={top:this.mHeight,onSticky:b.bind(this.onStickyHandler,this),onLoose:b.bind(this.onLooseHandler,this)};w=new w({".sticky-rail-right-holder":Q,".sticky-rail-left-holder":Q,"#stream .type_fstream":Q});G.listen(J);G.listen(t);}y=a.queryModules(function(U){var V=a.getModuleState(U);return !!(V&&V.defer);});a.subscribe("error",this.handleError,this,true);a.subscribe("navigate",this.handleNavigate,this,true);a.subscribe("modulesignal",this.handleModuleSignal,this,true);a.subscribe("ready",this.handleReady,this,true);G.listen(l);G.listen(e);G.listen(f);G.listen(i);G.listen(p);this.watchScroll();this.watchResize();this.handleAction("resize");if(y.length>0){b.on("load",b.bind(this.loadDeferred,this),window);}if(G.getContextData("deferredRes")){P=G.getContextData("deferredResDelay");if(P>0){b.on("load",b.rbind(function(U){b.later(U,this,this.loadDeferredRes);},this,[P]),window);}else{b.on("load",b.bind(this.loadDeferredRes,this),window);}}if(E&&E.getHpCookie()===null){N=E.isHomepageSet(T)?"1":"0";E.setHpCookie(T,N);b.on("load",b.bind(this.logHomepageSet,this,T,N),window);}if(b.UA.ie===9){if(window.external&&("msIsSiteModeFirstRun" in window.external)&&(1===window.external.msIsSiteModeFirstRun(true))){this.beaconIE9PinningAction();}}b.on("unload",function(){u="unload";},window);this.disableOffscreenAutoplay=a.getProperty("today.offscreen.autoplay.disabled");this.todayOffscreenAmount=a.getProperty("today.offscreen.amount");this.pauseMballAutoplay=a.getProperty("moneyball.offscreen.autoplay.disabled");this.pauseMballOffscreenAmount=a.getProperty("moneyball.offscreen.amount");this.enableTrendingnowOffscreen=a.getProperty("trendingnow.offscreen.enabled");if(this.enableTrendingnowOffscreen===1){O=this.body.one(".col-3 .type_trendingnow .app_trendingnow");S=O.get("offsetHeight");L=O.getY();this.trendingnowOffscreenAmount=L+S-(this.body.one("#masthead").get("offsetHeight"));}this.safariSearchSetEnabled=G.getContextData("safariSearchSetEnabled");if(this.safariSearchSetEnabled){b.use("safari_search_set",b.bind(function(U){U.Search.safariSearchSet(G.getContextData("desktopCrumb"),U.Cookie.get("B"));},this));}}},isFixedEnabled:function(){return this.body.hasClass(j);},onStickyHandler:function(L,K){if(K==="top"){L.setStyles({top:this.mHeight,bottom:""});}else{L.setStyles({top:"",bottom:0});}},onLooseHandler:function(K){K.setStyles({top:"",bottom:"",width:""});},watchResize:function(){this.listeners.push(b.on("resize",function(K){this.handleAction("resize");},k,this));},watchScroll:function(){this.listeners.push(b.on("scroll",function(K){var L=+(new Date())-this.lastScroll;this.scrollSince=L;if(this.scrollTimer){this.scrollTimer.cancel();}if(L>=H){this.handleAction("scroll");}else{this.scrollTimer=b.later(H-L,this,this.handleAction,"scroll");}},k,this));},handleAction:function(M){var K=this.viewport,P=b.DOM.docScrollY(),N=this.body,L,O=G.getContextData("fixedMastheadEnabled");this.lastScroll=+(new Date());this.scrollY=P;if(M==="resize"){L=parseInt(this.wrapper.getStyle("min-width"),10)||980;K=this.viewport=b.DOM.viewportRegion();if(O){this.body.toggleClass(j,(K.width>=L));}}N.toggleClass("has-scrolled",P>0);if(w){if(this.scrollSince>r||M==="resize"){w.recalculateThresholds(K);}if(O){w.trigger(K,P,M,b.bind(this.isFixedEnabled,this));}}G.broadcast(M==="scroll"?A:F,{type:M,viewport:K});if(this.disableOffscreenAutoplay&&this.todayOffscreenAmount&&this.disableOffscreenAutoplay===1){if(M==="scroll"&&this.scrollY>=this.todayOffscreenAmount){G.broadcast(g);}else{if(M==="scroll"&&this.scrollY<this.todayOffscreenAmount){G.broadcast(m);}}}if(M==="scroll"&&this.pauseMballAutoplay&&this.pauseMballOffscreenAmount){if(this.scrollY>=this.pauseMballOffscreenAmount){G.broadcast(I);}else{if(this.scrollY<this.pauseMballOffscreenAmount){G.broadcast(n);}}}if(M==="scroll"&&this.enableTrendingnowOffscreen===1&&this.trendingnowOffscreenAmount){if(this.scrollY>=this.trendingnowOffscreenAmount){G.broadcast(d);}else{if(this.scrollY<this.trendingnowOffscreenAmount){G.broadcast(C);}}}},openModal:function(L,K){if(!o){o=v.create(L.config);}o.setContent(L.content);o.show();},closeModal:function(K){if(!o){return;}o.setContent("");o.hide();},onviewunload:function(K){if(K=="default"){if(D){D.cancel();}a.unsubscribe("error",this.handleError);a.unsubscribe("navigate",this.handleNavigate);a.unsubscribe("modulesignal",this.handleModuleSignal);a.unsubscribe("ready",this.handleReady);D=c=null;}},onviewevent:function(O,L){var M=L.target,N=M&&L.button===1&&M.ancestor(".back-to-top",true),K;if(L.type=="contextmenu"){M=M.get("tagName")=="A"?M:M.ancestor("A");if(M){K=M.getAttribute("href").replace(location.href,"");if(K.charAt(0)=="#"||/^javascript:/i.test(K)){L.preventDefault();}}}if(N){N.blur();k.scrollTo(0,0);z.fireYwaBeacon({slk:q?"top-msg":"top",sec:"btt",action:"click",elm:"btn",elmt:"cta",itc:1,rspns:"top",t1:"a0",t2:"btt",t3:"plcmt"});}},onmessage:function(Q,M,O){var P,L,N,K;switch(Q){case J:if(w){w.recalculateThresholds(this.viewport);w.trigger(this.viewport,this.scrollY,"resize",b.bind(this.isFixedEnabled,this));}return;case f:this.openModal(O,false);return;case i:this.closeModal(false);return;case p:P=this.body.one(".back-to-top");L=P&&P.one(".new-stories-notif");if(L){N=b.Object.getValue(O,["count"])||0;K=N&&b.Object.getValue(O,["message"])||"";q=!!(K);L.setContent(K).toggleClass("show",q);if(q){z.fireYwaBeacon({action:"secview",sec:"td-strm-btn",outcome:"cuetop"});}}return;case t:w.recalculateThresholds(this.viewport);return;default:}},loadDeferred:function(){b.Array.each(y,function(K){a.refreshView(K,"default");});y=[];},loadDeferredRes:function(){var K=G.getContextData("deferredRes"),L;if(K){L=a.getService("resourcemgr");b.Array.each(K,function(M){L.load(M);});}},logHomepageSet:function(L,K){z.firePageParameterBeacon("hpset="+K+(L?"&ilc="+L:""));},handleReady:function(L){var K=OnloadCache;K.dispatch();K.reset();},handleError:function(P){s.logError(P.moduleId,P.errorType+"(view="+P.view+",pageMode= "+u+"):"+P.error.message);if(u!="unload"){var K,O,L,N,R,Q;if(!P.moduleId){return;}if(P.errorType=="onviewunload"&&(P.viewName=="default"||(P.args&&P.args[0]=="default"))){return;}else{try{K=P.html;O=P.moduleId;L=a.getModuleApi(O);R=L.getProperty("type");N=G.getString("STR.MODULE.ERROR_FALLBACK_TEXT");Q=a.getProperty("errorDetails");if(Q||(R!="pa"&&R!="pacontainer"&&R!="masthead"&&R!="fptoday")){if(Q){N="JavaScript error: "+P.error.message;}if(!K){K=b.Lang.sub(a.getProperty("modErrorHtml"),{message:N,name:L.getProperty("title"),img:L.getProperty("icon"),title:L.getProperty("title"),url:L.getProperty("detailUrl")});}this.showModuleDefaultViewError(O,K);}}catch(M){}}}},handleModuleStart:function(N){var M=N.moduleId,K=a.getModuleApi(M),O=K.getProperty("type"),L=K.getContextData("mods");if(O!="fp"&&O!="pa"){if(b.Lang.isArray(L)){b.Array.each(L,function(P){a.registerModule(P);a.start(P.props.id,true,true);});}}},handleNavigate:function(K){var L=K.target||h||"_top";if(z.hasPendingBeacons()){z.firePendingBeacons();}if(L==="_top"||L==="_self"){b.later(200,this,function(M){location.href=M;},K.url);}else{window.open(K.url,L);}},handleModuleSignal:function(M){if(M.signal=="viewevent"){var L=M.args[1],N=L.target,K=N.get("tagName");if((K=="SELECT"||K=="OPTION")){if(K=="SELECT"){b.detach("selectchange|change");N.on("selectchange|change",function(O){this.processInstrumentation(O.target,true);},this);}return;}this.processInstrumentation(N,(M.moduleId==B));}},processInstrumentation:function(L,K){z.collectData(L);if(K){z.firePendingBeacons();}},showModuleDefaultViewError:function(R,N){var P=a.getModuleApi(R),M=P.getProperty("detailUrl"),K=a.getViewNode(R,"default"),Q=(K?K.ancestor(".mod"):null),L=b.Lang.sub(a.getProperty("modChromeHtml"),{html:N,type_name:P.getProperty("type"),view_name:"error"}),O=b.Node.create(L);if(!M){O.addClass("no-link");}if(Q){Q.set("innerHTML","").appendChild(O);}},beaconIE9PinningAction:function(){var K=Math.random(),L="http://pclick.internal.yahoo.com/p/s=2145185763&t="+K;x=new Image();x.onload=x.onerror=function(){x=null;};x.src=L;}};})();/* Copyright (c) 2014, Yahoo! Inc.  All rights reserved. */
var MORE_MENU_CLASS="uh-more-menu",MENU_EXPOSED_CLASS="menu-active",MOUSEOVER="mouseover",MOUSEOUT="mouseout";YModules.type_universalheader={body:null,editBody:null,id:"",moduleapi:null,viewevents:["click"],instrumentation:null,tooltipService:null,tooltip:null,autoHide:null,init:function(a){this.Y=a.getService("yui");this.id=a.getId();this.moduleapi=a;this.instrumentation=a.getService("instrumentation");this.listeners=[];this.moreClickEnabled=a.getContextData("moreClickEnabled");},onviewload:function(b){var a=this.moduleapi;if(b==="default"){this.body=a.getViewNode(b);this.registerAutoHide();if(!this.moreClickEnabled){this.listeners.push(this.Y.one(".uh-more-menu").on(MOUSEOVER,this.mouseenterleave,this,this.clearSiteMenuHideTimer));this.Y.one(".uh-more-menu").on(MOUSEOUT,this.mouseenterleave,this,this.Y.bind(this.hideMoreMenuMouse,this,"more"));this.Y.one("#uh-more-link").on(MOUSEOUT,this.mouseenterleave,this,this.Y.bind(this.hideMoreMenuMouse,this,"more"));}}},registerAutoHide:function(){var c=this.Y,a=this.moduleapi.getService("autohide"),b=this.body.one("."+MORE_MENU_CLASS),d=this.body.one("#uh-more-link");this.menu=b;this.moreLink=d;this.autoHideId=a.register({targets:[d,b],hide:c.bind(this.hideMoreMenu,this)});this.autoHide=a;},onviewunload:function(a){if(a==="default"){this.body=null;}else{if(a==="edit"){this.editBody=null;}}},onviewevent:function(b,a){var c;if(b==="default"){c=a.target.ancestor("#uh-more-link > a",true,".type_universalheader");if(c&&this.moreClickEnabled){if(!c.get("parentNode").hasClass(MENU_EXPOSED_CLASS)){this.exposeMoreMenu();}else{this.hideMoreMenu();}a.preventDefault();}}},exposeMoreMenu:function(){var a,b=this.body.one("ul").all("li")._nodes.length;this.moreLink.addClass(MENU_EXPOSED_CLASS);this.menu.removeClass("d-n");a={sec:"hd-nav",slk:"more",ltxt:this.moduleapi.getContextData("str.more"),cpos:b,itc:1};this.instrumentation.fireUltBeacon(a);},hideMoreMenu:function(){this.moreLink.removeClass(MENU_EXPOSED_CLASS);this.menu.addClass("d-n");},exposeMoreMenuMouse:function(){if(!this.siteMenuExposeMenuTimer){this.siteMenuExposeMenuTimer=setTimeout(this.Y.bind(function a(){this.exposeMoreMenu();this.siteMenuExposeMenuTimer=null;},this),300);}},hideMoreMenuMouse:function(){if(!this.siteMenuHideTimer){this.siteMenuHideTimer=setTimeout(this.Y.bind(function a(){this.hideMoreMenu();this.siteMenuHideTimer=null;},this),700);}},clearSiteMenuHideTimer:function(){if(this.siteMenuHideTimer){window.clearInterval(this.siteMenuHideTimer);this.siteMenuHideTimer=null;}},mouseenterleave:function(d,a){var c=d.currentTarget,b=d.relatedTarget;if(c!==b&&!c.contains(b)){a.call(this,d);}}};/* Copyright (c) 2014, Yahoo! Inc.  All rights reserved. */
YModules.type_intlselectorfull={body:null,editBody:null,id:"",moduleapi:null,viewevents:["click"],init:function(a){this.Y=a.getService("yui");this.id=a.getId();this.moduleapi=a;},onviewload:function(f){var e,b,c=this.moduleapi.getContextData();this.body=this.moduleapi.getViewNode(f);this.useMobileVersion=c.useMobileVersion;this.instrumentationService=this.moduleapi.getService("instrumentation");if(!this.useMobileVersion){this.autoHideService=this.moduleapi.getService("autohide");try{this.tooltip=this.moduleapi.getService("tooltip").create({parentNode:this.body,className:"y-tooltip-intlselectorfull",position:{box:"b",arrow:"t"},msg:this.moduleapi.getString("STR.INTLSEL.TOOLTIPMARKUP")});e=this.tooltip.getNode();b=e.one(".pointer");b.addClass("img-sprite");}catch(d){}}else{this.selectListener=this.body.delegate("change",this.selectionChange,".intl-list",this);}if(c.useEducationTooltip){this.statemgr=this.moduleapi.getService("statemgr");if(!this.statemgr.getUserModuleState("intlselmsg")){try{this.tooltipMsg=this.moduleapi.getService("tooltip").create({parentNode:this.body,className:"y-tooltip-intlselectorfull-helpmsg fz-xxs",position:{box:"b",arrow:"t"},msg:this.moduleapi.getString("STR.INTLSEL.HELPMSG")});if(!this.useMobileVersion){e=this.tooltipMsg.getNode();b=e.one(".pointer");b.addClass("img-sprite");}this.tooltipMsg.show(this.body.one(".header-intl-icon"));this.Y.later(7000,this,this.hideHelpMsg);}catch(a){}}}},onviewunload:function(a){if(this.tooltip){this.tooltip.destroy();this.tooltip=null;}if(this.selectListener){this.selectListener.detach();this.selectListener=null;}},onviewevent:function(d,c){var b=c.target,a={t1:"a1",t2:"hdnav",t3:"tl-lst",sec:"hdnav",slk:"intl",elm:"tl",elmt:"intl",itc:1,_p:0};if(b.ancestor(".intl-selectorfull",true,".type_intlselectorfull")&&!this.useMobileVersion){if(this.tooltip.isVisible()){this.hideMenu();a.rspns="cl";}else{this.showMenu();a.rspns="op";}this.instrumentationService.fireBeacon(a);}else{if(b.test(".msg-close")){this.hideHelpMsg();}}},showMenu:function(){var a=this.tooltip.getNode();this.autohideId=this.autoHideService.register({targets:[this.body],hide:this.Y.bind(this.hideMenu,this)});this.tooltip.show(this.body);a.one("a").focus();this.hideHelpMsg();},hideMenu:function(){var a=this.body.one(".intl-selectorfull");this.autoHideService.unregister(this.autohideId);this.autohideId=null;this.tooltip.hide();a.focus();},selectionChange:function(b){var e=b.target,c=e.one('[value="'+e.get("value")+'"]'),d=c.getAttribute("data-url"),a={action:"click",rspns:"nav",t1:"a1",t2:"hdnav",t3:"tl-lst",t4:"intl-mu",sec:"hdnav",slk:c.get("text"),elm:"itm",elmt:"pty",itc:0,_p:0};this.instrumentationService.fireYwaBeacon(a);this.moduleapi.navigate(d);},hideHelpMsg:function(){if(!this.tooltipMsg){return;}this.tooltipMsg.hide();this.statemgr.setUserModuleState("intlselmsg",1);}};/* Copyright (c) 2014, Yahoo! Inc.  All rights reserved. */
(function(){var b="mouseover",i="mouseout",g="tab_enter",h="tab_exit",d="innerHTML",e=null,c="saveforlater:newsaved",f="glow";function a(m,j){var l=m.currentTarget,k=m.relatedTarget;if(l!==k&&!l.contains(k)){j.call(this,m);}}YModules.type_tabbar={body:e,id:"",api:e,viewevents:["click"],events:e,tiles:e,ulm:e,locWidget:e,locaBadgeReq:e,instrumentation:e,init:function(j){this.Y=j.getService("yui");this.id=j.getId();this.api=j;this.events=[];this.instrumentation=j.getService("instrumentation");},onviewload:function(s){var p=this.api,x=p.getViewNode(s),l=this.handleEnterLeave,k=this.id,u,o,m,w,j,q,n,r,v,t;u=x.getById(k+"-tiles");t=this.tiles=u.all(".tab");this.body=x;this.locaBadgeReq=this.api.getContextData("localbadge");this.Y.each(t,this.Y.bind(function(y){this.events.push(y.on(b,a,this,l),y.on(i,a,this,l));},this));n=x.one(".local-drop");if(n){o=p.getService("ulm");p.listen("ulm:defaultlocation");this.ulm=o.create(n.one(".y-ulm"),{setDefault:true});this.ulm.subscribe("locationselect",this.onLocationSelect,this);n.removeClass("hide");n.one(".y-ulm-dd").addClass("hide-textindent");}else{if(x.one("#mld-widget")){p.listen("ldw:defaultlocation");q=p.getService("locdrop_widget");r=p.getContextData("locale");v=p.getContextData("locdrop_crumb");m=p.getContextData("country_filter");w=p.getContextData("def_loc");j=p.getContextData("cur_loc");this.locWidget=q.create("#mld-widget",{crumb:v,locale:r,countryFilter:m,currentLoc:j,defaultLoc:w});this.locWidget.subscribe("locationselect",this.onLocWidgetSelect,this);}}u.destroy();this.Y.Global.on(c,this.animateSaveForLater,this);},onmessage:function(j,k,l){if((j==="ulm:defaultlocation"||j==="ldw:defaultlocation")&&k!="tabbar"){this.updateLocation(l.loc);}},updateLocation:function(k){var j={type:"module",moduleId:this.id,args:{_action:"show",_subAction:"ulmLocationSelect",ulmLocation:k}},l={success:this.onUpdateLocationSuccess,failure:this.onUpdateLocationFailure,argument:{},scope:this};this.api.makeRequest(j,l);},onUpdateLocationSuccess:function(j,k){if(j.html){this.body.one(".local-txt").set(d,j.html);}},onUpdateLocationFailure:function(j,k){},onLocationSelect:function(k){var j,l;if(k.response.html){j=this.body.one(".local-txt");j.set(d,k.response.html);l=(k.response.data._ULM_LOCATION)?k.response.data._ULM_LOCATION:k.location;if(this.locaBadgeReq&&l){if(NILE&&NILE.onLocationChange){NILE.onLocationChange(l);}}}},onLocWidgetSelect:function(j){this.updateLocation(j);},onviewunload:function(j){this.body.destroy();this.Y.Array.each(this.events,function(k){k.detach();});this.tiles.destroy();this.body=this.events=this.tiles=e;},onviewevent:function(s,n){var p,o=n.target,l,r,j,q,m,k,t,u=this.body.one(".y-menu");if(o.hasAttribute("aria-haspopup")){n.preventDefault();u.setStyle("visibility","visible");u.setAttribute("aria-hidden",false);m=this.Y.one("body").on("focus",function(v){if(!u.contains(v.target)){u.setStyle("visibility","hidden");u.setAttribute("aria-hidden",true);m.detach();}});}if(!o.hasClass("lw")&&!o.ancestor(".lw")&&!o.hasClass("y-ulm")&&!o.ancestor(".y-ulm")&&o.get("nodeName").toLowerCase()!="a"){l=o.hasClass("tab")?o:o.ancestor(".tab");if(l){q=l.one(".mod");p=o.get("className");if((!q||!q.contains(o)||/\btab-(?:label|caption)\b/.test(p))&&!o.hasClass("feature-cue")&&!o.ancestor(".feature-cue")){r=l.one(".tab-label");j=r.get("href");if(j){this.api.navigate(j);}r.destroy();}}}k=o&&o.ancestor(".tab-my",true,".tiles");if(k){t={t1:"a1",t2:"hd",t3:"tl-lst",sec:"hd",elm:"tl",elmt:"myyh",itc:0,rspns:"nav",action:"click",slk:"myyh",pos:0};this.instrumentation.fireYwaBeacon(t);}},handleEnterLeave:function(o){var q=o.type==b?g:h,l=o.currentTarget,n,m=l.one(".bd"),p,k,j;if(!m){return;}k=m.get("className");j=/type_(\w+)/.exec(k);if(j&&j[1]){p=j[1];n=o.target;if("mail"===p&&(n.hasClass("feature-cue")||n.ancestor(".feature-cue"))){return;}this.api.broadcast(q,{moduleType:p});}else{}},animateSaveForLater:function(l){var m=this.body.one(".tab-label .tab-icon"),k,j=this.body.one(".sfl-icon-animation");if(m&&!j){k=this.Y.Node.create('<i class="img-sprite sfl-icon-animation"></i>');m.ancestor(".tab-label").prepend(k);m.addClass("box-shadow-anim");k.transition({duration:0.5,opacity:1,on:{start:function(){m.addClass(f);},end:function(){m.removeClass(f);k.transition({duration:0.8,opacity:0.2},function(){k.transition({duration:0.5,opacity:1,on:{start:function(){m.addClass(f);},end:function(){m.removeClass(f);k.transition({duration:1,opacity:0},function(){k.remove();});}}});});}}});}}};})();/* Copyright (c) 2014, Yahoo! Inc.  All rights reserved. */
YUI.add("transport_helper_service",function(f){var a="MPServices",e="TransportHelperServiceProvider",c="abort",d={},g=null;function b(h,i){this.arcadeTransport=h.getService("arcade_transport");this.moduleapi=h.getModuleApi(i);this.arcadeLiteEnabled=h.getProperty("arcadeLiteEnabled");}b.prototype={makeRequest:function(h,k){var j=f.clone(h||{},true),i=this.arcadeTransport;if(j.ups||j.udb||this.arcadeLiteEnabled==="0"){i=this.moduleapi;if(!j.ups){j.noups=1;}delete j.ups;delete j.udb;}j.args=f.merge(j.args,{prid:g});return{transport:i,id:i.makeRequest(j,k),abort:function(){return this.transport.abortRequest(this.id);}};},wasAborted:function(h){return(h&&(h.result===c||h.statusText===c));}};f[a][e]={name:"transport_helper",getService:function(h,i){if(!g){g=h.getProperty("requestId");}if(!d.hasOwnProperty(i)){d[i]=new b(h,i);}return d[i];}};if(f.ModulePlatform){f.ModulePlatform.registerService(f[a][e]);}},"1.0");/* Copyright (c) 2014, Yahoo! Inc.  All rights reserved. */
YUI.add("login",function(f){var x=null,B="MPServices",N="LoginProvider",e=f.ModulePlatform,n=f.config.win,A="p_30345826",k="at",F="ylogin",U="fblogin",v="fblink",t="fbrefresh",m="a."+F+",a."+U+",a."+v+",a."+t+",.login-tooltip",p="login:fbinfo_refreshed",I="click",r="vertical",o=/http[s]?:\/\/[\S]*[&|?].done=(.*)/,H=1,E=3,D,a,L,C=x,d,T,R,G=x,i="",b="",q="",M=x,w=[],j;function c(){return G;}function g(){R.one("#cookie-refresh").remove();if(M){M();}}function O(Y){var X=n.location.protocol+"//"+f.config.win.location.host,V=encodeURIComponent(X+"/credstore_proxy/CredStoreEventsProxy.php?callback_function=cookie_refresh"),W='<iframe id="cookie-refresh" src="https://login.yahoo.com/config/refresh_cookie?.done='+V+'" height="0px" width="0px" class="vh"></iframe>';M=Y;R.append(W);}function P(X,V){if(X&&X==="200"){O(function W(){n.location.replace(n.location.href.split("#")[0]);});}else{}}function h(){var W,V;V=f.on("message",function(X){var Y=X._event;if(Y.data&&Y.origin&&/https?:\/\/.*\.yahoo\.com:?[0-9]*$/.test(Y.origin)){if(V&&f.Lang.isFunction(V.detach)){V.detach();}P(Y.data,Y.origin);}});W=n.location.protocol+"//"+n.location.host+"/credstore_proxy/CredStorePopupProxy.php?spid="+T.spid+"&fbperms="+q;n.open(W,"fblink_popup","height=533,width=698,modal=yes,alwaysRaised=yes");}function S(X,W,V){var Y;if(L){Y=L.makeRequest({type:"module",moduleId:A,args:f.merge({_action:"show",_subAction:"getButtons",noups:1},W)},{success:function(Z){if(X&&Z.html){X.setContent(Z.html);}if(f.Lang.isFunction(V)){V();}},failure:function(Z){},scope:this});}}function l(X,Y,Z){var V={success:Z.onSuccess||function(){},failure:Z.onFailure||function(){},scope:this},W={type:"module",moduleId:A,args:{_action:"save",_subAction:X,value:Y}};L.makeRequest(W,V);}function u(){return b;}function J(V){q=V.fbPerms||"email,user_birthday,user_education_history,user_likes,user_location,user_relationships,user_subscriptions,user_work_history,friends_birthday,friends_education_history,friends_likes,friends_location,friends_work_history,publish_actions";i=V.fbAppId||"90376669494";}function Q(X,W){var V=X||i;if(n.FB){if(f.Lang.isFunction(W)){W();}return;}n.fbAsyncInit=function(){n.FB.init({appId:V,channelUrl:n.location.protocol+"//"+n.location.host+"/channel.html",status:true,cookie:true,xfbml:false});if(f.Lang.isFunction(W)){W();}};f.Get.script("//connect.facebook.net/en_US/all.js");}function z(){var W=function(X,Y){D.fireYwaBeacon({action:"reauthfb",rescode:Y});L.broadcast(p,X);if(X===true){f.all("a."+t).hide();}},V=function(){n.FB.getLoginStatus(function(Y){var ab,ac,aa,X,ad,Z;if(Y.status==="connected"){ac="q="+encodeURIComponent('insert into media.social.homerun.credential (accessToken, userID, expiresIn, signedRequest, spid, env) values("'+Y.authResponse.accessToken+'","'+Y.authResponse.userID+'","'+Y.authResponse.expiresIn+'","'+Y.authResponse.signedRequest+'", "'+T.spid+'", "prod")');aa="env="+encodeURIComponent(T.store);X="crumb="+T.crumb;ad=[ac,aa,X,"callback={callback}","format=json"].join("&");Z=["https://"+T.host+T.path+"?",ad];f.jsonp(Z.join(""),function(ae){var af;if(f.Object.getValue(ae,["query","results","result","status"])==="200"){af=f.Object.getValue(ae,["query","results","result","data","results","credential","issued_ts"]);l(k,af,{onSuccess:function(){W(true,0);},onFailure:function(){W(false,3);}});}else{W(false,4);}});}else{ab=(Y.status==="unknown")?1:2;W(false,ab);}});};if(!i){J({});}Q(i,V);}function K(X){var V=X.doneParams||"",W=n.location.protocol+"//"+n.location.hostname+V;n.location.replace(W);}function s(aa){var X=aa.currentTarget,Z=f.DOM.winWidth(),W=n.screen.height,Y=(f.UA.ie)?n.screenLeft:n.screenX,V,ad,ab,ac=a.getProperty("ywa.rapid.enabled.modules");if(X){if(X.test("a."+U)){aa.preventDefault();V=X.getAttribute("href");if(f.Lang.isString(V)&&!o.test(V)){V+=(V.indexOf("?")?"&":"?")+".done="+encodeURIComponent(n.location.href);}if(/https?:\/\/m?login\.yahoo\.com/.test(V)){aa.preventDefault();a.navigate(A,V);}else{ad=(Z+Y>820)?Z+Y-820:0;ab=(W>680)?(W-680)/2:0;n.open(V,"login","width=800,height=680,modal=yes,left="+ad+",top="+ab);}}else{if(X.test("a."+F+'[target="_blank"]')){aa.preventDefault();n.open(X.getAttribute("href"),"login","width=320,height=450,directories=0,titlebar=0,toolbar=0,location=0,status=0,menubar=0,scrollbars=no,resizable=no, top="+(aa.pageY+100)+", left="+(aa.pageX-200),true);}else{if(X.test("a."+F+'[target="_top"]')){V=X.getAttribute("href");if(f.Lang.isString(V)&&!o.test(V)){V+=(V.indexOf("?")?"&":"?")+".done="+encodeURIComponent(n.location.href);X.setAttribute("href",V);}}else{if(X.test("a."+v)){aa.preventDefault();h();}else{if(X.test("a."+t)){aa.preventDefault();n.open(X.getAttribute("href"),"fbrefresh","width=700,height=500,modal=yes");}}}}}if(X.test("a."+F+",a."+U+",a."+v)){if(typeof(ac)=="object"&&ac.hasOwnProperty("default-p_30345826")){D.fireBeacon(D.getBeaconKeys(X));}}if(X.test("a."+F+",a."+U)){f.Array.each(w,function(ae){if(X.test(ae.selector)&&f.Lang.isFunction(ae.clickHandler)){ae.clickHandler(X);}});}}}function y(){var Z={parentNode:R,className:["y-tooltip-login"],pointerClass:"img-sprite",position:{box:"l",arrow:"r"},autohide:true},W={sec:"login-tooltip",cacheKey:"login-svc",layout:r,title:"Sign in to save your preference",narrow:1},aa=[],X,Y,V;V={init:function(){var ab=this;Y=d.create(Z);f.on("scroll",function(){ab.hide();});Y.getNode().on("mouseout",function(){X=f.later(3000,this,function(){ab.hide();});});Y.getNode().on("mouseover",function(){X.cancel();});},_showTooltip:function(ad,ac){var ab=this;if(X){X.cancel();}Y.show(ad,ac);X=f.later(ac.hideDelay||3000,this,function(){ab.hide();});},show:function(ag){var ad=f.mix(ag.buttonConfig||{},W),ac=f.mix(ag.tooltipCong||{},Z),af=this,ae,ab;if(!ag.pointAtMeNode){return;}if(!aa[ad.cacheKey]){ae=f.Node.create("<div></div>");ab=function(){aa[ad.cacheKey]=ae;af._showTooltip(ag.pointAtMeNode,f.mix({msg:ae},ac));};S(ae,ad,ab);}else{f.later(250,this,function(){af._showTooltip(ag.pointAtMeNode,f.mix({msg:aa[ad.cacheKey]},ac));});}},hide:function(){if(Y&&Y.isVisible()){Y.hide();}}};V.init();return V;}j={getTooltip:function(){if(!C){C=new y();}return C;},configClick:function(W){var X=W.clickHandler||x,V=W.selector||"";w.push({selector:V,clickHandler:X});return this;},setupFBApp:J,displayFBLinkingDialog:h,getFBAcctLinkStatus:c,getFBLoginUrl:u,getButtons:S,loadFBSDK:Q,refreshCookie:O,updateFBAccessToken:z};f.namespace(B);f[B][N]={name:"login",getService:function(X,W){var V;D=X.getService("instrumentation");a=X.getService("moduleplatform");d=X.getService("tooltip");L=X.getModuleApi(W);T={spid:a.getProperty("credstore.spid"),host:a.getProperty("yql.host"),path:a.getProperty("yql.path"),publicPath:a.getProperty("yql.public.path"),store:a.getProperty("yql.store"),crumb:a.getProperty("yql.crumb"),env:a.getProperty("yql.env")};V=a.getProperty("fbauthstate");b=a.getProperty("login.fb.url");G=(V===H||V===E);if(!R){J({});R=f.one("body");R.delegate(I,s,m,this);}return j;},updateFBAccessToken:z,onFBConnectSuccess:P,onCookieRefresh:g,onYSignIn:K};if(e){e.registerService(f[B][N]);}},"1.0");/* Copyright (c) 2014, Yahoo! Inc.  All rights reserved. */
(function(){var C=null,k=true,x=false,o=47,A="-tuc",f="-nickname-p2",b="default",s="browser",y="parentNode",d="offsetWidth",g="width",z="hidden",a="tuc-dropdown",h="tuc-nickname",i=".name",j="active",D="y-bg-3",B="y-hdr-link",v="y-txt-1",e="27",m="px",q="tab_enter",t="tab_exit",r=400,u="rtl",p="d-n",n=".notif-panel",E=".recog-panel",w="notseen",l="seen",c=5;YModules.type_tuc={id:"",body:C,viewevents:["click"],moduleapi:C,autoHideService:C,autohideTuc:C,tucDropdown:C,type:C,menu:C,notificationEnabled:x,notificationChecked:x,isShown:x,timer:C,tucContentReqId:null,arcadeTransport:null,isWave3:x,isWave3badge:x,socialLoginEnable:x,isLoggedIn:x,isLoggedInFB:x,isLinkedFB:x,pageTitle:C,titleFlash:C,cometInited:x,cometInitRetryCount:0,init:function(F){this.Y=F.getService("yui");this.id=F.getId();this.moduleapi=F;this.platform=F.getService("moduleplatform");if(this.platform){this.arcadeTransport=this.platform.getService("arcade_transport");}else{this.arcadeTransport=F;}this.arcadeTransport=F;this.isWave3=F.getContextData("wave3");this.isWave3badge=F.getContextData("wave3badge");this.socialLoginEnable=F.getContextData("tuc.social.login");this.type=F.getProperty("type");this.browser=F.getContextData(s);this.isLoggedInFB=F.getContextData("fb.loggedin");this.isLinkedFB=F.getContextData("fb.account.linked");},onviewevent:function(H,F){var I=this.id,G=F.target;if(H===b){switch(G.get("id")){case I+"-tuc-nickname":case I+"-nickname-p1":case I+"-nickname-p2":case I+"-tuc-nickname-arrow":F.preventDefault();this.toggleTuc();break;default:if(G.hasClass("theme")){F.preventDefault();if(G.get("id")&&!G.get(y).hasClass("selected")){this.selectTheme(G);}}break;}}},onviewload:function(I){var H=this.moduleapi,J=this.id,G,F;this.isLoggedIn=(H.getService("userinfo").isLoggedIn()||H.getContextData("recognizedState"));if(I===b){this.body=H.getViewNode(b);this.autoHideService=H.getService("autohide");G=this.body;this.tucDropdown=G.getById(J+"-"+a);F=G.one(i);this.autohideTuc=this.attachEvents(F,{hide:this.tucHide,keyup:this.tucKeyUp});}if(this.isLoggedIn&&this.isWave3==k){H.listen(q);H.listen(t);if(H.getContextData("ucs_host")){this.notificationEnabled=true;this.countNode=this.body.one(".tab-badge");this.guid=H.getContextData("guid");this.pageTitle=document.title;this.body.delegate("click",this.onNotificationClicked,n+" .update a",this);this.body.delegate("click",this.onAllNotificationsClicked,n+" .updateurl a",this);this.body.delegate("click",this.onboardNotifications,n+" .onboard a",this);this.body.delegate("click",this.onRecognizedSignIn,E+" .verify",this);this.body.delegate("click",this.onManageLinkClicked,n+" .manage",this);this.body.delegate("click",function(K){K.preventDefault();this.showHide(!this.isShown);},".tab-icon",this);this.Y.later(3000,this,this.initComet);}}if(!this.isLoggedIn&&this.socialLoginEnable){H.listen(q);H.listen(t);}},initComet:function(){var F;if(!this.cometInited){this.Y.use("af-pipe",this.Y.bind(function(H){if(!this.Y.Object.getValue(this.Y,["Af","Pipe"])){if(this.cometInitRetryCount<c){this.cometInitRetryCount++;this.Y.later(300,this,this.initComet);return;}else{var G=this.moduleapi.getService("metrologger");if(G){G.logError(this.id,"error(type=comet Af-Pipe not Loaded error,code=500)");}this.cometInitRetryCount=0;return;}}F=new this.Y.Af.Pipe({pipe:{channel:"/UNP/alerts/*"}});F.config({msg_maxidle:600000,msg_throttle:1000,seq_algo:"noseq"});F.on("message",this.Y.bind(this.onNotification,this));F.on("error",function(J){var I=this.moduleapi.getService("metrologger");if(I){I.logError(this.id,J._type+"(type=comet error,code=500)");}this.fireNotificationBeacon({action:"error",t4:"error",slk:"UH 3 Notification Error",elmt:"UH 3 Notification Error"});},this);F.open();this.cometInited=k;},this));}},onviewunload:function(H){var G=this.body,F=G.one(i);if(H===b&&this.isWave3!=k){this.detachEvents(F,{hide:this.tucHide,keyup:this.tucKeyUp});this.tucDropdown=C;this.autohideTuc=C;this.autoHideService=C;}else{this.clear();if(this.menu){this.menu.destroy();}this.menu=C;}},attachEvents:function(I,H){var F,G;if(I){for(G in H){if(H[G]){switch(G){case"hide":F=this.autoHideService.register({targets:[I],hide:this.Y.bind(H[G],this,x)});break;case"keyup":I.on(G,H[G],this,k);break;default:break;}}}}return F;},detachEvents:function(H,G){var I=this.autoHideService,F;if(H){for(F in G){if(G[F]){switch(F){case"hide":if(I){I.unregister(G[F]);}break;case"keyup":H.detach(F,G[F]);break;default:break;}}}}},tucShow:function(){var K=this.id,G=this.body,F=G.getById(K+A),J=this.tucDropdown,I=F.getById(K+"-"+h),H=F.getById(K+f);J.removeClass(z);F.addClass(j);I.addClass(D);H.replaceClass(B,v);this.positionUserCard();},tucHide:function(){var L=this.id,G=this.body,K=this.countNode,F=G.getById(L+A),J=this.tucDropdown,I=F.getById(L+"-"+h),H=F.getById(L+f);J.addClass(z);F.removeClass(j);I.removeClass(D);H.replaceClass(v,B);if(K&&!K.hasClass(p)){this.hideNotificationCount();}},onmessage:function(H,F,G){if(G.moduleType==this.type){this.showHideLater(H==q);}},onMenuExecute:function(I){var H=I.url,F=I.relatedTarget.hasClass("popup"),G=I.relatedTarget.one("a"),J=G?G.get("target"):"";if(H&&!F){this.moduleapi.navigate(H,J);}},selectTheme:function(I){var F,J,G=this.moduleapi,H=I.get("id").split("th-")[1];F={type:"module",moduleId:this.id,args:{_container:0,_action:"show",_subAction:"theme",_theme:H}};J={success:this.handleThemeSuccess,failure:this.handleThemeFailure,argument:I,scope:this};G.makeRequest(F,J);},handleThemeSuccess:function(F,K){var J=this.Y.DOM.byId("tmp-css"),I,G,M,L,H;if(!J){return;}if(this.browser=="IE"){G=J.cloneNode(false);document.body.appendChild(G);if(G.styleSheet!==C){G.styleSheet.cssText=F.html;}else{window.location.reload();}J.parentNode.replaceChild(G,J);}else{if(J.hasChildNodes()){J.removeChild(J.firstChild);}J.appendChild(document.createTextNode(F.html));}I=this.body.getById(this.id+"-color").one(".selected");I.removeClass("selected");I=I.one("a");M=I.getStyle("backgroundPosition").split(" ");M[1]="0";I.setStyle("backgroundPosition",M[0]+" "+M[1]);L=K.get(y);M=K.getStyle("backgroundPosition").split(" ");M[1]="-15px";K.setStyle("backgroundPosition",M[0]+" "+M[1]);L.addClass("selected");H=this.moduleapi.getService("statemgr");if(H){H.update();}},handleThemeFailure:function(){},makeTucRequest:function(){var H={_action:"show",_subAction:"tuc_preview"},F=this.arcadeTransport,G=null,I={success:this.processTucSuccess,failure:this.processTucFailure,scope:this};G={type:"module",moduleId:this.id,args:H};this.requestObject=G;this.callback=I;if(F.isRequestPending(this.tucContentReqId)){F.abortRequest(this.tucContentReqId);}this.tucContentReqId=F.makeRequest(G,I);},processTucSuccess:function(F,G){this.body.appendChild(F.html);this.showHideTUC(k);},processTucFailure:function(F,G){},showHideLater:function(F){if(F===k&&this.cometInited===x&&this.notificationEnabled){this.initComet();}this.clear();this.timer=this.Y.later(r,this,this.showHide,F);},showHide:function(F){var G=this.menu;if(this.isShown==F){return;}if(!G){if(this.isWave3badge==k&&!this.body.one("#"+this.id+"-menu")){this.makeTucRequest();}else{this.showHideTUC(F);}}else{this.showHideTUC(F);}},showHideTUC:function(F){var I=this.moduleapi,H,L=this.menu,K,G,J=this.countNode;if(!L){H=I.getService("menu");L=H.create("#"+this.id+"-menu");L.on("execute",this.onMenuExecute,this);this.menu=L;}G=this.Y.one(".login-menu-pointer");this.clear();if(F){if(this.moduleapi.getViewDirection("default")==="rtl"){L.show({right:-88,top:110},null,"%");}else{L.show({left:-88,top:110},null,"%");}if(G){G.setStyle("display","block");}this.checkNotification();K=I.getService("instrumentation");K.fireBeacon(I.getContextData("showBeacon"));}else{if(G){G.setStyle("display","none");}L.hide(false);if(J&&!J.hasClass(p)){this.hideNotificationCount();}}this.isShown=!!F;},clear:function(){if(this.timer){this.timer.cancel();}this.timer=C;},toggleTuc:function(){var F=this.body.getById(this.id+A);if(F&&F.hasClass(j)){this.tucHide();}else{this.tucShow();}},tucKeyUp:function(F){if(F.keyCode&&F.keyCode==e){this.tucHide();}},positionUserCard:function(){var I=this.Y.UA,H=this.body,K=this.moduleapi.getViewDirection("default"),G=H.getById(this.id+"-"+h),N=G.getX(),M=G.get(d),F=this.tucDropdown,J=F.get(d),L=M+o;if(L>J){F.setStyle(g,L+m);}L=F.get(d);if(I.ie&&I.ie<8){if(K==u){F.setX(N+M-L);}else{F.setX(N);}}},onNotification:function(G){var I=G.pipe.data||{},H=parseInt(I.count,10)||0,J=this.body.one(".midauth"),K,F=true;if(H===0){this.hideNotificationCount();if(J){J.removeClass("hascount");}}else{if(this.countNode){this.countNode.set("text",H);this.countNode.removeClass(p);this.notificationChecked=x;K=H===1?this.moduleapi.getString("alert"):this.moduleapi.getString("alerts").replace("{0}",H);if(J){J.addClass("hascount");}if(document.hasFocus()){document.title=K;}else{if(this.titleFlash){this.titleFlash.cancel();}this.titleFlash=this.Y.later(1500,this,function(){document.title=F?K:this.pageTitle;F=!F;},null,true);}this.fireNotificationBeacon({action:"secvw",slk:"UH 3 Notification Badge Display",elmt:"UH 3 Notification Badge Display"});}}},hideNotificationCount:function(){var F=this.countNode;if(F&&!F.hasClass(p)){this.Y.later(500,this,function(){F.addClass(p);document.title=this.pageTitle;if(this.titleFlash){this.titleFlash.cancel();}this.titleFlash=C;this.makeUcsYqlCall('select * from ucs.user_notif_status where guid="'+this.guid+'" and clear="true"');});}},onNotificationClicked:function(G){var H=G.currentTarget.ancestor(".update"),F="UH 3 Notification CTA",I=H.getData("id");H.replaceClass(w,l);G.preventDefault();this.makeUcsYqlCall('update social.uhnotifications set state="seen" where id="'+I+'"');this.fireNotificationBeacon({slk:F,elmt:F,elm:"itm",itc:0,cpos:H.getData("cpos"),g:I});this.Y.later(800,this,function(){this.moduleapi.navigate(G.currentTarget.getAttribute("href"),"");});},onAllNotificationsClicked:function(G){var F="UH 3 Notification ViewAll SignedIn CTA";G.preventDefault();this.fireNotificationBeacon({rspns:"nav",slk:F,elmt:F,elm:"btn",itc:0});this.Y.later(800,this,function(){this.moduleapi.navigate(G.currentTarget.getAttribute("href"),"");});},onboardNotifications:function(G){var F="UH 3 Notification Learn More CTA";G.preventDefault();this.fireNotificationBeacon({rspns:"nav",slk:F,elmt:F,elm:"btn",itc:0});this.Y.later(800,this,function(){this.moduleapi.navigate(G.currentTarget.getAttribute("href"),"");});},onRecognizedSignIn:function(I){var H=I.currentTarget,G=H.hasClass("newmsg"),F=G?"UH 3 Notification SignIn New MidAuth CTA":"UH 3 Notification SignIn NoNew MidAuth CTA";this.fireNotificationBeacon({slk:F,elmt:F,itc:0,elm:"btn"});I.preventDefault();this.Y.later(800,this,function(){this.moduleapi.navigate(H.getAttribute("href"),"");});},onManageLinkClicked:function(G){var F="UH 3 Notification Manage CTA";G.preventDefault();this.fireNotificationBeacon({slk:F,elmt:F,itc:0,elm:"btn"});this.Y.later(800,this,function(){this.moduleapi.navigate(G.currentTarget.getAttribute("href"),"");});},fireNotificationBeacon:function(F){this.moduleapi.getService("instrumentation").fireBeacon(this.Y.mix({sec:"UH Desktop Notifications",t1:"a1",t2:"hd",t3:"Notifications",itc:1,action:"click"},F,true));},toRelativeTime:function(F,H){F=F||new Date();H=H||new Date();var G=(H.getTime()-F.getTime())/1000;return G<60?"less than a minute ago":G<120?"a min ago":G<3600?Math.floor(G/60)+" mins ago":G<7200?"an hour ago":G<86400?Math.floor(G/3600)+" hours ago":G<172800?"1 day ago":Math.floor(G/86400)+" days ago";},makeUcsYqlCall:function(L,F){var K=this.moduleapi.getContextData("ucs_crumb"),J=this.moduleapi.getContextData("ucs_host"),I="//"+J+"/v1/console/yql?q={q}&format=json&callback={callback}&crumb={crumb}",M={q:encodeURIComponent(L),crumb:K},G=this,H={on:{success:F,failure:function(O){var N=G.moduleapi.getService("metrologger");if(N){N.logError(G.id,"error(type=notification yql error,code=500)");}G.body.one(n).hide();G.fireNotificationBeacon({action:"error",t4:"error",slk:"UH 3 Notification Error",elmt:"UH 3 Notification Error"});}}};this.Y.jsonp(this.Y.Lang.sub(I,M),H);},checkNotification:function(){var M,G,L,K,I,H=this,F,J;if(!this.guid){return;}if(this.notificationChecked){F="UH 3 Notification Panel Display Old";this.fireNotificationBeacon({action:"secvw",slk:F,elmt:F});return;}if(this.moduleapi.getContextData("recognizedState")){F=this.countNode.hasClass(p)?"UH 3 Notification Panel Display NoNew MidAuth":"UH 3 Notification Panel Display New MidAuth";this.fireNotificationBeacon({action:"secvw",slk:F,elmt:F});return;}M=this.moduleapi.getString("loading_image");G=this.body.one(n);L=G?G.get("innerHTML"):null;K='SELECT * FROM social.uhnotifications(0,4) WHERE date="epoch" and state="seen|notseen" and guid="'+this.guid+'"';I=this.Y.Cookie.getSub("ucs","nt");if(I){G.addClass("loading").setHTML(M);}this.makeUcsYqlCall(K,function(Q){var P=Q.query&&Q.query.results?H.Y.Object.getValue(Q,["query","results","notifications","notification"]):null,N,O;F=I?"UH 3 Notification Panel Display Empty":"UH 3 Notification Panel Hide";G.removeClass("loading");if(P&&!H.Y.Lang.isArray(P)){P=[P];}if(P&&P.length>0){F="UH 3 Notification Panel Display Old";N='<ul class="notif-menu">';N+='<li class="banner d-b pr-l pl-l fz-xxs"><span>'+H.moduleapi.getString("notification_banner")+"</span>";N+=H.moduleapi.getString("notification_manage_url");N+="</li>";H.Y.Array.each(P,function(W,S){var T,V,R,U=W.state.toLowerCase();if(U===w){F="UH 3 Notification Panel Display New";R=parseInt(H.countNode.get("text"),10);T=S<R?" fw-b ":"";}O=H.Y.JSON.parse(W.meta.actionData)||{};V=O.thumbnail||O.icon;N+='<li class="update pos-r d-b ov-h '+U+'" data-id="'+W.id+'" data-cpos="'+(S+1)+'">';N+='<a href="'+decodeURIComponent(W.meta.pageUrl)+'">';if(V){N+='<img src="'+V+'" class="fl-r">';}if(W.meta.pageTitle){N+='<h4 class="fz-xs'+T+'ov-h pr-xxs title ell">'+W.meta.pageTitle+"</h4>";}J=O.text;if(J){J=H.Y.Lang.sub(J,{UH_b_start:"<strong>",UH_b_end:"</strong>"});N+='<div class="ov-h pr-xxs summary">'+J+"</div>";}if(W.created){N+='<div class="d-b fz-xxs time">'+H.toRelativeTime(new Date(parseInt(W.created+"000",10)))+"</div>";}N+="</a>";N+="</li>";});N+='<li class="updateurl d-b">'+H.moduleapi.getString("notification_url")+"</li>";N+="</ul>";G.setHTML(N).removeClass("dn");if(!I){H.Y.Cookie.setSub("ucs","nt",+(new Date()),{expires:new Date("January 12, 2025"),path:"/",domain:"yahoo.com"});}}else{if(I){G.setHTML(L);}}H.notificationChecked=true;H.fireNotificationBeacon({action:"secvw",slk:F,elmt:F});});}};})();/* Copyright (c) 2014, Yahoo! Inc.  All rights reserved. */
(function(){var d=null,e=d,c=false,b="click",a="default";YModules.type_login={body:d,id:"",moduleapi:d,loginService:d,fbAppConfig:d,accessTokenRefresh:c,init:function(g){e=g.getService("yui");var f=g.getContextData();this.id=g.getId();this.moduleapi=g;this.loginService=g.getService("login");this.fbAppConfig={fbAppId:f.fbAppId,fbPerms:f.fbPerms};this.accessTokenRefresh=f.accessTokenRefresh;},onviewload:function(f){if(f===a){this.body=this.moduleapi.getViewNode(f);this.loginService.setupFBApp(this.fbAppConfig);if(this.accessTokenRefresh){e.later(5000,this,function(){this.loginService.updateFBAccessToken();});}}},onviewunload:function(f){if(f===a){this.body=d;}},onviewevent:function(g,f){if(g===a){if(f.type===b){this.onClick(f);}else{}}}};}());/* Copyright (c) 2014, Yahoo! Inc.  All rights reserved. */
(function(){var g=null,k=false,e=true,l="pv-shown",j=".pv-ymail-preview",c="pv-loading",h="default",f="innerHTML",p="tab_enter",q="tab_exit",o="/user/ymail",i="mail_preview",b="get_mail_count",n=0,m=1,d=2,a=400;YModules.type_mail={id:"",body:g,api:g,viewevents:["click"],w3:k,type:g,isShown:k,timer:g,pv:g,loadState:g,shim:g,mailLoadReqId:g,arcadeTransport:g,refreshed:k,mailTranslations:g,isRecogStateMsgShown:k,isLoggedIn:k,init:function(r){this.Y=r.getService("yui");this.id=r.getId();this.api=r;this.platform=r.getService("moduleplatform");if(this.platform){this.arcadeTransport=this.platform.getService("arcade_transport");}else{this.arcadeTransport=r;}this.arcadeTransport=r;this.mailTranslations=r.getContextData("mailtranslations");this.type="mail";this.w3=e;},onviewload:function(w){var t=this.api,v=t.getService("userinfo").isLoggedIn(),s=t.getContextData("recognizedState"),r=parseInt(t.getContextData("logOutMsgDly"),10),u=t.getContextData("wssidToken");if(w===h){this.body=t.getViewNode(w);this.isLoggedIn=v;this.isRecogStateMsgShown=k;t.listen(p);t.listen(q);if(s||v){if(u){this.loadMailCount(u);}else{t.listen(o);}}else{if(r){this.showHide(e);this.showHideLater(k,r);}}}},onviewunload:function(r){if(r===h){this.body=g;}},onviewevent:function(w,v){var t=this.api,s=v.target,r,u;if(w===h){if(s.get("tagName")!=="A"){r=s.ancestor("TR");if(r){u=r.one(".subject A").getAttribute("href");t.navigate(u);}}else{if(s.hasClass("refresh-mail-account")){v.preventDefault();t.refreshView(h);t.refreshView("pa");}}}},onmessage:function(t,r,s){switch(t){case p:case q:if(s.moduleType==this.type){this.showHideLater(t==p);}break;case o:if(s){this.showVitalityCount(s);}break;default:}},showVitalityCount:function(w){var u,t,v,y,s,x,r;u=(w.data)?w.data:"";if(u){t=this.body.one(".tab-badge")||this.body.one(".mail-badge");if(t){t.set(f,u);t.removeClass("hidden");t.addClass("tab-badge-shown");t.setStyle("visibility","visible");}v=this.body.one(".mail-spr");if(v){v.addClass("tab-icon-unread");}y=this.body.one(".tab-badge-txt");if(y){if(u==1){x=this.mailTranslations.s;}else{x=this.mailTranslations.p;}x=x.replace("{0}",u);y.set(f,x);}if(this.api.getContextData("recognizedState")){r=this.api.getContextData("logOutMsgDly");s=this.body.one(".recog-email-msg");if(s&&x){if(this.isRecogStateMsgShown){this.Y.later(r,this,function(z){s.set(f,this.mailTranslations.r+" "+x);},e);}else{s.set(f,this.mailTranslations.r+" "+x);}}}}},clear:function(){if(this.timer){this.timer.cancel();}this.timer=g;},showHideLater:function(r,s){this.clear();this.timer=this.Y.later(s||a,this,this.showHide,r);},showHide:function(r){if(this.isShown==r){return;}this.clear();var t=this.api,v,u=this.pv,s;if(!u){u=this.body.getById(this.id+"-pv");if(!u){u=this.body.one(j);}this.pv=u;}if(!u){return;}s=this.Y.one(".mail-menu-pointer");if(r){this.loadMail();if(s){s.setStyle("display","block");}u.addClass(l);v=t.getService("instrumentation");v.fireBeacon(t.getContextData("showBeacon"));}else{if(s){s.setStyle("display","none");}u.removeClass(l);}this.isShown=!!r;},showHideRecogStateMsg:function(s){this.clear();var u=this.api,w,r,v=this.pv,t;if(!v){v=this.body.getById(this.id+"-pv");if(!v){v=this.body.one(j);}this.pv=v;}t=this.Y.one(".mail-menu-pointer");if(s){this.loadMail();if(t){t.setStyle("display","block");}v.addClass(l);w=u.getService("instrumentation");w.fireBeacon(u.getContextData("showBeacon"));}else{if(t){t.setStyle("display","block");}v.removeClass(l);r=this.body.one(".logmsg");r.remove(e);this.isRecogStateMsgShown=k;u.listen(p);u.listen(q);}},loadMail:function(){if(!this.isLoggedIn){return;}if(this.loadState){return;}var t=this.pv,r=this.arcadeTransport,s={type:"module",moduleId:this.id,args:{_action:"show",_subAction:i}};this.loadState=m;if(r.isRequestPending(this.mailLoadReqId)){r.abortRequest(this.mailLoadReqId);}this.mailLoadReqId=r.makeRequest(s,{success:this.loadMailSuccess,failure:this.loadMailFailure,scope:this});t.addClass(c);t.set(f,"");},loadMailSuccess:function(v,r){this.loadState=d;var t=this.pv,u,s;t.removeClass(c);t.set(f,v.html);if(this.api.getContextData("recognizedState")){s=this.body.one(".recog-email-msg");u=this.body.one(".tab-badge-txt");if(s&&u){s.set(f,this.mailTranslations.r+" "+u.get(f).toLowerCase()+".");}}},loadMailFailure:function(t,r){if(t.result=="abort"){return;}this.loadState=n;var s=this.pv;s.removeClass(c);s.set(f,this.api.getContextData("err"));},loadMailCount:function(s){var r={type:"module",moduleId:this.id,args:{_action:"show",_subAction:b,wssidToken:s}};this.arcadeTransport.makeRequest(r,{success:this.loadMailCountSuccess,failure:this.loadMailCountFailure,scope:this});},loadMailCountSuccess:function(u,r){var s=u.html,t=this.body.one(".tab-badge");if(t&&s!==undefined){t.set(f,s);t.removeClass("hidden");t.addClass("tab-badge-shown");t.setStyle("visibility","visible");}},loadMailCountFailure:function(s,r){}};}());/* Copyright (c) 2014, Yahoo! Inc.  All rights reserved. */
(function(){var b=true,c=false,d=null,e="fetch_selective_ad",a=window.DARLA||d;YModules.type_ads={api:d,deferred:d,id:d,location:d,locationCtr:d,Y:d,selectiveAdEventFired:c,lastScrollCheck:0,scrollThrottle:40,isReflexiveAdsEnabled:c,timeInterval:3000,adsPayload:"",lastAdCallCheck:0,selectiveAdMeta:d,init:function(f){var g=f.getService("yui");this.api=f;this.id=f.getId();this.Y=g;this.lastScrollCheck=+(new Date());},onviewload:function(m){var k,f,j=500,i=this.api,h=this.Y.Node.getDOMNode(i.getViewNode(m)),l=i.getContextData,n=l("adlocs"),o=this.Y.Selector.query("."+n,h,b),g=l("selectiveRendering");this.selectiveAdMeta=l("darlaCtx");if(this.selectiveAdMeta&&this.selectiveAdMeta.is_reflexiveads_enabled){this.isReflexiveAdsEnabled=true;}if(this.selectiveAdMeta&&this.selectiveAdMeta.reflexiveads_time_interval){this.timeInterval=this.selectiveAdMeta.reflexiveads_time_interval;}this.body=i.getViewNode(m);this.isSelectiveRender=g;this.location=n;this.locationCtr=o;if(g&&a){f=function(){var p=a.prefetched();return p&&this.Y.Array.indexOf(p,"LREC")!==-1;};k=this.Y.bind(function(){if(this.body.inViewportRegion()){this.fetchDarlaAd();}else{i.listen("fp:window:scroll");}},this);if(f()){this.Y.later(j,this,function(){if(f()){this.reserveHeight(c);return;}k();});}else{k();}}else{this.reserveHeight(c);}},fetchDarlaAd:function(){var f=this.selectiveAdMeta,g=this.location,l,i,h,j={},k=1;i=f.positionMeta;h=e+"_"+g;i.id=g.toUpperCase();if(window.location.protocol==="http:"){k=0;}l={ps:g.toUpperCase(),name:h,sp:f.spaceid,ssl:k,secure:1,ref:window.location.href,npv:1};if(f.sizeSiteAttr){j[g]=f.sizeSiteAttr;l.sa=j;}a.add(l);a.addPos([i]);a.event(h);},onmessage:function(f,g,h){if((!this.selectiveAdEventFired||this.isReflexiveAdsEnabled)&&"fp:window:scroll"===f){this.afterScroll();}},afterScroll:function(){var f=+(new Date()),g=f-this.lastScrollCheck;if(this.scrollTimer){this.scrollTimer.cancel();}if(g>this.scrollThrottle&&this.isSelectiveRender&&this.body.inViewportRegion()){if(!this.selectiveAdEventFired){this.fetchDarlaAd();this.selectiveAdEventFired=true;if(!this.isReflexiveAdsEnabled){this.api.unlisten("fp:window:scroll");}}else{this.checkScrollForReflexiveAds();}}else{if(this.isSelectiveRender&&this.body.inViewportRegion()){this.scrollTimer=this.Y.later(this.scrollThrottle-g,this,this.checkScrollForReflexiveAds);}}this.lastScrollCheck=f;},onviewunload:function(f){if(this.deferred){this.deferred.unregister();}if(this.isReflexiveAdsEnabled){this.api.unlisten("fp:window:scroll");}this.body=this.deferred=d;},reserveHeight:function(f){var h=f?"add":"remove",g=this.Y.DOM[h+"Class"];g(this.locationCtr,this.location+"-reserve");},checkScrollForReflexiveAds:function(){var f=+(new Date()),g=f-this.lastAdCallCheck;if(this.isReflexiveAdsEnabled&&this.isSelectiveRender&&this.selectiveAdEventFired&&g>(this.timeInterval-this.scrollThrottle)&&this.body.inViewportRegion()){this.loadReflexiveAd();this.lastAdCallCheck=f;}},loadReflexiveAd:function(){var f=this.Y,p=this.location,l=f.all(".type_stream li.content"),j=this.selectiveAdMeta,h={},o="",g=[],i=[],q=[],m={},n=e+"_"+p,k={ps:p.toUpperCase(),name:n,sp:j.reflexiveads_spaceid,ssl:window.location.protocol==="http:"?0:1,secure:1,ref:window.location.href,npv:1};if(j.sizeSiteAttr){m[p]=j.sizeSiteAttr;k.sa=m;}if(l){l.each(function(s){var r=[],t=s.getAttribute("data-wikiids");if(t){r=t.split("|");f.Array.each(r,function(u){q.push(u);});}});q=this.Y.Array.dedupe(q);f.Array.each(q,function(r){var s=r.split(":");if("YCT"===s[0]){i.push(s[1]);}else{g.push(s[1]);}});o="yct="+i.join()+" wiki_topic="+g.join();if(!this.diffPayloadEnabled||this.adsPayload!==o){this.adsPayload=o;h.sa=this.adsPayload;a.add(k);a.event(n,h);}}}};})();/* Copyright (c) 2014, Yahoo! Inc.  All rights reserved. */
var FP_SCROLL_EVENT="fp:window:scroll",FP_RESIZE_EVENT="fp:window:resize";YModules.type_navrail={body:null,id:"",moduleapi:null,viewevents:[],moreSitesMenuEnabled:false,instrumentation:null,siteMenuHideTimer:null,siteMenuExposeMenuTimer:null,platform:null,init:function(a){this.Y=a.getService("yui");this.id=a.getId();this.moduleapi=a;this.moreSitesMenuEnabled=!!parseInt(a.getContextData("use.more.sites.menu"),10);this.platform=a.getService("moduleplatform");this.instrumentation=a.getService("instrumentation");a.listen(FP_SCROLL_EVENT);a.listen(FP_RESIZE_EVENT);},onviewload:function(h){var d=this.moduleapi,g,c,a=this.platform,e=d.getContextData(),f,b;if(this.Y.one(".ad-rsch")){this.Y.one(".ad-rsch").setStyle("display","block");}if(h==="default"){this.body=d.getViewNode(h);if(this.moreSitesMenuEnabled){g=this.Y.one(".more-sites");if(g){this.Y.one(".navrail-more-menu-wrapper").appendTo(g);this.Y.one(".type_navrail .more-sites").on("click",this.Y.bind(function(i){b={sec:"pa-y",slk:"more",ltxt:this.Y.one(".more-sites .more-link").get("text"),itc:1};this.instrumentation.fireUltBeacon(b);this.exposeSiteMenu("more",i);},this));this.Y.one(".type_navrail .more-sites").on("mouseout",this.mouseenterleave,this,this.Y.bind(this.hideSiteMenu,this,"more"));this.Y.one(".navrail-more-menu").on("mouseover",this.mouseenterleave,this,this.clearSiteMenuHideTimer);this.Y.one(".navrail-more-menu").on("mouseout",this.mouseenterleave,this,this.Y.bind(this.hideSiteMenu,this,"more"));}}c=this.Y.one(".type_navrail .more-favs");if(c){c.on("click",this.Y.bind(this.exposeSiteMenu,this,"fav"),this);c.on("mouseout",this.mouseenterleave,this,this.Y.bind(this.hideSiteMenu,this,"fav"));this.Y.one(".navrail-fav-menu").on("mouseover",this.mouseenterleave,this,this.clearSiteMenuHideTimer);this.Y.one(".navrail-fav-menu").on("mouseout",this.mouseenterleave,this,this.Y.bind(this.hideSiteMenu,this,"fav"));}if(e&&e.adsfallbackData){f=e.adsfallbackData;a.registerModule(f);a.start(f.props.id,true,true);}else{}}},mouseenterleave:function(d,a){var c=d.currentTarget,b=d.relatedTarget;if(c!==b&&!c.contains(b)){a.call(this,d);}},onviewunload:function(a){if(a==="default"){this.body=null;}},onviewevent:function(b,a){},exposeSiteMenu:function(a,b){if(!this.siteMenuExposeMenuTimer){this.siteMenuExposeMenuTimer=setTimeout(this.Y.bind(function(){this.Y.one(".navrail-"+a+"-menu-wrapper").toggleClass("d-n");this.siteMenuExposeMenuTimer=null;},this),300);}if(b.target.ancestor(".more-link",true)){b.preventDefault();}},clearSiteMenuHideTimer:function(){if(this.siteMenuHideTimer){window.clearInterval(this.siteMenuHideTimer);this.siteMenuHideTimer=null;}},hideSiteMenu:function(a,b){if(!this.siteMenuHideTimer){this.siteMenuHideTimer=setTimeout(this.Y.bind(function(){this.Y.one(".navrail-"+a+"-menu-wrapper").addClass("d-n");this.siteMenuHideTimer=null;},this),700);}}};/* Copyright (c) 2014, Yahoo! Inc.  All rights reserved. */
(function(){var b="modal:open",a="modal:close";YModules.type_adsfallback={body:null,editBody:null,id:"",moduleapi:null,viewevents:["click"],setHomepageService:null,instrumentation:null,autoHideService:null,overlayEnabled:true,showSetHPOnLoad:false,chromeExtEnable:false,chromeExtLink:"",chromeExtEventState:false,init:function(c){this.Y=c.getService("yui");this.id=c.getId();this.moduleapi=c;this.setHomepageService=c.getService("sethomepage");this.instrumentation=c.getService("instrumentation");this.browser=c.getContextData("browser");this.overlayEnabled=!!c.getContextData("overlayEnabled");this.autoHideService=c.getService("autohide");this.showSetHPOnLoad=!!c.getContextData("showSetHPOnLoad");this.showSetHPOnLoadId=c.getContextData("showSetHPOnLoadId");this.canSetIE=this.setHomepageService.testIESetHomepage();this.metroIE=c.getContextData("metroIE");this.chromeExtEnable=c.getContextData("chromeExtEnable");this.chromeExtLink=c.getContextData("chromeExtLink");},onviewload:function(f){var e=this.moduleapi,d,c;if(f==="default"){this.body=e.getViewNode(f);if(this.chromeExtEnable){c={sec:"dssPromo",ltxt:1,slk:"btn",itc:1,camp:"dss",code:"yahoo",aid:"dss_yset_purbtn_cpgnv1_chr_us",action:"click"};this.body.getDOMNode().addEventListener("click",this.Y.bind(this.installOnclick,this,c));}d={};d["default-"+this.id]="pa-pr";this.loadFallbackAd();this.instrumentation.addModules(d);if(this.showSetHPOnLoad){if(this.Y.UA.ie&&this.canSetIE){this.setIEOverlay();}else{this.setHomePage();}}}else{if(f==="edit"){this.editBody=e.getViewNode(f);}}},onviewunload:function(c){if(c==="default"){this.body=null;}else{if(c==="edit"){this.editBody=null;}}},onviewevent:function(h,g){if(!this.overlayEnabled){return;}var j=this.id,i="",f=g.target,d=g.type,c;if(d==="click"){c=f.ancestor(".modal-close",true,"fp-modal")||f.ancestor("a",true,".type_adsfallback");if(c){if(c.hasAttribute("data-ylk")){this.instrumentation.fireBeacon(this.instrumentation.getBeaconKeys(c));}if(c.hasClass("myy")){return;}else{if(c.hasClass("hp")||c.hasClass("modal-close")){i=c.get("id");}}}switch(i){case j+"-homepage":if(this.Y.Array.indexOf(["IE","FF","WK","OP","CH"],this.browser)>-1){g.preventDefault();}if(!this.chromeExtEnable||(this.Y.Array.indexOf(["IE","FF","WK","OP"],this.browser)>-1)){this.setHomePage();}break;case j+"-mobilizer":break;case"modal-close-overlay":g.preventDefault();this.hideOverlay();break;default:break;}}},loadFallbackAd:function(){var d=this.moduleapi,i=this.body,k,l,e,m,f,h,c,g=true,j;k=d.getContextData("forceSethp");l=d.getContextData("randomPromo");e=d.getContextData("sethpPromoShare");m=d.getContextData("showOnlySetHP");f=d.getContextData("showOnlySpecial");if(i){j=i.getById(this.id+"-promotion");if(j){h=!this.setHomepageService.isHomepageSet();if((k||(h&&(!l||Math.random()>e)))&&!f){c="hpCode";}else{if(m===1){g=false;}c="promoCode";}if(g){j.set("innerHTML",d.getContextData(c));this.Y.one(".type_adsfallback_default").setStyle("display","block");}}}},setIEOverlay:function(){var c=this.moduleapi,d=c.getContextData("hpOverlay");d=this.Y.Node.create(d);d.delegate("click",function(e){c.broadcast(a);this.setHomePage();e.preventDefault();},".set-hp-lnk",this);c.broadcast(b,{config:{width:652,zIndex:50,srcNode:"",className:"fp-modal"},content:d});},setMobilizer:function(){var d="100%",i=document.documentElement.clientHeight+"px",f=document.body.scrollTop||document.documentElement.scrollTop,g=document.createElement("iframe"),e="99999",c=this.moduleapi.getContextData("locale"),j=this.moduleapi.getContextData("mobilizerUrl");if(document.getElementById("ymobilizerouter")){document.body.removeChild(document.getElementById("ymobilizerouter"));}g.src=j+"&lang="+c;g.setAttribute("id","ymobilizerouter");g.setAttribute("name","ymobilizerouter");g.setAttribute("allowTransparency","allowTransparency");g.setAttribute("frameborder",0);g.setAttribute("scrolling","no");g.setAttribute("width",d);g.setAttribute("height",i);g.style.position="absolute";g.style.left="0px";g.style.top=f+"px";g.style.zoom="1";g.style.zIndex=e;g.style.overflow="hidden";g.setAttribute("style","z-index:"+e+";position:absolute;top:"+f+"px;left:0px;width:"+d+";height:"+i+";");document.body.appendChild(g);if(typeof window.addEventListener!="undefined"){window.addEventListener("message",this.closeMobilizer,false);}else{if(typeof window.attachEvent!="undefined"){window.attachEvent("onmessage",this.closeMobilizer);}}},closeMobilizer:function(c){if(c.data=="closeYMBZ"){if(document.getElementById("ymobilizerouter")){document.body.removeChild(document.getElementById("ymobilizerouter"));}}},parseCode:function(){var d="100",e=document.location.search.substring(1),c=e.split("&");this.Y.Array.forEach(c,function(g){var f=g.split("=");if(f[0]=="hps"&&(typeof(f[1])!=="undefined")){d=f[1];}});return d;},setHomePage:function(){var m,k=this.setHomepageService,g=this.moduleapi,t,u,n,i,q,l=this.body,o=this.id,r=g.getContextData("hpOverlay"),p=g.getContextData("ilc"),d=this.parseCode(),j=g.getContextData("showSetHPOnLoadId"),e,f,c,h="fp-modal";if((this.browser=="IE"&&this.canSetIE)||this.browser=="FF"){t={t1:"a0",t2:"cue-hpset",t3:"ct",sec:"cue-hpset",ilc:1,camp:"hpset",code:d,outcome:"cuehpset",action:"secview"};if(j){t.f=j;}this.instrumentation.fireBeacon(t);}if(this.browser=="IE"&&this.canSetIE){if(k.setIEHomepage(p)){q=g.getContextData("promoCode");if(q!==""&&q!==null){m=document.getElementById(this.id+"-promotion");m.innerHTML=q;}else{n=l.getById(o+"-promotion");n.get("parentNode").removeChild(n);}t={t1:"a0",t2:"cue-hpset",t3:"ct",sec:"cue-hpset",slk:"btn-yes",elm:"btn",elmt:"cnfrm",itc:1,ilc:1,camp:"hpset",code:d,outcome:"hpset",action:"click"};this.fireAkqaBeacon();}else{t={rspns:"cl",t1:"a0",t2:"cue-hpset",t3:"ct",sec:"cue-hpset",slk:"btn-no",elm:"btn",elmt:"cl",itc:1,ilc:1,camp:"hpset",code:d,action:"click"};}if(j){t.f=j;}this.instrumentation.fireBeacon(t);}else{if(this.Y.Array.indexOf(["IE","FF","WK","OP","CH"],this.browser)>-1){i=this.Y.bind(function s(v){if(v.type==="click"){this.yBangClick(v);}else{this.fireFFBeacon(v);this.fireAkqaBeacon();}},this);r=this.Y.Node.create(r);r.delegate("click",i,".drag-icon",this);r.delegate("mousedown",i,".drag-icon",this);if(this.metroIE){if(typeof(window.ActiveXObject)=="undefined"&&window.navigator.msMaxTouchPoints){e=r.one("OL");f=this.Y.Node.create(this.metroIE);e.insert(f,"after");h+=" ie-metro-overlay";}}g.broadcast(b,{config:{width:652,zIndex:50,srcNode:"",className:h},content:r});}else{k.setHpCookie(p,"1");}}u={};u[this.id+"-set-homepage-overlay"]="cue-hpset";this.instrumentation.addModules(u);if(this.chromeExtEnable){t={sec:"dssPopup",slk:1,camp:"dss",code:"yahoo",aid:"dss_yset_purbtn_cpgnv1_chr_us",action:"secview"};if(j){t.f=j;}this.instrumentation.fireBeacon(t);c=this.Y.one(".y-modal-chrome-extension");if(c){t={sec:"dssPopup",ltxt:"install",slk:"btn",itc:1,camp:"dss",code:"yahoo",aid:"dss_yset_purbtn_cpgnv1_chr_us",action:"click"};if(j){t.f=j;}c.getDOMNode().addEventListener("click",this.Y.bind(this.installOnclick,this,t));}}},hideOverlay:function(){this.moduleapi.broadcast(a);},fireFFBeacon:function(){var g=this.setHomepageService,e=this.moduleapi,c,d=this.parseCode(),f=e.getContextData("showSetHPOnLoadId");c={t1:"a0",t2:"cue-hpset",t3:"ct",sec:"cue-hpset",slk:"icon",elm:"icn",elmt:"yh",ilc:1,itc:1,camp:"hpset",code:d,outcome:"hpset",action:"drag"};if(f){c.f=f;}this.instrumentation.fireBeacon(c);g.setHpCookie(e.getContextData("ilc"),"1");},fireAkqaBeacon:function(){var d=this.moduleapi.getContextData("beaconAkqaUrl"),c;if(d){c=this.body.create('<img src="'+d+'">');this.body.append(c);}},installOnclick:function(c,d){d.preventDefault();this.instrumentation.fireBeacon(c);if(chrome&&chrome.webstore&&!this.chromeExtEventState){this.chromeExtEventState=true;chrome.webstore.install(this.chromeExtLink,this.Y.bind(this.onInstallSuccess,this),this.Y.bind(this.onInstallFail,this));}},onInstallFail:function(c){this.chromeExtEventState=false;},onInstallSuccess:function(){this.chromeExtEventState=false;setTimeout(function(){var f="",c=top.location,d=c.protocol+"//"+c.host+c.pathname,g=document.location.search.substring(1),e=g.split("&");this.Y.Array.forEach(e,function(i){var h=i.split("=");if(h[0]=="hps"&&(typeof(h[1])!=="undefined")){f=h[1];}});if(f){top.location.href=(d+"?extimp=dss_yset_mktg_chr_us&extsrc="+f);}else{top.location.href=(d+"?extimp=dss_yset_purbtn_cpgnv1_chr_sb_us&extsrc=fp");}},1000);}};}());/* Copyright (c) 2014, Yahoo! Inc.  All rights reserved. */
(function(){var m=true,u=false,w=null,d=null,j="apps:resized",b="app-drag-over",c="below",q="dragNode",k="show-draggable",f="app-shadow",l=".reset-apps",p=".app",r=".fpad",s=".app-heading",t="."+c,g=p+" .drag-over-indicator",i="> .mod",x=".mod",e=".cursor-region",a=x+" "+p,h=x+" "+r,o="dd:toggle-draggable-ui",v=2,n="13923486";YModules.type_appscontainer={moduleapi:w,instrumentation:w,currentBucket:w,body:w,isBusy:u,viewevents:["click"],moduleCookieName:"fpms",isLoggedIn:u,enableAppReordering:u,enableAppReorderingLoggedOut:u,cookieDomain:w,hasMovedToTop:u,hasCustomAppOrder:u,lazyImageService:w,streamClickReordingEnabled:u,listeners:[],nextResize:null,init:function(y){d=y.getService("yui");this.id=y.getId();this.moduleapi=y;this.counter=parseInt(y.getContextData("deletedApps"),10);this.isLoggedIn=(y.getContextData("recognizedState")||y.getService("userinfo").isLoggedIn());this.rapidEnabled=this.moduleapi.getContextData("rapid.enabled");this.completeReordering=this.moduleapi.getContextData("lockOrdering");this.adPos=this.moduleapi.getContextData("adPosition");this.compReorder=this.moduleapi.getContextData("lockOrdering");this.instrumentation=y.getService("instrumentation");this.currentBucket=y.getContextData("currentBucket");this.enableAppReordering=y.getContextData("enableAppReordering");this.enableAppReorderingLoggedOut=y.getContextData("enableAppReorderingLoggedOut");this.enableLoginTooltip=y.getContextData("enableLoginTooltip");this.zIndex=d.one("#nav-col").getStyle("z-index");if(!this.isLoggedIn&&this.enableAppReorderingLoggedOut){this.statemgr=this.moduleapi.getService("statemgr");}if(!this.isLoggedIn&&this.enableLoginTooltip){this.loginService=y.getService("login");}},onviewload:function(z){var y=".app";this.body=this.moduleapi.getViewNode(z);this.streamClickReordingEnabled=this.moduleapi.getContextData("streamClickReordingEnabled");this.listeners.push(this.body.delegate("mouseover",this.onShowToolbar,y,this));this.listeners.push(this.body.delegate("mouseout",this.onHideToolbar,y,this));if(this.streamClickReordingEnabled){this.hasCustomAppOrder=this.moduleapi.getContextData("hasCustomAppOrder");this.moduleapi.listen("stream:filter");this.appOrder=this.getAppOrder();}if(window.navigator.maxTouchPoints&&window.navigator.maxTouchPoints>0){this.enableAppReordering=false;this.enableAppReorderingLoggedOut=false;}if((this.isLoggedIn&&this.enableAppReordering===m)||(!this.isLoggedIn&&this.enableAppReorderingLoggedOut)){this.listeners.push(this.body.once("mouseover",this.initDD,this));this.listeners.push(this.body.delegate("mouseover",this.onShowDraggable,s,this));this.listeners.push(this.body.delegate("mouseout",this.onHideDraggable,s,this));this.moduleapi.listen(o);}},onHideDraggable:function(z){var y=z.target.ancestor(x);if(y){this.toggleDraggableUi(y,"off");}},onShowDraggable:function(z){var y=z.target.ancestor(x);if(y){this.toggleDraggableUi(y,"on");}},toggleDraggableUi:function(z,y){if(y==="on"){if(!this.body.one(".disable-dd")){z.one(s).setStyle("cursor","move");z.addClass(k);z.one(p).addClass(f);}}else{z.one(s).setStyle("cursor","auto");z.removeClass(k);z.one(p).removeClass(f);}},getAppOrder:function(){var A=this.body.all(a),z=this.body.all(h),y=[];A.each(function(C,B){if(C.ancestor(x).getStyle("display")!=="none"){y.push(C.getAttribute("data-moduleid"));}});z.each(function(C,B){y.splice(v,0,n);});return y;},initDD:function(){var y=this.body,z=this;y.all(a).each(function(B,A){B.append(d.Node.create('<div class="top-region pos-a h-50"></div>'));});d.use("dd-delegate","dd-proxy","dd-drop","dd-drop-plugin","dd-scroll",function(G){var E,A,B=new G.DD.Delegate({container:".type_appscontainer",nodes:x,target:m,handles:[s]});B.dd.plug(G.Plugin.DDProxy,{moveOnEnd:u,cloneNode:u});B.dd.plug(G.Plugin.DDWinScroll,{buffer:100,horizontal:u});function H(M){var K,J=A,I=y.all(x),L;if(J){K=M.one(p).getData("modulesec");J.removeClass(b);if(J.hasClass(c)){if(J.next()){I.insert(M,J.next());}else{I.insert(M,J);I.insert(J,J.previous());}}else{I.insert(M,J);}L={slk:" drop",action:"drop",sec:K,t1:"a4",t2:K,t3:"hd",elm:"itm",elmt:"ctnr"};z.sendBeacon(L);z.rearrangeApps();}}function D(J){var I=J.one(".app").getAttribute("data-moduleid"),K=y.all(a);return K.getAttribute("data-moduleid").indexOf(I);}function F(K,O,Q){var P,R=A,N=y.all(x),J=y.all(i),I=0,S=0,L=A,M,T;if(R){I=Q;S=O;P=K.one(p).getData("modulesec");R.removeClass(b);if(R.hasClass(c)){if(S>=v&&I<(v)){L=J.item(I+2);M=0;while(M<(v-I-1)){L=L.next();M++;}if(I<(v-1)){N.insert(L,J.item(I+2));if(S==v){N.insert(K,R.next().next());}else{N.insert(K,R.next());}}else{N.insert(K.next().next(),K);if(S==v){N.insert(K,J.item(S+2));}else{N.insert(K,R.next());}}}}else{if((S<(v))&&I>=v){if(S<(v-1)){N.insert(K,R);M=0;L=R;while(M<(v-1)){L=L.next();M++;}N.insert(L,L.next().next());}else{N.insert(J.item(I+1),J.item(S));N.insert(J.item(S),J.item(S+1).next());}}}T={slk:" drop",action:"drop",sec:P,t1:"a4",t2:P,t3:"hd",elm:"itm",elmt:"ctnr"};z.sendBeacon(T);z.rearrangeApps();}}function C(L){var K,J,M,I=u;K=L.target.get("node");J=L.target.get(q);M=K.one(p).getAttribute("data-moduleid");A=w;y.all(x).each(function(R,Q){var P,N=R,O=N.one(".top-region");if(!I&&O&&!N.hasClass("yui3-dd-dragging")&&J.one(e).inRegion(O)){N.addClass(b);I=m;A=N;A.modIndex=Q;if(Q==1){G.one("#nav-col").setStyle("z-index",parseInt(z.zIndex,10)+2);}else{G.one("#nav-col").setStyle("z-index",z.zIndex);}if(G.UA.ie&&G.UA.ie<8&&!N.one(g)){N.one(p).append(G.Node.create('<div class="drag-over-indicator pos-a w-100"></div>'));}}else{N.removeClass(b);if(G.UA.ie&&G.UA.ie<8){P=N.one(g);if(P){P.remove(m);}}}});}B.on("drag:mouseDown",function(I){if(y.one(".disable-dd")){I.halt();}});B.on("drag:start",function(O){O.preventDefault();B.dd.winscroll.start();var M,N,L=O.target,J=L.get("node").one(p),K=L.get(q),I=J.getData("modulesec");if(!K.one(e)){K.append(G.Node.create('<div class="cursor-region w-100 pos-r"></div>'));}y.all(p).each(function(Q,P){if(Q.getData("moduleid")===J.getData("moduleid")){E=P+1;}});N={slk:" drag",action:"drag",sec:I,t1:"a4",t2:I,t3:"hd",elm:"itm",elmt:"ctnr"};z.sendBeacon(N);K.setStyles({opacity:".3",borderColor:"#aaaaaa",backgroundColor:"#dbdbdb"});M=L.get("node").next();while(M){M.addClass(c);M=M.next();}});B.on("drag:drag",G.throttle(C,50));B.on("drag:end",function(K){var L=y.one(t),I=0,J=0;B.dd.winscroll.end();if(A&&K.target){I=D(A);J=D(K.target.get("node"));G.one("#nav-col").setStyle("z-index",z.zIndex);if(((I<v&&J>=v)||(I>=v&&J<v))&&(z.compReorder==1)){F(K.target.get("node"),I,J);}else{H(K.target.get("node"));}}while(L){L.removeClass(c);L=L.next();}A=w;if(G.UA.ie&&G.UA.ie<8){y.all(".drag-over-indicator").each(function(N,M){N.remove(m);});}});});},onShowToolbar:function(B){var A=B.target.ancestor(p,m),z=(A)?A.one(".app-ctas"):w,y=A.one(".app-remove-confirm");if(!y){this.show(z);}},onHideToolbar:function(A){var z=A.target.ancestor(p,m),y=(z)?z.one(".app-ctas"):w;this.hide(y);},show:function(y){if(y){y.removeClass("v-h");y.removeClass("d-n");}},hide:function(y){if(y){y.addClass("v-h");y.addClass("d-n");}},display:function(y){if(y){y.removeClass("d-n");}},onviewunload:function(y){this.body=w;d.Array.each(this.listeners,function(z){z.detach();});this.listeners=[];},onviewevent:function(A,y){if(this.isBusy){return;}var z=y.target;if(z.ancestor(".halt",true)||z.ancestor(".app-remove-confirm-body",true)){y.preventDefault();this.handleDefaultClick(z);}},onmessage:function(B,z,A){var y=z==="fstream"||z==="stream";if(y&&B==="stream:filter"&&A){this.onStreamFilter(A);}if(B===o&&A.el&&A.toggle){this.toggleDraggableUi(A.el,A.toggle);}},handleDefaultClick:function(E){var F,D,y,A,B,z=w,C;F=E.ancestor(p,true);if(F){D=F.getAttribute("data-moduleid");y=F.getAttribute("data-modulesec");}if(!this.isLoggedIn&&this.enableLoginTooltip&&E.hasClass("login-tooltip-app")){A=F.getData("login-tooltip-msg");B={sec:y+"-auth",cacheKey:E.hasClass("remove-cta")?"remove-"+y:y};if(d.Lang.isString(A)&&!E.hasClass("remove-cta")){B.title=A;}this.loginService.getTooltip().show({pointAtMeNode:E,buttonConfig:B});return;}else{if(E.hasClass("remove-app")||E.hasClass("remove-cta")){if(D){this.confirmRemoveApp(D);}}else{if(E.hasClass("app-remove-confirm-remove")){if(D){C={slk:"rm",action:"click",sec:y,t1:"a4",t2:y,t3:"rm",elm:"btn",elmt:"rm"};this.sendBeacon(C);this.removeApp(D);}}else{if(E.hasClass("app-close-button")||E.hasClass("app-remove-confirm-cancel")){if(D){z=E.ancestor(".app-remove-confirm");if(z&&z.getAttribute("data-context")==="signin-cta"){C={slk:"cl",action:"click",sec:y,t1:"a4",t2:y,t3:"ctrl",elm:"btn",elmt:"cl"};this.sendBeacon(C);}else{C={slk:"cl",action:"click",sec:y,t1:"a4",t2:y,t3:"rm",elm:"btn",elmt:"cl"};this.sendBeacon(C);}this.hideConfirmRemoveApp(D);}}else{if(E.hasClass("rearrange-apps")){this.rearrangeApps(w);}else{if(E.ancestor(".reset-apps",true,".reset-apps-container")){C=this.instrumentation.getBeaconKeys(E);this.sendBeacon(C);this.resetApps();}}}}}}},sendBeacon:function(A){if(this.rapidEnabled){var y={cpos:0,pos:0,itc:1,test:this.currentBucket},z;for(z in A){if(A.hasOwnProperty(z)){y[z]=A[z];}}this.instrumentation.fireBeacon(y);}},confirmRemoveApp:function(J){var D=d.one("#appMgmtDialog"),H=this.body,I=H.one("#default-p_"+J),y=I.one(".app-wrapper"),E=I.one(".show-panel"),F=this.moduleapi.getContextData("removeCta"),A=this.moduleapi.getContextData("removeCtaRemoveBtn"),B=this.moduleapi.getContextData("removeCtaCancelBtn"),C='<div class="app-remove-confirm ta-c"><div class="app-remove-confirm-body"><h3 class="fz-s mb-m app-remove-confirm-message">'+F+'</h3><div class="cf d-ib"><button class="fl-l btn secondary app-remove-confirm-cancel">'+B+'</button> <button class="fl-l btn dismissal app-remove-confirm-remove">'+A+"</button></div></div></div>",z=y.one(".app-remove-confirm"),G=I.one(".app-ctas");if(!this.isLoggedIn&&D){C='<div class="app-remove-confirm ta-c p-l pb-xl" data-context="signin-cta">'+D.get("innerHTML")+"</div>";}if(!z){y.insert(C,"after");z=I.one(".app-remove-confirm");this.hide(y);y.addClass("d-n");this.hide(G);if(E){E.addClass("v-h");}}},onStreamFilter:function(D){if(this.hasCustomAppOrder){return;}var A=D&&D.category,E={"YPROP:SPORTS":".type_sportacular","YPROP:FINANCE":".type_finance","YPROP:OMG":".type_topvideos","YPROP:LIFESTYLES":".type_horoscope"},F=d.Object.owns(E,[A]),I=this,y,H,C,z,B,G;if(F&&A&&this.body.one(E[A])){y=this.body.one(E[A]).ancestor(x);if(y){H=y.one(p);B=H.get("offsetHeight");H.setStyles({height:"0px",overflow:"hidden"});this.body.insert(y,1);H.transition({duration:0.25,easing:"ease-in",height:B+"px"},function(){var J=H.all(".lzbg");H.setStyles({height:"auto",overflow:"visible"});if(J.size()>0){J.each(function(L,K){if(!I.lazyImageService){I.lazyImageService=I.moduleapi.getService("lazyimage");}I.lazyImageService.loadImage(L);});}});this.hasMovedToTop=m;}}else{if(this.hasMovedToTop&&!F){z=this.body.all(a);C=[];z.each(function(K,J){C[K.getAttribute("data-moduleid")]=K.ancestor(x);});if(d.Lang.isArray(this.appOrder)&&this.appOrder.length>0){G=I.body.one(".reset-apps-container")||I.body.one(".app-remove-confirm");if(!G){return;}d.Array.each(this.appOrder,function(K,J){if(J===0){B=C[K].get("offsetHeight");C[K].setStyles({height:"0px",overflow:"hidden"});I.body.insert(C[K],G);C[K].transition({duration:0.25,easing:"ease-in",height:B+"px"},function(){C[K].setStyles({height:"auto",overflow:"visible"});});}else{I.body.insert(C[K],G);}});}this.hasMovedToTop=u;}}},removeApp:function(z){var y={type:"module",moduleId:this.id,args:{_container:0,_id:this.id,_action:"save",_subAction:"removeApp",appIdToRemove:z,is_pageload:u}},A={success:this.handleGetDataSuccess,failure:this.handleGetDataError,scope:this,argument:{appId:z,is_pageload:u,removeApp:m}};if(this.hasMovedToTop){y.args.appOrder=this.getAppOrder();}this.isBusy=m;this.moduleapi.makeRequest(y,A);},hideConfirmRemoveApp:function(C){var y=this.body,B=y.one("#default-p_"+C),z=B.one(".app-wrapper"),A=B.one(".app-remove-confirm"),D=B.one(".show-panel");if(A){A.remove(true);}this.show(z);if(D){D.removeClass("v-h");}},rearrangeApps:function(z){if(this.isLoggedIn){var y={type:"module",moduleId:this.id,args:{_container:0,_id:this.id,_action:"save",_subAction:"rearrangeApps",appOrder:z||this.getAppOrder(),is_pageload:u}},A={success:this.handleGetDataSuccess,failure:this.handleGetDataError,scope:this,argument:{is_pageload:u}};this.isBusy=m;this.moduleapi.makeRequest(y,A);}else{this.statemgr.setUserModuleState("appOrder",(z||this.getAppOrder()).join(","));this.statemgr.update();}},resetApps:function(){var y={type:"module",moduleId:this.id,args:{_container:0,_id:this.id,_action:"save",_subAction:"resetApps",is_pageload:u}},z={success:this.handleGetDataSuccess,failure:this.handleGetDataError,scope:this,argument:{reset:m,is_pageload:u}};this.isBusy=m;this.moduleapi.makeRequest(y,z);},refreshView:function(z){var y={type:"module",moduleId:this.id,args:{_container:0,_id:this.id,_action:"show",_subAction:"refreshApps",is_pageload:u}},A={success:this.handleGetDataSuccess,failure:this.handleGetDataError,scope:this,argument:{is_pageload:u}};this.isBusy=m;this.moduleapi.makeRequest(y,A);},handleGetDataSuccess:function(A,D){var y=this.body,F,E,C=y.one(".reset-apps-container"),z,B;F=D.appId;if(F){E=(F)?y.one("#default-p_"+F):undefined;this.hideConfirmRemoveApp(F);E.setStyle("display","none");B=this.moduleapi.getString("RESTORE.ONE");this.counter++;if(this.counter==1){y.one(l).setHTML(B);}else{z=this.moduleapi.getString("RESTORE.X");z=z.replace("{0}",this.counter);y.one(l).setHTML(z);}this.moduleapi.broadcast(j);this.hasCustomAppOrder=m;this.show(C);}if(D.reset===m){window.location.reload();}this.isBusy=u;this.appOrder=this.getAppOrder();},handleGetDataError:function(y,z){this.isBusy=u;}};}());/* Copyright (c) 2014, Yahoo! Inc.  All rights reserved. */
(function(){var b=false,c=null,a=true,d=null;YModules.type_topvideos={body:c,ccode:c,ct:c,editBody:c,id:"",videoInlineEnabled:b,moduleapi:c,searchBoxEnabled:b,searchBoxBlur:c,videoService:c,viewevents:["click","focus"],yepPlayer:c,init:function(e){d=e.getService("yui");this.id=e.getId();this.moduleapi=e;this.ccode=e.getContextData("ccode");this.ct=e.getContextData("ct")||3;this.searchBoxEnabled=e.getContextData("searchBoxEnabled");this.videoInlineEnabled=e.getContextData("video.inline.enabled");},onviewload:function(f){var e=this.moduleapi;if(f==="default"){this.body=e.getViewNode(f);if(!this.searchBoxBlur){this.searchBoxBlur=this.body.delegate("blur",function(j){var i=j.target,h=i.get("value"),g=i.getAttribute("placeholder");if(h.length===0||g===h){i.addClass("videos-input-inactive");i.set("value",g);}},".videos-input");}}else{if(f==="edit"){this.editBody=e.getViewNode(f);}}},onviewunload:function(e){if(e==="default"){this.body=c;}else{if(e==="edit"){this.editBody=c;}}if(this.searchBoxBlur){this.searchBoxBlur.detach();this.searchBoxBlur=c;}},onviewevent:function(k,j){var i=j.target,f=i.getAttribute("placeholder"),g=i.get("value"),h,l=b;if(this.videoInlineEnabled&&j.type==="click"){h=i.ancestor("li.video-inline",true,"li");if(h){l=this.handleInlineVideo(h,i);}}if(this.searchBoxEnabled){if(j.type==="focus"||j.type==="click"){if(i.hasClass("videos-input")&&f===g){i.set("value","");if(i.hasClass("videos-input-inactive")){i.removeClass("videos-input-inactive");}}}}if(l){j.preventDefault();}},handleInlineVideo:function(k,f,e){var i=k.one("a"),h=this.body.one(".app-featured.videos"),j,l,g;if(!k){return b;}if(!this.videoService){this.videoService=this.moduleapi.getService("videoyep");if(this.videoService!==""){this.yepPlayer=this.videoService.create();}}if(!this.yepPlayer){return b;}if(i){g=i.get("href");}j=k.getData();if(j&&j.sec&&j.uuid&&j.pos){l={analytics:{sec:j.sec,cpos:parseInt(j.pos,10),ccode:this.ccode,ct:3},config:{animated:b,attach:h,location:"prepend",returnTabIndexTo:f,yep:{id:j.uuid,autoplay:true},videoPageUrl:g||c}};this.yepPlayer.init(l);return a;}}};}());/* Copyright (c) 2014, Yahoo! Inc.  All rights reserved. */
(function(){var d="default",i="edit",c=null,f="location:update",j="location:picker-open",g="location:picker-close",b=".app-ctas",h=".app",e="v-h",a="d-n";YModules.type_weather={id:"",body:null,editBody:null,api:null,viewevents:["click"],locdropWidget:null,userCitySelection:null,ldwService:null,listeners:[],defaultScale:null,locationPickerEnabled:false,locationService:null,locationInstance:null,loadLocationListener:null,init:function(k){this.Y=k.getService("yui");this.id=k.getId();this.api=k;this.platform=k.getService("moduleplatform");this.instrumentationService=k.getService("instrumentation");this.rapidEnabled=this.api.getContextData("rapid.enabled");if(this.platform){this.arcadeTransport=this.platform.getService("arcade_transport");}else{this.arcadeTransport=k;}this.arcadeTransport=k;},onviewload:function(o){var m=this.api,k,n,l;this.locationPickerEnabled=m.getContextData("locationPickerEnabled");if(o===d){this.body=m.getViewNode(o);k=this.body.one(".celsius");if(!m.getContextData("isApp")){this.listeners.push(this.body.delegate("mouseover",this.onShowToolbar,h,this));this.listeners.push(this.body.delegate("mouseout",this.onHideToolbar,h,this));}this.loadLocationListener=this.body.delegate("mouseover",this.loadLocationWidget,h,this);l=m.getContextData("locationModuleMeta");if(l){l.state.view="default";this.platform.registerModule(l);this.platform.start(l.props.id,false,true);}if(this.rapidEnabled){this.instrumentationService.refreshModule(this.body);}if(k&&k.hasClass("selected")){this.defaultScale="C";}else{this.defaultScale="F";}}if(o===i){this.editBody=m.getViewNode(o);if(this.editBody.one("#weather-locdrop-widget")&&this.locdropWidget===null){this.subscribeLocdropWidgetV2("weather-locdrop-widget");}n=this.editBody.one(".scale-option.selected input");if(n){this.defaultScale=n.get("value");}}},onviewunload:function(k){if(k===d){this.body=null;if(this.locationPickerEnabled){this.locationService=null;if(this.locationInstance){this.locationInstance.destroy();this.locationInstance=null;}}}if(k===i){this.editBody=null;}this.Y.Array.each(this.listeners,function(l){l.detach();});this.listeners=[];this.platform.unsubscribe(f,this.handleLocationUpdate);},onviewevent:function(s,q){var p=this.api,m=q.target,u=this,k,t=m.ancestor(".tempUnit",true),r,n,o,l=m.ancestor(".loc-picker-link",true)||m.ancestor(".loc-picker-icon",true);if(s===d){if(m.ancestor(".settings-cta",true)){p.openView("edit");return;}if(t){q.preventDefault();if(!m.hasClass("unit")){return;}r=m.hasClass("celsius")?"C":"F";if(r===this.defaultScale){return;}this.defaultScale=r;m.ancestor(".scale",true).one(".selected").removeClass("selected");m.addClass("selected");n=this.body.all(".temp");n.each(function(v){o=u.convertTemp(v.get("innerHTML"),u.defaultScale);v.setContent(o);});this.arcadeTransport.makeRequest({type:"module",moduleId:this.id,args:this.Y.merge({_action:"save",_subAction:"saveScalePref",tempScale:this.defaultScale})},{success:function(){},failure:function(){},scope:this,argument:this.Y.merge({subAction:"saveScalePref"})});}else{if(this.body.one(".wrapper-current")&&m.ancestor(".current",true,".type_weather")){window.location=this.body.one(".wrapper-current").one("a").getAttribute("href");}else{if(l&&!this.locDropLoaded){this.loadLocationWidget(l,true);}}}}else{if(s===i){if(m.ancestor(".lw-anchor-item",true)){this.manageLocdropWidgetToggle("opened");}if(m.hasClass("edit-save-btn")){q.preventDefault();this.arcadeTransport.makeRequest({type:"module",moduleId:this.id,args:this.Y.merge({_action:"save",_subAction:"saveScalePref",tempScale:this.defaultScale})},{success:function(){p.refreshView(d);this.cleanUpLocdropWidget();p.closeView(i);},failure:function(){},scope:this,argument:this.Y.merge({subAction:"saveScalePref"})});}if(m.ancestor(".scale-option",true)){k=m.ancestor(".scale-option",true).one("input").get("value");this.setScalePreference(k);}}}},subscribeLocdropWidgetV2:function(l){var m=this.api,p,r,n,q,k,o,s;m.listen("ldw:defaultlocation");if(this.ldwService===null){this.ldwService=m.getService("ld_service");}r=m.getContextData("locdrop_crumb");p=m.getContextData("locale");n=m.getContextData("best_loc");k=m.getContextData("cur_loc");q=m.getContextData("def_loc");o=this.userCitySelection||m.getContextData("user_loc");s={crumb:r,locale:p,bestLoc:n,currentLoc:k,defaultLoc:q,anchorText:o,anchorClass:"loc-label fz-s",strFind:m.getContextData("strFind"),glApi:m.getContextData("useGlApi")};this.locdropWidget=this.ldwService.create(l,s);this.locdropWidget.on("locationselect",this.onLocWidgetSelect,this);this.locdropWidget.on("widgetclose",this.manageLocdropWidgetToggle,this);},onLocWidgetSelect:function(k){this.platform.fire(f,k);this.userCitySelection=k.city;this.editBody.one(".loc-input").set("value",this.userCitySelection);this.api.refreshView(d);this.cleanUpLocdropWidget();this.api.closeView(i);},manageLocdropWidgetToggle:function(l){var k=this.editBody.one(h);if(l==="opened"){k.setStyle("zIndex","51");}else{k.setStyle("zIndex","");}},cleanUpLocdropWidget:function(){if(this.locdropWidget){this.locdropWidget.detachAll();this.locdropWidget.destroy();this.locdropWidget=null;delete (this.locdropWidget);this.ldwService=null;}},initLocation:function(k){var n=this.body.one(".loc-picker"),m=this.api,l;if(n){if(!n.one(".loc-picker-link")){return false;}this.Y.use("location_service","ld_service","lw_view",this.Y.bind(function(o){this.locDropLoaded=true;this.locationService=m.getService("location_service");l={locDropSettings:{crumb:m.getContextData("locdrop_crumb"),locale:m.getContextData("locale"),bestLoc:m.getContextData("best_loc"),curLoc:m.getContextData("cur_loc"),defLoc:m.getContextData("def_loc"),userLoc:this.userCitySelection||m.getContextData("user_loc"),anchorClass:"",strFind:m.getContextData("strFind"),glApi:m.getContextData("useGlApi")},beacon:{sec:m.getContextData("beacon_sec"),rspns:m.getContextData("beacon_rspns"),t1:m.getContextData("beacon_t1"),t2:m.getContextData("beacon_t2"),t3:m.getContextData("beacon_t3"),elm:m.getContextData("beacon_elm"),elmt:m.getContextData("beacon_elmt"),slk:m.getContextData("beacon_slk")},parentBody:this.body};if(this.locationService){this.locationInstance=this.locationService.create(n,this.id,m,l);}if(k){this.locationInstance.exposeMenu(k);}this.platform.subscribe(f,this.handleLocationUpdate,this);m.listen(j);m.listen(g);},this));}},setScalePreference:function(p){var k=this.editBody.one(".scale"),o=k.one(".fahrenheit"),n=k.one(".celsius"),m,l;if(p==="F"){m=o;l=n;}else{m=n;l=o;}l.removeClass("selected");l.one("input").set("checked","");m.addClass("selected");m.one("input").set("checked","checked");this.defaultScale=p;},show:function(k){if(k){k.removeClass(e);k.removeClass(a);}},hide:function(k){if(k){k.addClass(e);k.addClass(a);}},onShowToolbar:function(m){var l=m.target.ancestor(h,true),k=(l)?l.one(b):c;if(this.locationPickerEnabled&&!this.locationService){this.initLocation();}this.show(k);},onHideToolbar:function(m){var l=m.target.ancestor(h,true),k=(l)?l.one(b):c;this.hide(k);},loadLocationWidget:function(k,l){if(this.locationPickerEnabled&&!this.locationService){if(l){this.initLocation(k);}else{this.initLocation();}this.loadLocationListener.detach();}},onmessage:function(m,k,l){if(k==="weather"){switch(m){case j:this.body.one(".app").setStyle("zIndex","51");this.body.one(".current").setStyle("zIndex","2");break;case g:this.body.one(".app").setStyle("zIndex","");this.body.one(".current").setStyle("zIndex","");break;default:}}},handleLocationUpdate:function(){var l=this.api,k=l.getContextData("forceIpLocation")===1,m=l.getService("statemgr");if(k&&m){m.setUserPageState("bypassUserLocPref",0);}if(this.platform.getProperty("loc.cookie.persistent")&&m){m.setUserPageState("_fpts",Math.round(new Date().getTime()/1000));}l.refreshView(d);},convertTemp:function(k,l){switch(l){case"F":return Math.round(k*1.8+32);case"C":return Math.round((k-32)/1.8);default:return k;}}};}());/* Copyright (c) 2014, Yahoo! Inc.  All rights reserved. */
(function(){var d="default",a=".horoscope-sign",c=".halt",b;YModules.type_horoscope={moduleapi:null,body:null,isBusy:false,viewevents:["click"],moduleCookieName:"fpms",cookieDomain:null,cookieSignKey:null,statemgr:null,init:function(e){this.Y=e.getService("yui");this.id=e.getId();this.moduleapi=e;this.instrumentationService=e.getService("instrumentation");this.rapidEnabled=this.moduleapi.getContextData("rapid.enabled");if(!b){b=e.getService("aria");}this.statemgr=e.getService("statemgr");this.cookieDomain=e.getContextData("cookieDomain");this.cookieSignKey=e.getContextData("cookieSignKey");},onviewload:function(f){var e=this.moduleapi;this.body=e.getViewNode(f);},onviewunload:function(e){this.body=null;},onviewevent:function(g,e){if(this.isBusy){return;}var f=e.target;if(f.test(c)||f.ancestor(c)){e.preventDefault();this.handleDefaultClick(f);}},handleDefaultClick:function(g){var f=g.ancestor(a,true),e=null;if(f){e=f.getAttribute("data-sign-id");}if(e!==null||g.hasClass("change-sign")){this.changeView(e);}},changeView:function(e){var f={type:"module",moduleId:this.id,args:{_container:0,_id:this.id,_action:"show",_subAction:"changeView",selectedSign:e,is_pageload:"false"}},g={success:this.handleGetSignDataSuccess,failure:this.handleGetSignDataError,scope:this,argument:{selectedSign:e,is_pageload:"false"}};this.isBusy=true;this.moduleapi.makeRequest(f,g);},handleGetSignDataSuccess:function(e,g){var f=this.moduleapi;this.isBusy=false;f.setView(d,e.html);if(g.selectedSign){this.Y.Cookie.setSub(this.moduleCookieName,this.id,"",{path:"/",domain:this.cookieDomain});if(this.statemgr){this.statemgr.setUserModuleState(this.cookieSignKey,g.selectedSign);this.statemgr.update();}}if(this.rapidEnabled){this.instrumentationService.refreshModule(this.body);}},handleGetSignDataError:function(e,f){this.isBusy=false;}};})();/* Copyright (c) 2014, Yahoo! Inc.  All rights reserved. */
YModules.type_flickr={body:null,editBody:null,id:"",moduleapi:null,viewevents:["click"],init:function(a){this.Y=a.getService("yui");this.id=a.getId();this.moduleapi=a;this.arcadeTransport=this.platform?this.platform.getService("arcade_transport"):a;this.user=a.getService("userinfo");this.loggedIn=this.user.isLoggedIn();this.enableMyPhotos=a.getContextData("enableMyPhotos")&&a.getContextData("isFlickrUser");},onviewload:function(c){var b=this.moduleapi,a=this;if(c==="default"){this.body=b.getViewNode(c);if(this.loggedIn&&this.enableMyPhotos){a.arcadeTransport.makeRequest({type:"module",moduleId:a.id,args:this.Y.merge({_action:"view",_subAction:"getPhotos",noups:0,s:"whatever this is"})},{success:function(d){if(d&&d.data&&d.data.myPhotos&&d.data.myPhotos.photos&&d.data.myPhotos.photos.length>0){this.body.set("innerHTML",d.data.myPhotos.markup);}},failure:function(){},scope:a,argument:this.Y.merge({subAction:"getPhotos"})});}}else{if(c==="edit"){this.editBody=b.getViewNode(c);}}},onviewunload:function(a){if(a==="default"){this.body=null;}else{if(a==="edit"){this.editBody=null;}}},onviewevent:function(b,a){if(b==="default"){}else{if(b==="edit"){}}}};/* Copyright (c) 2014, Yahoo! Inc.  All rights reserved. */
(function(){var i="click",f="submit",b="blur",c="default",h="edit",j="recent-quotes",d=true,g=false,e=null,a=e;YModules.type_finance={id:"",body:e,moduleapi:e,instrumentation:e,currentBucket:e,orderTable:"asc",viewevents:[i,f,"focus","mouseover"],allTickers:e,autocompleteEnabled:g,autocompleteLoaded:g,settingspaneEnabled:g,arcadeTransport:e,resizeThrottle:250,tabliteService:e,tabs:e,tabNavigationMode:e,searchBoxBlur:e,stateMgr:e,init:function(k){this.id=k.getId();this.moduleapi=k;a=this.moduleapi.getService("yui");this.autocompleteEnabled=k.getContextData("enableAutocomplete");this.settingspaneEnabled=k.getContextData("enableSettingspane");this.inlineEditEnabled=k.getContextData("enableRQInlineEdit");this.crumb=k.getContextData(".crumb");this.instrumentation=k.getService("instrumentation");this.rapidEnabled=this.moduleapi.getContextData("rapid.enabled");this.currentBucket=k.getContextData("currentBucket");this.autocompleteUrl=k.getContextData("autocompleteUrl");if(this.settingspaneEnabled){this.arcadeTransport=this.platform?this.platform.getService("arcade_transport"):k;}this.tabliteService=k.getService("tablite");this.tabNavigationMode=k.getContextData("tabNavigationMode");this.stateMgr=this.moduleapi.getService("statemgr");},onviewload:function(m){var l=this.moduleapi,k;if(m==c){this.body=this.moduleapi.getViewNode(c);this.autocompleteLoaded=g;if(this.rapidEnabled){this.instrumentation.refreshModule(this.body);}this.allTickers=l.getContextData("allTickers");this.loadingInfo=l.getContextData("loadingInfo")||e;k=this.body.one(".tab-"+this.tabNavigationMode);this.tabs=new this.tabliteService({moduleApi:l,body:this.body,tabWidget:k,navMode:this.tabNavigationMode});this.tabs.setup();if(!this.searchBoxBlur){this.searchBoxBlur=this.body.delegate("blur",function(q){var p=q.target,o=p.get("value"),n=p.getAttribute("placeholder");if(o.length===0||n===o){p.addClass("quotes-input-inactive");p.set("value",n);}},".quotes-input");}}else{if(m==h){this.editBody=l.getViewNode(m);if(this.rapidEnabled&&!this.instrumentation.isModuleTracked(this.editBody)){this.instrumentation.addModule(this.editBody,"app-fin");}}}},onviewevent:function(t,p){var m=this.moduleapi,q=p.target,s=p.type,n=q.getAttribute("placeholder"),o=q.get("value"),r,k,l;if(t==c){if(s===i){if(q.ancestor(".toggle",d)){if(q.hasClass("edit-link")){return;}p.preventDefault();}if(this.rapidEnabled&&q.hasClass("tab")){this.instrumentation.fireBeacon(q);}if(q.ancestor(".settings-cta",d)&&this.settingspaneEnabled){p.preventDefault();m.openView(h);}if(q.ancestor(".markets .down",d)||q.ancestor(".markets .up",d)){k=q.ancestor(".markets");l=k&&k.hasClass("quote-percent");k.all(".down, .up").each(function(y,x){var z=y,w=z.getAttribute("data-changepercent"),u=z.getAttribute("data-change");if(l){z.setContent(z.getContent().replace(w,u));}else{z.setContent(z.getContent().replace(u,w));}});if(l){k.removeClass("quote-percent");}else{k.addClass("quote-percent");}if(this.rapidEnabled){this.instrumentation.fireBeacon(q);}}}if(s==="focus"||s===i){if(q.hasClass("quotes-input")&&n===o){this.emptyInputBox(q);if(q.hasClass("quotes-input-inactive")){q.removeClass("quotes-input-inactive");}}}if(s==="mouseover"&&this.autocompleteLoaded===g&&this.autocompleteEnabled){this.autocompleteLoaded=d;m.getViewNode(c).detach("mouseover");this.initAutocomplete();}}else{if(t==h){if(s==="submit"||(s===i&&q.hasClass("edit-save-btn"))){p.preventDefault();if(q.hasClass("app-close-button")){m.closeView(h);return;}if(s===i&&q.hasClass("edit-save-btn")){q=q.ancestor(".portfolio-form");}if(q.hasClass("portfolio-form")&&q.one('input[name="pf"]')){q.all('input[name="pf"]').each(function(u){if(u.get("checked")===d){r=u.getAttribute("value");}});this.arcadeTransport.makeRequest({type:"module",moduleId:this.id,args:a.merge({_action:"save",_subAction:"setdefault",pf_id:r})},{success:function(){m.refreshView(c);this.editBody=m.getViewNode(t);if(this.instrumentation.isModuleTracked(this.editBody)){this.instrumentation.removeModule(this.editBody);}m.closeView(h);},failure:function(){},scope:this,argument:a.merge({subAction:"setdefault"})});}else{if(q.hasClass("portfolio-form")){m.closeView(h);}}}}}},initAutocomplete:function(){try{var k=this;a.use("jsonp","jsonp-url","autocomplete",function(o){var n=k.body.one(".quotes-input"),m;if(n){n.plug(o.Plugin.AutoComplete,{source:function(s,t){YAHOO.util={ScriptNodeDataSource:{callbacks:function(w){var v=w.ResultSet.Result,u=[];for(m=0;m<v.length;m++){if(v[m]&&v[m].symbol){u.push({symbol:v[m].symbol,name:v[m].name,pos:m});}}t(u);}}};function q(u,v,w){return o.Lang.sub(u,{callback:"YAHOO.util.ScriptNodeDataSource.callbacks",query:w});}var r=k.autocompleteUrl,p=new o.JSONPRequest(r,{format:q,on:{success:function(u){}}});p.send(s);},resultTextLocator:"symbol",resultFormatter:function(q,p){return o.Array.map(p,function(r){return"<strong>"+r.raw.symbol+"</strong> "+r.raw.name;});},resultHighlighter:"phraseMatch",align:{node:n,points:["tl","bl"]},queryDelay:200,maxResults:10,activateFirstItem:d});n.ancestor("form").on(f,function(p){if(n.ac.get("visible")===d){p.preventDefault();}});n.ac.on("select",function(p){p.preventDefault();if(k.inlineEditEnabled){if(k.stateMgr){k.stateMgr.saveUserSetting("st",j,k.moduleapi);}k.arcadeTransport.makeRequest({type:"module",moduleId:k.id,args:o.merge({_action:"save",_subAction:"addrq",s:p.result.text})},{success:function(){if(this.rapidEnabled){var q={rspns:"nav",t1:"a4",t2:"app-fin",t3:"rcnt",sec:"app-fin",slk:p.result.text,elm:"itm",elmt:"qte",itc:0,pos:p.result.raw.pos+1,action:"click"};this.instrumentation.fireBeacon(q);}k.moduleapi.refreshView(c);},failure:function(){},scope:k,argument:o.merge({subAction:"addrq"})});}else{n.set("value",p.result.text);n.ancestor("form").submit();}});n.ac.on("visibleChange",function(p){if(p.newVal===d){k.body.one(".app").setStyle("zIndex","10");}else{k.body.one(".app").setStyle("zIndex","");}});}});}catch(l){}},emptyInputBox:function(k){k.set("value","").removeClass("quotes-input-inactive");k.on(b,this.setInputValue,this);},setInputValue:function(l){var k=l.target;if(k.get("value")===""){k.set("value",k.get("defaultValue"));k.addClass("quotes-input-inactive");}k.detach("blur",this.setInputValue);},onviewunload:function(k){if(k==c){this.tabs.teardown();if(this.searchBoxBlur){this.searchBoxBlur.detach();this.searchBoxBlur=e;}}},handleRequests:function(k,o){var l=this.moduleapi,n=this.requestId,m=this.body.getById(this.id+"-loading-info");if(l.isRequestPending(n)){l.abortRequest(n);if(m){m.get("parentNode").removeChild(m);}}this.requestId=l.makeRequest(k,o);}};}());/* Copyright (c) 2014, Yahoo! Inc.  All rights reserved. */
YModules.type_windowshade={body:null,editBody:null,id:"",moduleapi:null,viewevents:["click"],init:function(a){this.Y=a.getService("yui");this.id=a.getId();this.moduleapi=a;this.statemgr=a.getService("statemgr");},onviewload:function(m){var c=this.moduleapi,a,b,j=c.getContextData("autoClose"),h=this.messagesEnabled=c.getContextData("messagesEnabled"),l=h.length,g,d=0,f,e=20000,k=c.getContextData("UCSMessage");if(m==="default"){this.body=f=c.getViewNode(m);this.UCSMessage=k;for(d;d<l;d++){g=h[d];a=this.statemgr.getUserModuleState(g);b=c.getContextData(g+"FrequencyCap");if(k&&(g===k)){this.increaseUCSCount();}else{if(!a){this.statemgr.setUserModuleState(g,1);}else{if(a<b){this.statemgr.setUserModuleState(g,a+1);}}}e++;}if(j){this.Y.later(e,this,function(){f.remove();});}}},onviewunload:function(a){if(a==="default"){this.body=null;}},onviewevent:function(m,g){var h,k,f=this.messagesEnabled,j=this.messagesEnabled.length,l=4,c=0,d,a,b;if(m==="default"){h=g.target;k=h.ancestor(".close-btn",true,".type_windowshade");if(k){g.preventDefault();for(c;c<j;c++){d=f[c];if(this.UCSMessage&&(d===this.UCSMessage)){this.increaseUCSCount(true);}else{this.statemgr.setUserModuleState(d,l);}}this.body.remove();}if(h.hasAttribute("data-close")){g.preventDefault();if(h.getAttribute("data-close")==="true"){a=h.getAttribute("href");b=h.getAttribute("href");for(c;c<j;c++){d=f[c];if(this.UCSMessage&&(d===this.UCSMessage)){this.increaseUCSCount(true);}else{this.statemgr.setUserModuleState(d,l);}}this.body.remove();this.moduleapi.navigate(a,b);}}}},increaseUCSCount:function(c){var b=this.Y.Cookie.getSub("ucs","disclaimer",Number),a=this.Y.Cookie.get("AO",{raw:true});if(!b||b===null){b=0;}if(c){b=this.moduleapi.getContextData("UCSFrequencyCap");}this.Y.Cookie.setSub("ucs","disclaimer",b+1,{expires:new Date("January 12, 2025"),path:"/",domain:"yahoo.com"});a=a.replace("o=1","o=0");this.Y.Cookie.set("AO",a,{expires:new Date("January 12, 2025"),path:"/",domain:"yahoo.com",raw:true});}};/* Copyright (c) 2014, Yahoo! Inc.  All rights reserved. */
(function(){var b=true,d="today_tab_open",c="today_tab_close",e="worldcup_tab_update",a="13872472";YModules.type_todaycontainer={body:null,editBody:null,id:"",moduleapi:null,viewevents:["click"],init:function(f){this.Y=f.getService("yui");this.id=f.getId();this.moduleapi=f;this.arcadeTransport=f.getService("moduleplatform").getService("arcade_transport");this.moduleId=f.getId();this.statemgr=f.getService("statemgr");f.listen(e);},onviewload:function(g){var f=this.moduleapi;if(g==="default"){this.body=f.getViewNode(g);this.tabs=this.body.one(".today-tabs");}},onviewunload:function(f){if(f==="default"){this.body=null;}},onviewevent:function(i,h){if(i==="default"){var g=h.target,f=g.ancestor("a.tab-change",b,"DIV");if(f){h.preventDefault();this.changeTab(f);}}},changeTab:function(i){var g=this.tabs.all("LI"),f=i.getAttribute("data-suid"),h=i.get("parentNode"),l=this.body.all(".tab-holder"),k=this.body.one("#tab-"+f),j=1;g.removeClass("selected");h.addClass("selected");l.removeClass("tab-selected");k.addClass("tab-selected");if(f===a){this.moduleapi.broadcast(d);}else{this.moduleapi.broadcast(c);j=2;}this.statemgr.setUserModuleState("state",j);},loadTab:function(i){var f=i.getAttribute("data-suid"),h=this.moduleId,g,j;g={type:"module",moduleId:h,args:{_action:"show",_subAction:"load-module",suid:f}};j={success:this.loadTabSuccess,failure:this.loadTabFailure,argument:{node:i},scope:this};if(this.arcadeTransport.isRequestPending(this.loadTab)){this.arcadeTransport.abortRequest(this.loadTab);}this.loadTab=this.arcadeTransport.makeRequest(g,j,h);},loadTabSuccess:function(f,h){var g=h.node;g.set("innerHTML",f.html);},loadTabFailure:function(f,g){},onmessage:function(i,f,h){var g;if(i===e){if(h.suid&&h.html){g=this.body.one("#tab-"+h.suid);if(g){g.set("innerHTML",h.html);}}}}};}());/* Copyright (c) 2014, Yahoo! Inc.  All rights reserved. */
(function(){var v="hide",at="prev",q="next",d="close",N="empty",av="selected",ac="inlinevid",o="indicator",i="todaytop",O="main-story",j=".main-story-content",D='<div class="main-story-next"></div>',y="no-visibility",Z="related-links",ay="no-top-padding",aj="indicator-playing",g="y-today-grad1",f="y-today-grad2",z="y-today-ln-1",ar="y-ln-2",ap="y-ln-4",Q="trans-border",ae="item",ag="play",n="pause",ad=null,U=true,A=false,ak="href",F="innerHTML",aq="pa:open",aw="pa:close",M="lightbox:start",a="lightbox:end",u="y-carousel",e="parentNode",k="none",ao="OK",aa="-panel",x="abort",I="data-b",af=".package-header",K="story",ab="footers",c="story_footer_pairs",b="fpck",t="interactive",S="sayt:open",az="sayt:close",E="fp:window:resize",am="today_tab_open",ah="today_tab_close",X="mouseout",V="mouseover",J=300,p="pane",Y="package",m="baseline",aA="ta",W="ca",B="1",ai="0",h="pof",R="footers",al="stories",H=0,C=0,aB=0,G=-1,w=1,P=2,T=3,au="fade",an="crossfade",s="always",L="single_pane",ax="all_panes",r="fp:today:offscreen",l="fp:today:onscreen";YModules.type_fptoday={viewevents:["click","keyup"],moduleapi:ad,cache:ad,body:ad,moduleId:ad,mainStory:ad,mainStoryContent:ad,mainStoryNext:ad,lastSelectedFooter:ad,carousel:ad,instrumentation:ad,packageIds:ad,visibleElementCount:0,textCount:ad,paginationType:ad,yep:ad,cokeTestId:ad,mcode:ad,woeId:ad,cookieDomain:ad,delayMouseover:ad,timeDelayed:0,carouselContainer:ad,carouselOuterContainer:ad,footerOverlay:ad,loadingOverlay:ad,isTodayOnTop:1,showDate:U,animMode:k,animStoryOverlayDuration:0,animStoryOverlayDelay:0,animTransition:au,preloadPaneCount:0,timeoutPaneCount:0,animIntervalInitial:0,animIntervalSubsequent:0,isInitialAnim:U,animFadeDuration:C,animHtml:ad,animPlayBeacon:ad,animPauseBeacon:ad,animPlayString:ad,animPauseString:ad,delayAutoPlayMouseover:ad,autoPlayReference:ad,isOtherModuleOpen:A,isManuallyPaused:A,titleRegion:ad,statemgr:ad,arcadeTransport:ad,doBroadcastEvent:A,footerHeight:0,blurHandler:ad,focusHandler:ad,activeElement:ad,mod:ad,handleOffsetWidth:0,handleParentLeft:0,handleParentOffsetWidth:0,handleCursorOffset:0,populateStoryRequestId:ad,populateScrollItemRequestId:ad,unifiedEnabled:ad,persPkgId:ad,clickStCookie:ad,clickStToastCookie:ad,todayPkgPersEnabled:ad,inlineVideoEnabled:A,videoService:ad,videoBindNode:ad,videoPlayer:ad,sec:ad,i13nReason:ad,moneyballAdEnabled:false,moneyballAdPkgId:"",moneyballAdData:null,payoffsFantasyTTL:ad,init:function(aD){this.Y=aD.getService("yui");this.cache={};this.moduleId=aD.getId();this.moduleapi=aD;this.cookieDomain=aD.getService("moduleplatform").getProperty("cookieDomain");this.instrumentation=aD.getService("instrumentation");this.storage=aD.getService("storage");this.userinfo=aD.getService("userinfo");this.inlineLightboxEnabled=aD.getContextData("inlineLightboxEnabled");this.moneyballAdEnabled=aD.getContextData("moneyballAdEnabled");this.moneyballAdPkgId=aD.getContextData("moneyballAdPkgId");this.moneyballAdData=aD.getContextData("moneyballAdData");var aC=this.statemgr=aD.getService("statemgr");this.todayPkgPersEnabled=aD.getContextData("today_pkg_pers");if(this.todayPkgPersEnabled){this.clickStCookie=aC.getUserModuleState(W);}this.arcadeTransport=aD.getService("moduleplatform").getService("arcade_transport");this.inlineVideoEnabled=aD.getContextData("inline.video.enabled");if(this.inlineVideoEnabled){this.videoService=aD.getService("videoyep");if(this.videoService){this.videoPlayer=this.videoService.create();}this.sec=aD.getContextData("sec");}this.footerHoverOpacity=aD.getContextData("footerHoverOpacity");aD.listen(aq);aD.listen(aw);aD.listen(M);aD.listen(a);aD.listen(S);aD.listen(az);aD.listen(E);aD.listen(am);aD.listen(ah);aD.listen(r);aD.listen(l);},onviewload:function(aO){if(aO=="default"){var aD=this.Y,aL=aD.UA.ie,aV,aJ,aU,aR,aZ,aX,a1,aG,aE,aY=this.moduleId,a2=this.moduleapi,a0=a2.getContextData(),aH=a2.getService("carousel"),aQ=a2.getContextData("crslAnimEnabled"),aK=this.clickStCookie,aF,aN,aI,aW,aP,aS,aC,aT,aM;aJ=this.body=a2.getViewNode(aO);if(this.inlineVideoEnabled){this.videoBindNode=aJ.one(".fptoday-container");}aR=this.mainStory=aJ.getById(aY+"-main_story");this.footerOverlay=aJ.query(".footer-overlay");this.loadingOverlay=aJ.query(".loading-overlay");if(!aR||aJ.query(".xotitle")){this.onviewevent=ad;return;}this.mainStoryContent=aR.one(j);aU=this.carousel=aH.create(aJ.query("."+u),{animDuration:0.4,loop:U,animate:aQ});aU.subscribe("beforescroll",this.loadScrollItem,this);aU.subscribe("scroll",this.updatePaginator,this);this.isTodayOnTop=a2.getContextData(i);this.showDate=a2.getContextData("showdate");aZ=this.packageIds=a0.pkgIds;aM=this.i13nReason=a0.i13nReason;if(this.moneyballAdEnabled&&this.moneyballAdPkgId&&this.moneyballAdData){this.packageIds.splice(5,0,this.moneyballAdPkgId);this.packageIds.pop();}this.initializeCache(a0);a1=aJ.query("#"+aY+aa+"0 ."+ae);this.lastSelectedFooter=(a0.centerStory==1)?a1.next("."+ae):a1;this.visibleElementCount=aZ.length/aU.getItemCount();this.textCount=a0.textCount;this.paginationType=(a0.paginationtype)?a0.paginationtype:m;this.cokeTestId=a0.cokeTestId;this.mcode=a0.mcode;this.woeId=a0.woeId;this.timeDelayed=a2.getContextData("today_delay_mouseover")||J;if(aU.getItemCount()>1){aX=aJ.query(".y-carousel-list").get("children");aX.removeClass(v);this.updatePaginator();aJ.query(".navigation").removeClass(y);}aG=this.carouselContainer=aJ.one("."+u);aE=this.carouselOuterContainer=aJ.one(".carousel-container");aG.on(V,this.handleFooterMouseover,this);aG.on(X,this.handleFooterMouseout,this);this.unifiedEnabled=a2.getContextData("unified.todaynews.enabled");this.animMode=a2.getContextData("footer.anim.mode");if(this.animMode!=k){this.animIntervalInitial=a2.getContextData("footer.anim.interval.initial")||H;this.animIntervalSubsequent=a2.getContextData("footer.anim.interval.subsequent")||H;this.animFadeDuration=a2.getContextData("footer.anim.fade.duration")||C;this.animTransition=a2.getContextData("footer.anim.transition")||au;this.preloadPaneCount=a2.getContextData("footer.anim.preload.pane_count")||0;this.timeoutPaneCount=a2.getContextData("footer.anim.timeout.pane_count")||0;this.animHtml=aJ.create(a2.getContextData("animHtml"));aT=aJ.one(".title-date");this.titleRegion=aT?aT.get("region"):ad;this.attachEngagingAreaMouseEvents();if(aL){document.onfocusout=this.Y.bind(this.handleBlur,this);document.onfocusin=this.Y.bind(this.handleFocus,this);}else{this.blurHandler=this.Y.on("blur",this.Y.bind(this.handleBlur,this),window);this.focusHandler=this.Y.on("focus",this.Y.bind(this.handleFocus,this),window);}this.insertPlayPauseButton();this.isInitialAnim=U;this.isManuallyPaused=a2.getContextData("animPausedState");this.startAutoPlay();}this.doBroadcastEvent=a2.getContextData("broadcast.interactive_event");this.animStoryOverlayDuration=a2.getContextData("layout.overlay.anim.duration");this.showMainStoryOverlay();this.animStoryOverlayDelay=a2.getContextData("layout.overlay.anim.delay");if(aK&&aK.pkgId&&aK.pkgIds){aP=true;aN=aK.pane?aK.pane:0;aC=aK.pkgIds;aF=aC.length;for(aV=0;aV<aF;aV++){aS=aC[aV];aI=this.indexOf(aS,aZ);if("-1"!=aI&&(!aW||(aW&&(aW+1)==aI))){aW=aI;}else{aP=false;break;}}if(aP){this.persPkgId=aK.pkgId;if("0"!=aN){this.carousel.scrollTo(aN);}else{this.handlePersistantScroll();}}}if(aK){this.statemgr.setUserModuleState(W,ad);}this.payoffsFantasyEnabled=a2.getContextData("payoffsFantasyEnabled");if(this.payoffsFantasyEnabled){this.payoffsFantasyTTL=a2.getContextData("payoffsFantasyTTL");}}},indexOf:function(aF,aE){var aD=aE.length,aC;for(aC=0;aC<aD;aC++){if(aE[aC]==aF){return aC;}}return -1;},handlePersistantScroll:function(aE){var aF,aD=this.body.getById(this.moduleId+aa+this.clickStCookie.pane).all("a"),aC=this.persPkgId;if(aD){aD.each(function(aG){if(aG.getAttribute("y-pkgid")==aC){aF=aG;}});if(aF){this.populateStory({linkNode:aF,userHover:A});}}this.persPkgId=null;},onviewunload:function(aC){if(aC=="default"){this.cleanup();}},onviewevent:function(aP,aF){var aD,aM=aF.target,aQ=aF.type,aG,aK,aS,aH,aR,aJ,aO=this.delayMouseover,aI=A,aL,aC,aE,aN={};if(aO){aO.cancel();this.delayMouseover=ad;}if(aP=="default"&&aM){if(this.inlineLightboxEnabled){aL=aM.ancestor(".fp-open-inline",true);if(aL){aF.preventDefault();if(aL.hasClass("fp-bday")){aN={name:aL.getData("bday-name"),bday:aL.getData("bday-date"),hash:aL.getData("bday-hash"),id:aL.getData("bday-fbid")};this.moduleapi.broadcast("fp:open-inline",{sec:"fptoday-bday",mode:"embed",module:"birthday",subModuleView:"birthday-story",subModuleData:this.Y.JSON.stringify(aN)});}else{if(aL.getAttribute("data-uuid")){aC=aL.getAttribute("data-uuid");}if(aL.getAttribute("href")){aE=aL.getAttribute("href");}else{aE=aL.one("A.rapidnofollow").getAttribute("href");}this.moduleapi.broadcast("fp:open-inline",{uuid:aC,href:aE,sec:"td-strm",ct:"1"});}return;}}if(aQ=="keyup"){if(this.carouselContainer.contains(aM)){this.handleFooterMouseover(aF);this.cancelAutoPlay();}}else{if(this.carouselContainer.contains(aM)){aD=this.handleFooterClick(aM);}else{if(this.classMatch(aM,at)){aD=this.previous;aI=U;}else{if(this.classMatch(aM,q)){aD=this.next;aI=U;}else{if(this.classMatch(aM,ag)){aD=this.handleManualPlayPauseAutoPlay(ag,aM);}else{if(this.classMatch(aM,n)){aD=this.handleManualPlayPauseAutoPlay(n,aM);}else{if((aM.hasClass(ac)||this.classMatch(aM,O))){aD=this.handleMainStory(aM);}}}}}}}if(this.todayPkgPersEnabled&&aQ=="click"&&(aM.get("tagName")=="A"||aM.ancestor("a"))&&aM.ancestor(".fptoday-container")){aG=this.carousel.getCurrentIndex();aJ=this.statemgr;aK=aM.ancestor(".fptoday-container").one(".footer-section .selected");aS=aK.getAttribute("y-pkgid");aH=[];aK.ancestor("li").all("a").each(function(aT){aH.push(aT.getAttribute("y-pkgid"));});aR={pane:aG,pkgId:aS,pkgIds:aH};aJ.setUserModuleState(W,aR);}if(aD){this.cancelAutoPlay();aF.preventDefault();aD.call(this);if(aI&&this.doBroadcastEvent){this.broadcastEvent();}}}},loadScrollItem:function(aQ){var aK=this.body,aG,aH,aR=this.carousel,aU=this.moduleapi,aO=aR.getCurrentIndex(),aC=aO,aS=this.moduleId,aP=this.animMode,aL=aK.getById(aS+aa+aO),aI,aJ="",aM=ad,aD,aE,aF,aN=aQ.toIndex,aT=(aN-aQ.fromIndex==1)?q:at;if(aL){if(aP==k){aD=ab;aE=this.populateScrollItem;aF=this.populateScrollItemFailure;aJ=aL.hasClass(N)?P:"";}else{aD=c;aE=this.preloadSuccess;aF=this.preloadFailure;if(aL.hasClass(N)){aJ=P;}else{if(this.preloadPaneCount!==aB){aJ=w;}}}if(aJ!==""){aM=this.getPackageIds(aO,aJ,aT);}if(aM&&aM.length>0){if(aJ==w){aU.refreshView("default");return;}if(aT==at&&aJ==T){aC=aO-aM.length/this.visibleElementCount+1;}aG={type:"module",moduleId:aS,args:{_action:"show",_subAction:aD,storyIds:aM,panelIndex:aC,cokeTestId:this.cokeTestId,mcode:this.mcode,woeId:this.woeId,todaytop:this.isTodayOnTop,i13nReason:this.i13nReason,adData:this.moneyballAdData||""}};aH={success:aE,failure:aF,argument:{panel:aL,panelIndex:aO,showStory:U,direction:aT},scope:this};if(!this.autoPlayReference){aG.args=this.Y.merge(aG.args,{isScroll:1});}this.loadingOverlay.removeClass(v);if(this.arcadeTransport.isRequestPending(this.populateScrollItemRequestId)){this.arcadeTransport.abortRequest(this.populateScrollItemRequestId);}this.populateScrollItemRequestId=this.arcadeTransport.makeRequest(aG,aH,aS);}else{if(aP!=k){if(!this.persPkgId){aR=this.carousel;aI=aR.getItemNode(aR.getCurrentIndex()).query("."+ae);this.populateStory({linkNode:aI,userHover:A});}else{this.handlePersistantScroll();}this.startAutoPlay();}}}},preload:function(aG,aD,aI){var aC=this.body.getById(this.moduleId+aa+aG),aF=this.getPackageIds(aG,T,q),aE={type:"module",moduleId:this.moduleId,args:{_action:"show",_subAction:c,storyIds:aF,panelIndex:aG,cokeTestId:this.cokeTestId,mcode:this.mcode,woeId:this.woeId,todaytop:this.isTodayOnTop,adData:this.moneyballAdData||""}},aH={success:this.preloadSuccess,failure:this.preloadFailure,argument:{panel:aC,panelIndex:aG,showStory:aD,direction:q},scope:this};if(aI){aE.args=this.Y.merge(aE.args,aI);}if(this.arcadeTransport.isRequestPending(this.populateScrollItemRequestId)){this.arcadeTransport.abortRequest(this.populateScrollItemRequestId);}this.populateScrollItemRequestId=this.arcadeTransport.makeRequest(aE,aH,this.moduleId);},preloadSuccess:function(aD,aJ){var aU=this.moduleapi,aQ=this.carousel,aF=aU.getContextData(al),aC=aU.getContextData(R),aM=aJ.panelIndex,aK=aJ.panel,aG=aJ.showStory,aS=aJ.direction,aO=this.visibleElementCount,aN,aH,aP,aI=(aS==at)?(aC.length-aO):0,aR,aE=aK,aT,aL="";while(aK&&aK.hasClass(N)&&aC[aI]){aL+=aC[aI];if((aI+1)%aO===0){aK.removeClass(N);aK.set(F,aL);aN=aK.all("."+ae);for(aR=0;aR<aO;aR++){aT=this.extractId(aN.item(aR));if(aT!=""){this.cache[aT]=aF[aT];}}}aI++;if(aI%aO===0){aK=(aS==at)?aK.previous():aK.next();aL="";aI=(aS==at)?aI-(2*aO):aI;}}if(aG){if(aM!=aQ.getCurrentIndex()){this.carousel.scrollTo(aM);}this.loadingOverlay.addClass(v);if(!this.persPkgId){aH=aE.one("."+ae);this.populateStory({linkNode:aH,userHover:A});}else{this.handlePersistantScroll();}this.startAutoPlay();}aP=aE.one(".empty");if(aP){aU.refreshView("default");}},preloadFailure:function(aD,aE){var aC=this.Y.Lang.isObject(aD);if(aC&&aD.statusText==x){if(this.preloadPaneCount==this.timeoutPaneCount){this.handleFatalError();}else{}}else{if(aC&&aD.statusText==ao){}else{this.handleFatalError();}}},handleFatalError:function(){var aC=this.carousel;this.animMode=L;this.loadingOverlay.addClass(v);aC.scrollTo(0,A);this.populateStory({linkNode:aC.getItemNode(0).query("."+ae),userHover:A});this.body.one(".y-nav-buttons").addClass(y);},updatePaginator:function(){var aC=this.body,aF,aI,aE,aD=this.visibleElementCount,aH,aG;switch(this.paginationType){case m:aC.query(".navigation .selected").removeClass(av);aC.getById(this.moduleId+"_"+this.carousel.getCurrentIndex()).addClass(av);break;case p:aF=aC.query(".navigation .y-nav-count");this.setPaginationString(this.carousel.getCurrentIndex()+1,this.carousel.getItemCount());break;case Y:if(aC.all(".package-overlay")&&aC.all(".package-overlay").item(0).hasClass("CTA-live")){if(aC.one(".y-nav-count")){aC.one(".y-nav-count").setStyle("display","none");}if(aC.one(".playpause")){aC.one(".playpause").setStyle("display","none");}}else{if(aC.one(".y-nav-count")){aC.one(".y-nav-count").setStyle("display","block");}if(aC.one(".playpause")){aC.one(".playpause").setStyle("display","block");}}aI=aC.queryAll("."+ae);aE=aI.size();aG=(this.carousel.getCurrentIndex()+1)*aD;aH=aG-(aD-1);this.setPaginationString(aH+" \u2013 "+aG,aE);break;}},setPaginationString:function(aF,aE){var aD,aC=this.body.query(".navigation .y-nav-count");if(aC){aD=this.Y.Lang.sub(this.textCount,{"0":aF,"1":aE});aC.set(F,aD);}},handleFooterMouseover:function(aG){var aF=aG.target,aE=aF.ancestor(".item"),aC,aH=aF.ancestor(".footer-img-holder"),aD=false;if(!aF){return;}if(aF.hasAttribute(ak)){aC=aF;}else{aC=aE;}if(this.footerHoverOpacity){if(aH){this.body.one(".package-overlay").removeClass("text-hover");}else{aD=true;this.body.one(".package-overlay").addClass("text-hover");}}if(!aC||(aC.hasClass(ae)&&aC.hasClass(av))){return;}this.delayMouseover=this.Y.later(this.timeDelayed,this,this.populateStory,{linkNode:aC,userHover:U,showOpaque:aD});},handleFooterMouseout:function(aD){var aC=this.delayMouseover;if(this.body.one(".package-overlay")){this.body.one(".package-overlay").removeClass("text-hover");}if(aC){aC.cancel();this.delayMouseover=ad;}},populateStory:function(aE){var aH,aI,aL,aK,aT=this.moduleapi,aN=this.cache,aC=aE.linkNode,aQ=aE.userHover,aO=this.animMode===s||!aQ,aS=this.extractId(aC),aF=this.lastSelectedFooter,aP=aF.query(".image"),aR=aN[aS],aJ,aM,aG,aD=aE.showOpaque;if(!aC.hasClass(ae)){return;}if(aR&&aR.index&&!(/^\d+$/.test(aR.index))){return;}if(aP){aP.replaceClass(ap,ar);}aF.removeClass(av).replaceClass(ap,Q).replaceClass(f,g).addClass(z);this.lastSelectedFooter=aC;if(!aR){aS=this.extractId(aC);this.lastSelectedFooter=aC;aR=aN[aS];}if(aR){this.lastSelectedFooter.addClass(av).replaceClass(Q,ap).replaceClass(g,f).removeClass(z);aK=aR.html;if(aK){aO=(this.Y.UA.ie&&this.Y.UA.ie<=8)?A:aO;this.setMainStory(aK,aS,aO,U,aD);}else{aJ=this.body.getById(this.moduleId+"-header-image");if(aJ){if(aJ.hasAttribute("data-img")){aM=aJ.getAttribute("data-img");aG=aJ.get("text");}else{aM=aJ.get("src");aG=aJ.get("alt");}}aH={type:"module",moduleId:this.moduleId,args:{_action:"show",_subAction:K,storyId:aS,storyIndex:aR.index,cokeTestId:this.cokeTestId,woeId:this.woeId,todaytop:this.isTodayOnTop}};aI={success:this.handlePopulateStorySuccess,failure:this.handlePopulateStoryFailure,argument:{storyId:aS,oldImageSrc:aM,oldImageAlt:aG,doFade:aO,showOpaque:aD},scope:this};if(aT.isRequestPending(this.populateStoryRequestId)){aT.abortRequest(this.populateStoryRequestId);}this.populateStoryRequestId=aT.makeRequest(aH,aI);}aL=aF.query("."+aj);if(this.showDate&&this.isTodayOnTop!="0"){this.mainStory.addClass("has-date");}if(aL){aL.replaceClass(aj,o);this.carouselContainer.removeClass(ay);}if(aC&&aQ){this.tracking(aC);}if(aS===this.moneyballAdPkgId&&aN[aS].imprBeacon){this.instrumentation.getBeaconImage(aN[aS].imprBeacon);aN[aS].imprBeacon=null;}this.updatePaginator();if(this.doBroadcastEvent&&aQ){this.broadcastEvent();}}},tracking:function(aC){var aD=this.cache,aE=this.extractId(aC);if(aD[aE]&&!aD[aE].beaconFired){if(aC.hasAttribute("data-b-tdh")){this.instrumentation.fireUltBeacon(aC.getAttribute("data-b-tdh"));}aD[aE].beaconFired=U;if(this.preloadPaneCount!==aB){this.setFPCKCookie(aE);}}},handleMainStory:function(aF){var aG,aH=ad,aC=this.cache,aE=aF.ancestor(".package-overlay",U,".type_fptoday"),aD;if(aE){if(!aF.ancestor("A",U,".type_fptoday")){aD=aE.one("H3 > A");this.moduleapi.navigate(aD.get("href"));}}if(!this.inlineVideoEnabled||!this.videoPlayer){return aH;}if(this.classMatch(aF,d)){aH=this.closeVideo;}else{if(aF.hasClass(ac)||!this.classMatch(aF,Z)&&(aF.hasAttribute(ak)||aF.ancestor(function(aI){return aI.hasAttribute(ak);}))){aG=this.extractId(this.lastSelectedFooter);if(aC[aG]&&aC[aG].clipId){aH=this.showInlineVideo;}}}return aH;},handleFooterClick:function(aD){var aF,aG=ad,aC=this.cache,aE=this.classMatch(aD,ae);if(aE){aF=this.extractId(aE);if(aC[aF]&&aC[aF].clipId&&this.inlineVideoEnabled){aG=this.showInlineVideo;}}return aG;},closeVideo:function(){if(this.inlineVideoEnabled&&this.videoPlayer){this.videoPlayer.detachVideo();}},showInlineVideo:function(){if(!this.inlineVideoEnabled){return;}var aF=this.extractId(this.lastSelectedFooter),aD=this.cache[aF],aC=this.footerOverlay,aE;if(aC){aC.removeClass(v);}aE={analytics:{sec:this.sec,ccode:this.cokeTestId,cpos:aD.index},config:{yep:{id:aD.clipId,autoplay:U},animated:A,attach:this.body.one(".main-story-content")}};this.videoPlayer.init(aE);},onmessage:function(aE,aC,aD){var aF=this.body.getById(this.moduleId+"-main_story");if(!aF||this.body.query(".xotitle")){return;}switch(aE){case M:case aq:case S:this.isOtherModuleOpen=U;this.cancelAutoPlay();break;case a:case aw:case az:this.isOtherModuleOpen=A;this.startAutoPlay();break;case E:this.handleResize();break;case r:case ah:this.cancelAutoPlay();break;case l:case am:this.startAutoPlay();break;default:break;}},handlePopulateStorySuccess:function(aD,aG){var aF=aD.data,aC=aF.story,aI=aG.storyId,aE=this.cache[aI],aH=this.extractId(this.lastSelectedFooter);if(aH===aI){aG.doFade=(this.Y.UA.ie&&this.Y.UA.ie<=8)?A:aG.doFade;this.setMainStory(aC,aI,aG.doFade,A,aG.showOpaque);aE.clipId=aF.clipId;aE.channelNodeId=aF.channelNodeId;}else{}},handlePopulateStoryFailure:function(aC,aD){},populateScrollItem:function(aE,aF){var aH,aD,aC=aF.panel,aG=this.body.getById(this.moduleId+aa+aF.panelIndex);aC.removeClass(N);this.loadingOverlay.addClass(v);aG.set(F,aE.data.footers);if(this.animMode!=k){if(!this.persPkgId){aH=this.carousel;aD=aH.getItemNode(aH.getCurrentIndex()).query("."+ae);this.populateStory({linkNode:aD,userHover:A});}else{this.handlePersistantScroll();}this.startAutoPlay();}},populateScrollItemFailure:function(aC){if(aC.statusText==x){}else{this.moduleapi.refreshView("default");}},getPackageIds:function(aH,aJ,aK){var aP=[],aM=this.packageIds,aI=aM.length,aO=this.visibleElementCount,aE=this.preloadPaneCount,aC,aN,aL,aD,aF,aG;if(aJ==w){aC=this.body.getById(this.moduleId+aa+aH);aN=aC.all("."+ae);for(aG=0;aG<aO;aG++){if(aN.item(aG).hasClass(N)){aP.push(aM[(aH*aO)+aG]);}}}else{aE=(aE==G)?aM.length/aO-1:aE;aL=this.carouselContainer.all(".y-panel");if(aK==at){aF=(aH+1)*aO;aD=(aJ!==T)?aF-aO:aF-aE*aO;if(aD<0){aD=aO;}}else{aD=aH*aO;aF=(aJ!==T)?aD+aO:aD+aE*aO;aF=aF>aI?aI:aF;}for(aG=aD;aG<aF;aG++){if(aL.item(Math.floor(aG/aO)).hasClass(N)){aP.push(aM[aG]);}}}return aP;},cleanup:function(){var aF=this.carousel,aC=this.delayMouseover,aE=this.carouselContainer,aD=this.moduleapi;if(aF){aF.unsubscribe("beforescroll",this.loadScrollItem);aF.unsubscribe("scroll",this.updatePaginator);aF.destroy();}if(aC){aC.cancel();}if(aE){aE.detach(V,this.handleFooterMouseover);aE.detach(X,this.handleFooterMouseout);}if(this.animMode!=k){this.detachEngagingAreaMouseEvents();this.cancelAutoPlay();if(this.Y.UA.ie){document.onfocusout=ad;document.focusin=ad;}else{this.Y.detach("blur",this.blurHandler,window);this.Y.detach("focus",this.focusHandler,window);}}aD.abortRequest(this.populateStoryRequestId);this.arcadeTransport.abortRequest(this.populateScrollItemRequestId);this.moduleapi.unlisten();this.body=this.statemgr=this.carousel=this.mainStory=this.mainStoryContent=this.delayMouseover=this.carouselContainer=this.carouselOuterContainer=this.populateStoryRequestId=this.populateScrollItemRequestId=this.activeElement=this.blurHandler=this.focusHandler=ad;},setMainStory:function(aH,aE,aJ,aC,aI){var aK=this.mainStoryContent,aF=this.mainStoryNext,aD,aG;if(aE==="id-fantasy"&&this.payoffsFantasyTTL){this.statemgr.setUserModuleState(h,parseInt(this.Y.Lang.now()/1000,10)+(60*60*this.payoffsFantasyTTL));}if(this.animMode==k||!aJ){aK.set(F,aH);this.replaceImageInMainStory(aH,aE,aC);this.showMainStoryOverlay();aD=aK;}else{if(this.animTransition===an){if(aF){this.crossFadeMainStoryEnd();aK=this.mainStoryContent;}this.mainStoryNext=aF=this.mainStory.insertBefore(D,this.mainStoryContent);aF.setContent(aH);aG=aF.one(".package-overlay");if(aG){aF.one(".package-overlay").removeClass("text-hover");if(aI){aF.one(".package-overlay").addClass("text-hover");}this.showMainStoryOverlay(aF);}aD=aF;}aK.transition({opacity:0,duration:this.animFadeDuration},this.Y.bind(this.fadeOutMainStoryEnd,this,aH,aE,aC));}},replaceImageInMainStory:function(aC,aE,aD){this.cache[aE].html=this.mainStoryContent.get(F);},showMainStoryOverlay:function(aC){var aE=this.mainStoryContent,aD=(aC||aE).one(".package-overlay");if(aD){if(aE.one(".package-overlay")&&aC&&aC!==aE&&this.animTransition===an){aE.one(".package-overlay").hide();}if(this.animStoryOverlayDuration){aD.setStyle("opacity",0);aD.transition({duration:this.animStoryOverlayDuration,delay:this.animStoryOverlayDelay,opacity:1});}else{aD.setStyle("opacity",1);}}},fadeOutMainStoryEnd:function(aF,aD,aC){var aJ=this.mainStoryContent,aE=this.extractId(this.lastSelectedFooter),aK,aI=this.body.one("#navigation-"+this.moduleId),aG=this.oldTextPosition,aH;if(aE===aD){if(this.animTransition===an){this.crossFadeMainStoryEnd();this.replaceImageInMainStory(aF,aD,aC);}else{aJ.set(F,aF);this.replaceImageInMainStory(aF,aD,aC);}}else{}if(this.animTransition===au){this.showMainStoryOverlay();aJ.transition({opacity:1,duration:this.animFadeDuration});}aH=this.mainStoryContent.one(af);if(aH){aK=aH.getAttribute("data-pos");if(aG){aI.replaceClass(aG,aK);}this.oldTextPosition=aK;}},crossFadeMainStoryEnd:function(){if(this.mainStoryNext){var aC=this.mainStoryContent;this.mainStoryContent=this.mainStoryNext.replaceClass("main-story-next","main-story-content");aC.remove();this.mainStoryNext=ad;}},extractId:function(aC){return(aC?aC.getAttribute("y-pkgId"):ad);},classMatch:function(aD,aC){return aD.hasClass(aC)?aD:aD.ancestor(function(aE){return aE.hasClass(aC);});},initializeCache:function(aF){var aE,aH=this.packageIds,aD=aF.stories,aG=aH.length,aC;for(aE=0;aE<aG;aE++){aC=aD[aH[aE]];this.cache[aH[aE]]=(aC&&aC.html)?{html:aC.html,index:aE,clipId:aC.clipId,channelNodeId:aC.channelNodeId,beaconFired:aC.beaconFired}:{html:ad,index:aE,clipId:ad,channelNodeId:ad,beaconFired:A};}},previous:function(){var aC=this.carousel;if(!aC.isScrolling()){aC.previous();}},next:function(){var aC=this.carousel;if(!aC.isScrolling()){aC.next();}},startAutoPlay:function(){if(this.animMode!=k&&!this.autoPlayReference&&!this.isVideoPlaying()&&!this.isOtherModuleOpen&&!this.isManuallyPaused){var aC=this.animIntervalInitial,aD=this.animIntervalSubsequent;if(this.isInitialAnim){if(aC>0){this.autoPlayReference=this.Y.later(aC*1000,this,this.autoPlay,ad,U);}}else{if(aD>0){this.autoPlayReference=this.Y.later(aD*1000,this,this.autoPlay,ad,U);}}}},autoPlay:function(){var aG=this.lastSelectedFooter,aI=aG.next(),aH=this.animMode,aK=this.carousel,aE,aF=aK.getCurrentIndex(),aC=aF+1,aJ,aD=this.timeoutPaneCount;if(this.hasAdRunning()){this.cancelAutoPlay();this.startAutoPlay();return;}if(aI){aE=aI;this.populateStory({linkNode:aE,userHover:A});if(!aI.next()&&(aH==ax||aH==s)){aJ=this.body.getById(this.moduleId+aa+aC);if(aJ&&aJ.hasClass(N)){this.preload(aC,A);}}}else{if(aH==L){aE=aK.getItemNode(aF).query("."+ae);this.populateStory({linkNode:aE,userHover:A});}if(aH==ax||aH==s){if(this.arcadeTransport.isRequestPending(this.populateScrollItemRequestId)){this.arcadeTransport.abortRequest(this.populateScrollItemRequestId);if(aD>0&&this.preloadPaneCount!=aD){this.preloadPaneCount=aD;this.preload(aC,U,{isTimeout:1});}}else{this.next();}}}if(this.isInitialAnim){this.isInitialAnim=A;this.cancelAutoPlay();this.startAutoPlay();}},cancelAutoPlay:function(aD){var aC=this.autoPlayReference;if(aC){aC.cancel();this.autoPlayReference=ad;}if(this.isInitialAnim){this.isInitialAnim=A;}if(aD){this.tracking(this.lastSelectedFooter);}},delayedStartOrCancelAutoPlay:function(aD,aE){var aC=this.delayAutoPlayMouseover;if(aC){aC.cancel();this.delayAutoPlayMouseover=ad;}this.delayAutoPlayMouseover=this.Y.later(this.timeDelayed,this,aD,aE);},handleEngagingAreaMouseover:function(aE){var aD=this.titleRegion,aC=aE.pageX,aF=aE.pageY;if(aD&&aD.top<aF&&aD.right>aC&&aD.bottom>aF&&aD.left<aC){this.delayedStartOrCancelAutoPlay(this.startAutoPlay,A);}else{this.delayedStartOrCancelAutoPlay(this.cancelAutoPlay,U);}},handleEngagingAreaMouseout:function(aC){this.delayedStartOrCancelAutoPlay(this.startAutoPlay);},attachEngagingAreaMouseEvents:function(){var aC=this.carouselOuterContainer,aD=this.mainStory;aC.on(V,this.handleEngagingAreaMouseover,this);aC.on(X,this.handleEngagingAreaMouseout,this);aD.on(V,this.handleEngagingAreaMouseover,this);aD.on(X,this.handleEngagingAreaMouseout,this);},detachEngagingAreaMouseEvents:function(){var aC=this.carouselOuterContainer,aD=this.mainStory;aD.detach(V,this.handleEngagingAreaMouseover);aD.detach(X,this.handleEngagingAreaMouseout);aC.detach(V,this.handleEngagingAreaMouseover);aC.detach(X,this.handleEngagingAreaMouseout);},handleBlur:function(){if(this.Y.UA.ie){this.activeElement=document.activeElement;}this.cancelAutoPlay(A);this.detachEngagingAreaMouseEvents();},handleFocus:function(){if(!this.Y.UA.ie||this.activeElement==document.activeElement){this.startAutoPlay();this.attachEngagingAreaMouseEvents();}},isVideoPlaying:function(){if(this.inlineVideoEnabled&&this.videoPlayer){return this.videoPlayer.playing;}return A;},insertPlayPauseButton:function(){var aE=this.body.query(".navigation .next"),aD=this.moduleapi,aC=this.animHtml;this.animPlayBeacon=aD.getContextData("animPlayBeacon");this.animPauseBeacon=aD.getContextData("animPauseBeacon");this.animPlayString=aD.getContextData("animPlay");this.animPauseString=aD.getContextData("animPause");if(aE){aE.get(e).insertBefore(aC,aE);}if(this.body.all(".package-overlay")&&this.body.all(".package-overlay").item(0).hasClass("CTA-live")){if(this.body.one(".playpause")){this.body.one(".playpause").setStyle("display","none");}}},handleManualPlayPauseAutoPlay:function(aG,aE){var aI=ad,aD=this.statemgr,aF,aH=(aE.get("tagName")=="A")?aE:aE.ancestor("A"),aC=aH.one(".ti");if(aG==ag){this.isManuallyPaused=A;aF=B;aH.replaceClass(ag,n);aH.setAttribute(I,this.animPauseBeacon);aC.set(F,this.animPauseString);aI=this.startAutoPlay;}else{if(aG==n){this.isManuallyPaused=U;aF=ai;aH.replaceClass(n,ag);aH.setAttribute(I,this.animPlayBeacon);aC.set(F,this.animPlayString);aI=this.cancelAutoPlay;}}if(aI&&aD){aD.setUserModuleState(aA,aF);}return aI;},broadcastEvent:function(){this.moduleapi.broadcast(t);},setFPCKCookie:function(aD){var aC={type:"module",moduleId:this.moduleId,args:{_action:"show",_subAction:b,storyId:aD}},aE={scope:this};if(true){return;}this.arcadeTransport.makeRequest(aC,aE,this.moduleId);},hasAdRunning:function(){return(document.documentElement.className.indexOf("ad-running")>-1);},handleResize:function(){this.carousel.resetPositioning();}};})();/* Copyright (c) 2014, Yahoo! Inc.  All rights reserved. */
(function(){var i="tooltip",a="mouseover",o="mouseout",d="focus",k="blur",c="hover",f="td-ofl-rm",h="td-ofl-ctrl",g="remove",e=".type_offlead",l=".offlead-drawer-login",m=".voh-parent-wrapper",j=".offlead-wrapper",n="data-pkg-id",b="offleadPkgId";YModules.type_offlead={body:null,editBody:null,id:"",moduleapi:null,viewevents:["click"],tooltip:null,listeners:[],userinfo:null,statemgr:null,wrapperContent:null,removeTimer:null,removeEnabled:false,actionDrawer:null,instrumentation:null,init:function(p){this.Y=p.getService("yui");this.id=p.getId();this.moduleapi=p;this.removeLoginEnabled=this.moduleapi.getContextData("remove.login.enabled");this.rapidEnabled=this.moduleapi.getContextData("rapid.enabled");this.statemgr=p.getService("statemgr");this.instrumentation=p.getService("instrumentation");if(this.removeLoginEnabled){this.userinfo=p.getService("userinfo");this.loginService=p.getService("login");this.userState=this.userinfo.isLoggedIn();if(this.loginService&&!this.userState){this.loginWrapperItem=this.Y.Node.create(this.moduleapi.getContextData("drawer.login.html"));this.loginService.getButtons(this.loginWrapperItem,{sec:f,layout:"horizontal",title:"",narrow:1});this.loginService.configClick({selector:l+" a",clickHandler:this.Y.bind(this.onLoginBtnClick,this)});}}},onviewload:function(t){var s=this.moduleapi,r="t",q="c";this.body=s.getViewNode(t);this.actionDrawer=this.body.one(".offlead-drawer");if(this.body.one(m)){this.removeEnabled=true;}if(this.removeEnabled){if(this.removeLoginEnabled){this.actionDrawer.append(this.loginWrapperItem);}try{if(this.moduleapi.getContextData("offlead.position")==1){q="b";r="b";}this.tooltip=s.getService("tooltip").create({parentNode:this.body,className:i,position:{box:r,arrow:q}});this.tooltip.getNode().addClass("fz-xxs");this.listeners.push(this.body.delegate([a,d],this.onShowTooltip,".side-button",this));this.listeners.push(this.body.delegate([o,k],this.onHideTooltip,".side-button",this));if(this.Y.UA.ie&&this.Y.UA.ie<=6){this.listeners.push(this.body.delegate([a,o],this.onOffleadHover,".voh-parent",this));}}catch(p){}}},onviewunload:function(p){if(p==="default"){this.body=null;}else{if(p==="edit"){this.editBody=null;}}},onviewevent:function(r,q){var p=q.target;this.instrument(p);if(this.removeEnabled){if(p.hasClass("side-button")){if(p.hasClass("close")){this.handleCloseBtn(q);}}}},onOffleadHover:function(p){var r=p.currentTarget,q=p.relatedTarget,s;if(r!==q&&!r.contains(q)){s=this.body.one(".side-button");if(s){s.toggleClass("voh",(p.type===o));}}},onShowTooltip:function(p){var q=this.moduleapi,s,r=p.target;s=this.body.hasClass(g)?q.getString("STR.TOOLTIP.UNDO"):q.getString("STR.INTERESTS.REMOVE");if(s){this.tooltip.show(r,{msg:s});}},onHideTooltip:function(p){this.tooltip.hide();},handleCloseBtn:function(p){var u=this.body.one(".voh-parent"),q=this.removeLoginEnabled,t=this.userinfo?this.userinfo.isLoggedIn():null,s=this.getPkgId(),r=this.instrumentation.getBeaconKeys(p.target);if(!this.body.hasClass(g)){if(q&&!t){this.statemgr.setUserModuleState("loggedOutRemove",s);this.showLoginBtns();}else{if(r&&this.rapidEnabled){r.rspns="rmct";this.instrumentation.fireBeacon(r);}this.removeOfflead();}this.body.addClass(g);u.addClass(c);}else{if(q&&!t){this.actionDrawer.transition({height:"0px",duration:0.3,easing:"ease-out"},this.Y.bind(function(){this.actionDrawer.addClass("d-n");this.body.removeClass("drawer-open");},this));this.statemgr.removeUserModuleState("loggedOutRemove");}else{if(r&&this.rapidEnabled){r.rspns="unrmct";this.instrumentation.fireBeacon(r);}this.undoRemoveOfflead();}this.body.removeClass(g);u.removeClass(c);}this.onShowTooltip(p);},getPkgId:function(){return this.body.one(m).getAttribute(n);},removeOfflead:function(){var q=this.body.one(j),r=this.getPkgId(),p;if(!this.wrapperContent){this.wrapperContent=q.getContent();}q.setContent(this.moduleapi.getString("STR.ITEM_REMOVED"));if(!this.removeTimer){if(this.removeLoginEnabled){this.statemgr.saveUserSetting("ol_pkg",r,this.moduleapi);}else{this.statemgr.setUserModuleState(b,r);}this.removeTimer=setTimeout(this.Y.bind(function(){if(this.Y.UA.ie&&this.Y.UA.ie<=7){this.body.addClass("d-n");}else{q.transition({height:"0px",duration:0.3,easing:"ease-out"},this.Y.bind(function(){this.body.addClass("d-n");},this));}if(this.Y.UA.ie&&this.Y.UA.ie<=8){p=this.Y.one(".type_fstream");p._node.className=p._node.className;}},this),4000);}},undoRemoveOfflead:function(){var p=this.body.one(j);if(this.removeLoginEnabled){this.statemgr.saveUserSetting("ol_pkg","0",this.moduleapi);}else{this.statemgr.removeUserModuleState(b);}p.setContent(this.wrapperContent);clearTimeout(this.removeTimer);this.removeTimer=null;},showLoginBtns:function(){var q=this.actionDrawer.one(".embed"),p,r;this.body.addClass("drawer-open");this.actionDrawer.removeClass("d-n");if(!this.actionDrawer.one(".title")){r=this.Y.Node.create(this.moduleapi.getContextData("drawer.title.html"));q.prepend(r);}p=q.get("offsetHeight");this.actionDrawer.transition({height:p+"px",duration:0.3,easing:"ease-in"},function(){});},instrument:function(q){var p={};if(q.ancestor(".ylogin",true,e)){p.sec=f;p.slk="login-yh";p.itc=0;}else{if(q.ancestor(".fblogin",true,e)){p.sec=f;p.slk="login-fb";p.itc=1;}else{if(q.ancestor(".close",true,e)){if(q.ancestor(".drawer-open",true,e)){p.sec=h;p.slk="undo";p.itc=1;p.g="id-"+this.getPkgId();p.ltxt=this.moduleapi.getContextData("offlead.ltxt");p.pkgt=this.moduleapi.getContextData("offlead.pkgt");}else{p.sec=h;p.slk="rm";p.itc=1;p.g="id-"+this.getPkgId();p.ltxt=this.moduleapi.getContextData("offlead.ltxt");p.pkgt=this.moduleapi.getContextData("offlead.pkgt");}}}}if(p.sec){this.instrumentation.fireBeacon(p);}}};}());/* Copyright (c) 2014, Yahoo! Inc.  All rights reserved. */
YUI.add("storage_service",function(d){var i="MPServices",e="StorageProvider",f=true,h=false,g=null,a={},b={},j=g;function c(k){this._moduleId=k;this.onReady(function(){this.ready=f;},this);}c.prototype={_moduleId:g,ready:h,onReady:function(l,k){d.StorageLite.on("storage-lite:ready",function(){l.call(k);});},getItem:function(k){var l;try{l=b[k]||d.StorageLite.getItem(k,f);}catch(m){j.logError(this._moduleId,m.message);}finally{if(l&&d.Object.owns(l,"$v")&&(!l.$e||l.$e>+(new Date()))){b[k]=l;return l.$v;}delete b[k];return g;}},setItem:function(l,p,k){var m;try{m={$v:p,$e:k?+(new Date())+k:0};d.StorageLite.setItem(l,m,f);b[l]=m;return f;}catch(o){if(/QUOTA_EXCEEDED_ERR/.test(o.message)){try{d.StorageLite.removeItem(l);d.StorageLite.setItem(l,m,f);b[l]=m;return f;}catch(n){j.logError(this._moduleId,n.message);}}else{j.logError(this._moduleId,o.message);}return h;}},removeItem:function(k){try{delete b[k];d.StorageLite.removeItem(k);return f;}catch(l){j.logError(this._moduleId,l.message);return h;}},getSet:function(k,n){var p=this.getItem(k),m=+(new Date()),o=h,l={};d.Object.each(p,function(r,q){if(d.Object.owns(r,"$v")&&(!r.$e||r.$e>m)){l[q]=r.$v;}else{o|=delete p[q];}});if(o){this.setItem(k,p);}return n?d.Object.keys(l):l;},addToSet:function(l,m,n,k){var o=this.getItem(l)||{};o[m]={$v:n,$e:k?+(new Date())+k:0};return this.setItem(l,o);},removeFromSet:function(k,l){var m=this.getItem(k);if(m&&d.Object.owns(m,l)){delete m[l];return this.setItem(k,m);}return h;}};d.namespace(i)[e]={name:"storage",getService:function(l,k){if(!j){j=l.getService("metrologger");}if(!a[k]){a[k]=new c(k);}return a[k];}};if(d.ModulePlatform){d.ModulePlatform.registerService(d[i][e]);}},"0.0.1",{requires:["gallery-storage-lite","metrologger"]});/* Copyright (c) 2014, Yahoo! Inc.  All rights reserved. */
(function(){var j=null,n=false,i=true,e=null,d=30*60*1000,k="stream:filter",p="stream:dynamic",h="stream:fallback",c="stream:loadsuccess",a="stream_filter",g="recent_filters",b="filter-selected",m="transform",f="mouseover",o="mouseout",l=".static-list, .dynamic-list, .recent-list";YModules.type_fstream={body:null,editBody:null,id:"",moduleapi:null,platform:j,autoHideEnabled:false,autoHideService:j,swiperService:j,lastSwipeOffset:0,autoHideId:j,viewevents:["click"],isRtl:false,init:function(s){this.Y=s.getService("yui");this.id=s.getId();this.moduleapi=s;this.platform=s.getService("moduleplatform");this.instrumentation=s.getService("instrumentation");this.statemgr=s.getService("statemgr");this.storage=s.getService("storage");this.loginService=s.getService("login");this.swiperService=s.getService("swiper");this.isRtl=(this.moduleapi.getViewDirection("default")==="rtl");this.listeners=[];e=this.Y.config.win;var r=s.getContextData(),q=s.getService("userinfo");this.filterRestoreEnabled=r.filterRestoreEnabled;this.filterFontSize=r.filterFontSize;this.dropdownFilter=r.dropdownFilter;this.tabFilter=r.tabFilter;this.dropdownHover=r.dropdownHover;this.dynamicMax=r.dynamicMax;this.autoHideEnabled=r.autoHideEnabled;this.swipeFilterEnabled=r.swipeFilterEnabled;this.dynamicSectionEnabled=r.dynamicSectionEnabled;this.loginState=q.isLoggedIn();if(this.autoHideEnabled){this.autoHideService=s.getService("autohide");}this.recentFiltersEnabled=r.recentFiltersEnabled;s.listen(k);s.listen(p);s.listen(c);s.listen(h);},onviewload:function(v){var t=this.moduleapi,r,q=this.Y.one("#banner"),u,s;if(q){this.headerHeight=q.get("clientHeight");}if(v==="default"){this.body=t.getViewNode(v);}else{if(v==="edit"){this.editBody=t.getViewNode(v);}}if(this.body.one(".dropdown-label")){if(!this.dropdownFilter&&this.dropdownHover){this.listeners.push(this.body.delegate(f,this.onShowFilterMenu,".dropdown-label-text, .list-container, .drop-arrow",this));this.listeners.push(this.body.delegate(o,this.onHideFilterMenu,".dropdown-label-text, .list-container, .drop-arrow",this));}}if(this.swipeFilterEnabled){s=e.hasOwnProperty("onorientationchange")?"orientationchange":"resize";this.listContainer=this.body.one(".list-container");u=this.Y.bind(this.swipeActionHandler,this);this.swiper=new this.swiperService({body:this.listContainer,slides:1,completeHandler:u,actionEndHandler:u,transitionEnd:i,slideHandler:u,invalid_swipe_range:80});this.swiper.swipeMinDistance=0;this.listeners.push(this.Y.on(s,this.onOrientationChange,e,this));this.rotationDelay=this.Y.UA.android?250:0;}this.storage.onReady(function(){if(this.filterRestoreEnabled){this.savedFilters=this.storage.getItem(a);if(this.savedFilters&&this.savedFilters.loginState===this.loginState){t.unlisten(p);this.buildDynamicCategories(this.savedFilters.list,n);this.platform.on("ready",function(){t.broadcast(p,{dynamicCategories:this.savedFilters.list});},this);}else{this.statemgr.removeUserModuleState(a);this.savedFilters=j;if(!this.dynamicSectionEnabled&&this.swipeFilterEnabled){this.calculateHorizontalFilterWidths();}}}else{if(this.swipeFilterEnabled){this.calculateHorizontalFilterWidths();this.pullSelectedFilterIntoView(this.body.one("."+b));}}r=this.body.one("."+b);if(this.tabFilter&&r){if(this.Y.one(".type_login .wrap")){r.addClass("filter-signedOut");}else{r.removeClass("filter-signedOut");}}if(this.recentFiltersEnabled&&n===this.loginState){var w=this.storage.getItem(g);if(w){this.buildRecentFilters(w);}}},this);this.listeners.push(this.Y.Global.on("media:remove-node",function(w){if(w.node.contains(this.body)){this.onviewunload("default");}},this));},onviewunload:function(q){if(q==="default"){this.body=j;this.Y.Array.each(this.listeners,function(r){r.detach();});this.listeners=[];}else{if(q==="edit"){this.editBody=j;}}},onmessage:function(t,q,s){var r;if(q=="stream"){if(s){if(t===k){this.checkFilterState(s.category,s.name);}else{if((t===p)){this.moduleapi.unlisten(p);this.buildDynamicCategories(s.dynamicCategories,i);}}}if((t===k)||(t===c&&s.batchCount===1)){r=this.body.one("."+b);if(r&&this.Y.one(".type_login .wrap")){r.addClass("filter-signedOut");}}if(t===h){this.clearDynamicFilters();}}},onviewevent:function(s,q){var r=this.Y;if(s==="default"){if(q.type==="click"){q.preventDefault();this.onClick(q.target);}else{}}},buildDynamicCategories:function(u,s){if(!this.dynamicSectionEnabled){return;}var q=this.body.one(".recommended-label"),r=(this.tabFilter)?"fltr-strm-menu":"fltr-strm",v={ftype:"dynamic",sec:r,ft:2,fontSize:this.filterFontSize},t=0;t=this._buildFilters(u,".dynamic-list .filter-list",this.dynamicMax,v);if(t>0&&q){q.removeClass("dn");}if(s&&this.filterRestoreEnabled){this.savedFilters={list:u,loginState:this.loginState};if(!this.storage.setItem(a,this.savedFilters,d)){this.savedFilters=j;}}if(this.swipeFilterEnabled){this.calculateHorizontalFilterWidths();}},buildRecentFilters:function(s){var u={ftype:"recent",sec:"gs-fltr-mu",ft:4},t=this.body.one(".recent-list"),r=0,q=8;r=this._buildFilters(s,t.one(".filter-list"),q,u);if(r>0){t.removeClass("dn");}},_buildFilters:function(s,x,w,r){var q=this.Y,u=this.body,v=(typeof x==="string")?u.one(x):x,t="",y=[];if(r.fontSize){t=" "+r.fontSize;}q.Array.each(s,function(z,A){if(A<w){y.push('<li class="filter-item" data-filter="'+z.id+'" data-ftype="'+r.ftype+'"><a href="javascript:void(0);" data-ylk="sec:strm;ft:'+r.ft+";cpos:"+(A+1)+';pos:0;t1:a3;t2:strm;t3:lst;elm:itm;elmt:fltr;itc:1" data-action-outcome="slctfltr" class="filter-name rapidnofollow'+t+'" role="button">'+z.name+"</a></li>");}});if(y.length>0){v.append(y.join(""));this.instrumentation.refreshModule(u);}return y.length;},setSavedFilter:function(u){var t=this.body.one('[data-filter="'+u+'"]'),r=this.body.one('span[data-filter="'+u+'"]'),s=this.body.one(".dropdown-label-text"),q;if(t&&t.getAttribute("data-api")){return;}if(t){this.body.all("."+b).removeClass(b);q=t.one("a").getContent();t.addClass(b);if(r){r.addClass(b);}if(this.tabFilter&&t.ancestor(".filter-list")){this.fillTabs(t);}if(s&&!this.tabFilter){s.setContent(q);}if(this.swipeFilterEnabled){this.pullSelectedFilterIntoView(t);}}},pullSelectedFilterIntoView:function(q){if(this.isRtl===true){if(q&&this.filter_page_width>(q.getX()+q.get("offsetWidth"))){this.lastSwipeOffset=Math.floor(q.getX());if(this.lastSwipeOffset>this.finalSwipeOffset){this.lastSwipeOffset=this.finalSwipeOffset;}this.listContainer.setStyle(m,"translateX("+this.lastSwipeOffset+"px)");}}else{if(q&&this.filter_page_width<(q.getX()+q.get("offsetWidth"))){this.lastSwipeOffset=-Math.floor(q.getX());if(this.lastSwipeOffset<-this.finalSwipeOffset){this.lastSwipeOffset=-this.finalSwipeOffset;}this.listContainer.setStyle(m,"translateX("+this.lastSwipeOffset+"px)");}}},fillTabs:function(u){var r=this.body.one(".tab-list"),q=r.get("lastChild"),s=this.body.one(".dynamic-list"),t=s?s.one(".recommended-label"):j,A,y,v,z,x,w;v=q.getAttribute("data-filter");z=q.getContent();x=q.getAttribute("data-ftype");w=q.getAttribute("data-api");q.setAttribute("data-filter",u.getAttribute("data-filter"));q.setContent(u.getContent());q.setAttribute("data-ftype",u.getAttribute("data-ftype"));q.setAttribute("data-api",u.getAttribute("data-api"));u.setAttribute("data-filter",v);u.setContent(z);u.setAttribute("data-ftype",x);u.setAttribute("data-api",w);A=((x==="dynamic")||(x==="stream"))?this.body.one(".dynamic-list"):this.body.one(".static-list");A.one(".filter-list").prepend(u);q.one("a").replaceClass("fz-xs","fz-s");u.one("a").replaceClass("fz-s","fz-xs");r.setStyle("overflow","visible");this.Y.later(0,this,function(){r.setStyle("overflow","");});y=A.one(".filter-list");if(y&&y.get("children").size()>this.dynamicMax){y.get("lastChild").remove();if(this.savedFilters){this.savedFilters.list.pop();if(!this.storage.setItem(a,this.savedFilters,d)){this.savedFilters=j;}}}if(t){t.toggleClass("dn",s.all(".filter-list>*").size()===0);}u.removeClass(b);q.addClass(b);q.one("A").focus();this.instrumentation.refreshModule(this.body);},addNewFilter:function(t,r){var v=this.Y,q,s=this.body.one(".dynamic-list UL"),u=+(new Date())+d;q='<li class="filter-item" data-filter="'+t+'" data-ftype="stream"><a href="#" data-ylk="sec:strm;slk:'+r+';cpos:5;pos:0;ft:3" data-action-outcome="slctfltr" class="filter-name rapidnofollow '+this.filterFontSize+'" role="button">'+r+"</a></li>";if(s){s.append(q);this.body.all("."+b).removeClass(b);if(this.savedFilters){this.savedFilters.list.unshift({id:t,name:r});this.setCurFilterData(t,u);}this.fillTabs(v.one('.type_fstream .dynamic-list [data-filter="'+t+'"]'));}},checkFilterState:function(s,q){var t=this.body.one("."+b),r=this.body.one('[data-filter="'+s+'"]'),u=+(new Date())+d;if(!r){if(!q){this.Y.later(0,this,function(){this.moduleapi.broadcast(k,{category:""});this.setSavedFilter("");});}else{this.addNewFilter(s,q);}}else{if(t!==r){if(this.savedFilters){this.setCurFilterData(s,u);}this.setSavedFilter(s);}else{if(this.tabFilter&&t&&t.ancestor(".list-container")){this.setSavedFilter(s);}}}},setCurFilterData:function(q,r){if(this.savedFilters){this.savedFilters.loginState=this.loginState;}if(!this.dynamicSectionEnabled||this.storage.setItem(a,this.savedFilters,d)){this.statemgr.setUserModuleState(a,q+"::"+r);}else{this.savedFilters=j;}},clearDynamicFilters:function(){var q=this.body.one(".rec-list"),r=this.body.one(".recommended-label");if(q){q.all(".filter-item").remove();if(r){r.addClass("dn");}}this.savedFilters=j;this.statemgr.removeUserModuleState(a);this.storage.removeItem(a);this.setSavedFilter("");},onClick:function(H){var r=this.Y,A=this.body,t=A.one(".dropdown-label-text"),C=A.one(".list-container"),B=H,v,u,q,z,G,F,y,D=+(new Date())+d,E,x,w,s;v=this.body.all("."+b);if((this.dropdownFilter||!this.dropdownHover)&&!this.swipeFilterEnabled){if(C.hasClass("list-container-reveal")){this.onHideFilterMenu();}else{this.onShowFilterMenu();}return;}if(H.getAttribute("aria-haspopup")=="true"){this.onShowFilterMenu();E=this.Y.one("body").on("focus",function(I){if(!C.contains(I.target)){this.onHideFilterMenu();E.detach();}},this);this.listeners.push(E);return;}B=B.ancestor(".filter-item",i);if(B&&(v.indexOf(B)===-1)){q=B.getAttribute("data-filter");y=B.getAttribute("data-ftype");if(v){v.removeClass(b);}x=this.body.one('[data-filter="'+q+'"]');x.addClass(b);z=B.one("a").getContent();G=B.ancestor(".static-list")?"filter-s":(B.ancestor(".dynamic-list")?"filter-d":"filter-yml");if(this.tabFilter){G=(y==="dynamic")?"filter-d":(y==="stream")?"filter-i":"filter-s";}F=B.ancestor(l)?C.all("li"):this.body.all(".tab-list li");if((y==="dynamic")||(this.tabFilter)){u={sec:!B.ancestor(".list-container")?"fltr-strm":"fltr-strm-menu",slk:G,ltxt:z,cpos:F?F.indexOf(B)+1:"",pos:0,itc:1};this.instrumentation.fireBeacon(u);}if(t&&H.ancestor(".list-container")){this.onHideFilterMenu();if(!this.tabFilter){t.setContent(z);}}if(this.savedFilters||!this.dynamicSectionEnabled){this.setCurFilterData(q,D);}this.moduleapi.broadcast(k,{category:q,api:B.getAttribute("data-api")});if(this.tabFilter&&B.ancestor(l)){this.fillTabs(B);}if(this.swipeFilterEnabled){s=B.getX();w=s+B.get("offsetWidth");if(this.isRtl===true){if(B.get("offsetLeft")+B.get("offsetWidth")>this.filter_page_width){if(this.lastSwipeOffset>0){this.lastSwipeOffset=Math.floor(-B.get("offsetLeft")+B.get("offsetWidth")+this.filter_page_width);this.lastSwipeOffset=this.lastSwipeOffset<0?0:this.lastSwipeOffset;}this.listContainer.setStyle(m,"translateX("+this.lastSwipeOffset+"px)");}else{if((this.lastSwipeOffset-B.get("offsetLeft"))+B.get("offsetWidth")>0){if(this.lastSwipeOffset<this.finalSwipeOffset){this.lastSwipeOffset+=Math.floor(B.get("offsetLeft")+B.get("offsetWidth"));this.listContainer.setStyle(m,"translateX("+this.lastSwipeOffset+"px)");}}}}else{if(this.filter_page_width<w){w+=this.dropdownFilter?20:0;this.lastSwipeOffset+=Math.floor(this.filter_page_width-w);this.listContainer.setStyle(m,"translateX("+this.lastSwipeOffset+"px)");}else{if(s<0){this.lastSwipeOffset-=Math.floor(s);this.listContainer.setStyle(m,"translateX("+this.lastSwipeOffset+"px)");}}}}}else{if(B&&(v.indexOf(B)!==-1)){if(t){this.onHideFilterMenu();}}}},onShowFilterMenu:function(){var q=this.body,w=q.one(".list-container"),r=q.one(".dropdown-label-text"),u=q.one(".dropdown-label"),s=q.one(".drop-arrow"),v=this.Y,t=this.autoHideService;if(w){if(this.hoverBeacon){this.hoverBeacon.cancel();}if(!this.tabFilter){this.instrumentation.fireBeacon({sec:"fltr-strm",slk:"menu-open",itc:1,action:"click"});}if(this.dropdownFilter){e.scrollTo(0,u.getY()-this.headerHeight);this.curSelectedText=r.getContent();r.setContent(this.moduleapi.getString("STR.FILTERS.FILTERBY"));w.removeClass("list-container-animate");}w.addClass("list-container-reveal");w.setAttribute("aria-hidden",false);}if(s){u.addClass("dropdown-label-hover");s.addClass("drop-arrow-hover");}if(w.hasClass("list-container-reveal")&&t){this.autoHideId=t.register({targets:[q],hide:v.bind(this.onHideFilterMenu,this)});}},onHideFilterMenu:function(){var u=this.body.one(".list-container"),q=this.body.one(".dropdown-label-text"),t=this.body.one(".dropdown-label"),s=this.body.one(".drop-arrow"),r=this.autoHideId;if(u){if(this.tabFilter){this.hoverBeacon=this.Y.later(500,this,function(){this.instrumentation.fireUltBeacon({sec:"fltr-strm",slk:"menu",itc:2,action:"hover"});this.instrumentation.fireYwaBeacon({sec:"strm",itc:2,action:"hvr",rspns:"op",t1:"a3",t2:"strm",t3:"lst",slk:q.get("text"),elm:"itm",elmt:"mu"});});}else{this.instrumentation.fireBeacon({sec:"fltr-strm",slk:"menu-close",itc:1,action:"click"});}if(this.dropdownFilter){q.setContent(this.curSelectedText);u.addClass("list-container-animate");}u.removeClass("list-container-reveal");u.setAttribute("aria-hidden",true);}if(s){t.removeClass("dropdown-label-hover");s.removeClass("drop-arrow-hover");}if(j!==r){this.autoHideService.unregister(r);this.autoHideId=j;}},swipeActionHandler:function(q){var s,r=0,u=8,t;if(!this.canSwipe){return;}switch(q.type){case"slide":if(q.delta.ax>20){this.listContainer.removeClass("fast-animate");s=q.delta.x+this.lastSwipeOffset;this.listContainer.setStyle(m,"translateX("+s+"px)");}t+=1;break;case"swipeEnd":this.lastSwipeOffset+=q.delta.x;if(q.delta.ax>0){r=Math.floor(q.delta.ax/t);}if(r>1){if(q.delta.x<0){this.lastSwipeOffset-=(r*u);}else{this.lastSwipeOffset+=(r*u);}}if((this.isRtl===false&&this.lastSwipeOffset>0)||(this.isRtl===true&&this.lastSwipeOffset<0)){this.lastSwipeOffset=0;this.fireSwipeBeacon();}else{if(Math.abs(this.lastSwipeOffset)>this.finalSwipeOffset){this.lastSwipeOffset=(this.isRtl===true?this.finalSwipeOffset:-this.finalSwipeOffset);this.fireSwipeBeacon();}}this.lastSwipeOffset=Math.floor(this.lastSwipeOffset);this.listContainer.setStyle(m,"translateX("+this.lastSwipeOffset+"px)");this.listContainer.addClass("fast-animate");t=1;break;case"complete":this.listContainer.removeClass("fast-animate");break;}},calculateHorizontalFilterWidths:function(){var q=this.listContainer.ancestor();this.canSwipe=true;this.filter_page_width=q.get("offsetWidth");this.scrollerWidth=this.listContainer.get("offsetWidth");if(this.scrollerWidth<this.filter_page_width){this.canSwipe=false;}this.finalSwipeOffset=Math.floor(this.scrollerWidth-this.filter_page_width);},onOrientationChange:function(q){this.Y.later(this.rotationDelay,this,function(){this.calculateHorizontalFilterWidths();if(this.lastSwipeOffset<-this.finalSwipeOffset){if(this.canSwipe){this.lastSwipeOffset=-this.finalSwipeOffset;}else{this.lastSwipeOffset=0;}this.listContainer.setStyle(m,"translateX("+this.lastSwipeOffset+"px)");}});},fireSwipeBeacon:function(){this.instrumentation.fireBeacon({t1:"a3",t2:"strm",t3:"lst",sec:"strm",slk:"cntr",elm:"itm",elmt:"ctnr",itc:1,action:"swp"});}};}());/* Copyright (c) 2014, Yahoo! Inc.  All rights reserved. */
(function(){var ag=null,t=false,M=true,T=ag,b=ag,ar=ag,y,am=ag,ah=1000/60,aQ=2*24*60*60*1000,g=20,aC="click",O="mouseover",S="mouseout",ai="focus",au="blur",aD="ul",s="li",aM="> "+aD+":last-of-type",k="hover",aX="newcontent",I="lastnew",aF="more",av="fetch_uuids",aW="content_by_uuid",ax="stream:click",P="stream:dynamic",Q="stream:filter",C="stream:refresh",j="location:update",N="stream:fallback",L="stream:loadsuccess",d="stream:new_content",U="stream:entities",H="stream:filters",D="y-tooltip-stream",aT=D+"-1",aR=D+"-2",aP=D+"-3",aO=D+"-4",aN=D+"-5",ab="hidden",V="dn",aY="remove",at="label",aS="value",o="disabled",i="checked",B="offsetHeight",aL="offsetWidth",aH="height",G="data-ka",E="data-kb",al=s+".rmx-ad",ak=s+".related-tweet",F=s+".stream-ad,"+al,Z=al+" .adlink",f=al+" .adv",aq=al+" .sp",m=Z+","+f+","+aq,n="data-uuid",ao=s+".content",aA="highline",u="data-reason",z="data-i",aV="data-wikiid",c="data-wikiids",aG="next-batch",ae="."+aG,ad="endfilters",J="."+ad,aw=".historystate",x=">H2,>UL,>.loading,>.type_login,>.strm-error-msg,>.see-more-button",w="li.cavideo h3 a,li.slideshow h3 a",af="hovertitle",ap="YPROP:LOCAL",ac="YPROP:SAVE",v="YCUSTOM:MYTEAMS",aU="fblogin",h="ylogin",aj="streamLoginType",a=0,aJ=".action-drawer-button-wrapper",aB="saved",an="liked",A="disliked",r="flagged",ay="drawer-open",R="p_30345831",aE="pos-feedback",X="neg-feedback",q="hilite",l=ao+"."+q,K="request-manager",W="streamReadList",aa="streamClosedList",aK="streamEntityFeedbackList",p="streamState",az="streamFlaggedList",e="data-impr-beacon",aI="data-rmx-beacon";YModules.type_stream={body:ag,list:ag,lastScrollCheck:0,scrollThrottle:40,scrollBuffer:50,id:"",moduleapi:ag,platform:ag,viewevents:[aC],instrumentation:ag,batchCount:1,pollBatchCount:0,batchSize:0,clientPagination:ag,items:ag,woeId:ag,intl:ag,ccode:ag,filter:ag,itemRemovalTimer:ag,currentRemovalMenu:ag,pendingNewItems:[],swipeMenu:ag,yepService:ag,yepPlayer:ag,evtStreamEntities:ag,isRmp:t,nativeAds:[],locationPickerEnabled:false,locationService:null,locationInstance:null,init:function(a0){T=a0.getService("yui");b=T.config.win;ar=T.config.doc;try{am=!!(b.history&&b.history.replaceState&&b.history.state!==y);}catch(aZ){am=t;}var Y=a0.getContextData();this.moduleapi=a0;this.id=a0.getId();this.platform=a0.getService("moduleplatform");this.transportHelperService=a0.getService("transport_helper");this.listeners=[];this.customEvents=[];this.instrumentation=a0.getService("instrumentation");this.storage=a0.getService("storage");this.statemgr=a0.getService("statemgr");this.saveForLaterService=a0.getService("saveforlater");this.highlineService=a0.getService("stream_highline");this.userinfo=a0.getService("userinfo");this.loginService=a0.getService("login");this.interestsService=a0.getService("interests");this.batchSize=Y.batchSize||20;this.woeId=Y.woeId;this.intl=Y.intl;this.ccode=Y.ccode||"";this.listId=Y.listId||"";this.pageloadListId=Y.pageloadListId||"";this.blogType=Y.blogType||"";this.items=Y.items||[];this.clientPagination=Y.clientPagination;this.filter={category:Y.filter||"",name:Y.catName||""};this.contentpos=Y.contentpos;this.dynamicEnabled=Y.dynamicEnabled;this.removalMenuEnabled=Y.removalMenuEnabled;this.pollForNewBroadcastEnabled=Y.pollForNewBroadcastEnabled;this.pollForNewFrequency=Y.pollForNewFrequency;this.pollForNewAutoInsert=Y.pollForNewAutoInsert;this.pollForNewPauseOnIdle=Y.pollForNewPauseOnIdle;this.userIdleAfter=Y.userIdleAfter;this.newCountInTitleEnabled=Y.newCountInTitleEnabled;this.pendingNewItems=Y.pendingNewItems||[];this.restoreStateExpire=Y.restoreStateExpire;this.restoreStateMethod=Y.restoreStateMethod;this.restoreStateOnCacheMiss=Y.restoreStateOnCacheMiss;this.batchPause=Y.batchPause;this.endFiltersEnabled=Y.endFiltersEnabled;this.endFiltersCount=Y.endFiltersCount;this.activeItemId=Y.contentId;this.highlightActive=Y.highlightActive;this.highlightActiveBroadcastScroll=Y.highlightActiveBroadcastScroll;this.itemClickBroadcastOnly=Y.itemClickBroadcastOnly;this.itemClickContext=Y.itemClickContext;this.markAsReadEnabled=Y.markAsReadEnabled;this.closeEnabled=Y.closeEnabled;this.fbAcctLinked=Y.fbAcctLinked;this.tooltipsEnabled=Y.tooltipsEnabled;this.interestFiltersEnabled=Y.interestFiltersEnabled;this.interestFiltersBroadcast=Y.interestFiltersBroadcast;this.broadcastDynamicEnabled=Y.broadcastDynamicEnabled;this.sortBy=Y.sortBy;this.isRmp=Y.isRmp;this.minArticleCount=Y.minArticleCount;this.saveEnabled=Y.saveEnabled;this.postLoadActionDrawer=Y.postLoadActionDrawer;this.inlineLightboxEnabled=Y.inlineLightboxEnabled;this.actionDrawerEnabled=Y.actionDrawerEnabled;this.actionDrawerButtonsEnabled=Y.actionDrawerButtonsEnabled;this.writeMixerActions=Y.writeMixerActions;this.readMixerActions=Y.readMixerActions;this.inFallbackState=Y.inFallbackState;this.nonPersonalStream=Y.nonPersonalStream;this.registerRapidInViewport=Y.rapidInViewport;this.flagContentEnabled=Y.flagContentEnabled;this.pageload=M;if(Y.splitOnscroll){this.pagescroll=t;}if(this.interestsService&&Y.interestsData){this.interestsService.set(Y.interestsData);}if(!this.filter.category&&this.pageloadListId&&this.listId!==this.pageloadListId){this.filter.category="LISTID:"+this.listId;}T.Node.DOM_EVENTS.mouseenter=1;T.Node.DOM_EVENTS.mouseleave=1;T.Node.DOM_EVENTS.touchend=1;T.Node.DOM_EVENTS.pageshow=1;a0.listen(Q);a0.listen(P);a0.listen(C);this.platform.subscribe(j,this.handleLocationUpdate,this);T.on("pageshow",function(a1){this.markRead();},b,this);this.initGlobalListeners();this.videoManager=null;if(a0.getContextData("videoPlayerJs")){this.videoManager=a0.getService("inline_video_manager");}},onviewload:function(aZ){if(aZ==="default"){var Y=this.moduleapi;this.body=Y.getViewNode(aZ);this.rapidContainer=this.body.ancestor(".rapid-container")||this.body;this.isLoading=t;this.locationPickerEnabled=Y.getContextData("locationPickerEnabled");this.setupScroll();if(this.restoreStateExpire){this.restoreState(this.initDefaultView);}else{this.initDefaultView();}}},initDefaultView:function(){if(this.storage){this.storage.onReady(this.setupDefaultView,this);}else{this.setupDefaultView();}},setupDefaultView:function(){var a0=this.moduleapi,a1=a0.getContextData("dynamicCategories"),aZ=a0.getContextData("dynamicEntities"),a2=this.activeItemId&&this.getItemByUuid(this.activeItemId);if(this.postLoadActionDrawer){this.addActionDrawer();}this.markRead();this.markFlag();this.updateDislikedInterests();this.updateControls();if(this.readMixerActions){this.getMixerActionsForFirstBatch();}this.cacheNativeAdData();this.initPagination();this.statemgr.removeUserModuleState("context");if(a2){if(this.highlightActive){this.highlightItem(a2);if(!this.restored){if(this.highlightActiveBroadcastScroll){T.Global.fire("media:scroll-into-view",{node:a2});}else{this.scrollDomNode.scrollTop=a2.get("offsetTop")-(this.scrollNodeHeight-a2.get(B))/2;}}}if(this.interestFiltersBroadcast){this.broadcastEntities(a2);}}if(!a0.getContextData("skipCheckBufferOnload")){T.later(0,this,this.checkScroll);}this.platform.on("ready",function(){if(a1&&T.Lang.isArray(a1)&&a1.length>0&&!this.inFallbackState){this.moduleapi.broadcast(P,{dynamicCategories:a1});}if(this.broadcastDynamicEnabled){this.broadcastDynamicFilters({dynamicCategories:a1,dynamicWikis:aZ});}if(this.inFallbackState){this.moduleapi.broadcast(N,{});this.dynamicCats=ag;}this.moduleapi.broadcast(Q,T.merge(this.filter,{norefresh:1}));},this);if(this.pollForNewFrequency&&this.body.one(ao)){if(!this.pollForNewAutoInsert){this.listeners.push(this.body.delegate(aC,this.onClickNewContentNotice,".newcontentnotice button",this));this.listeners.push(T.on("resize",T.bind(this.positionNewContentNotice,this,M)));}if(this.pollForNewPauseOnIdle&&this.userIdleAfter){this.idleService=a0.getService("idle");if(this.idleService){this.idleService.on("idleChange",this.onIdleChange,this);this.idleService.start(this.userIdleAfter);}}this.scheduleNewContentPoll();if(this.pendingNewItems.length){this.onNewContent();}}if(this.saveForLaterService){this.saveForLaterWidget=new this.saveForLaterService({body:this.body,moduleApi:a0,writeToMixer:this.writeMixerActions,itemSelector:ao,saveHandler:T.bind(this.onSaveArticle,this),signedOutSaveHandler:T.bind(this.onSignedOutSaveClick,this)});}if(this.actionDrawerEnabled){this.actionDrawer=a0.getService("stream_action_drawer");if(this.actionDrawer){this.actionDrawer.on("declareFeedback",this.onActionDrawerFeedback,this);this.actionDrawer.on("removeStreamItem",this.removeStreamItem,this);this.actionDrawer.on("onFlagDone",this.onFlagDone,this);this.actionDrawer.on("recordFlag",this.recordFlag,this);this.actionDrawer.on("deleteSaved",this.deleteSavedFromActionDrawer,this);if(!this.actionDrawerButtonsEnabled){this.actionDrawer.on("drawerToggleStart",this.disableStreamButtons,this);this.actionDrawer.on("drawerToggleComplete",this.enableStreamButtons,this);this.actionDrawer.disableButtons();}}}if(a0.getContextData("swipeEnabled")){this.swipeMenu=a0.getService("stream_swipe_menu");this.swipeMenu.init({rootNode:this.body,swipeEducCount:a0.getContextData("swipeEducCount"),swipeEducMaxViews:a0.getContextData("swipeEducMaxViews"),filter:this.filter,closeEnabled:this.closeEnabled,eventHandlers:{onRemoveTransition:T.bind(this.fancyRemove,this),onRemoveContent:T.bind(this.removeContent,this),onSavedRemove:this.saveForLaterService?T.bind(this.deleteSavedArticle,this):ag}});}if(this.tooltipsEnabled){try{this.tooltip=a0.getService("tooltip").create({parentNode:this.body,className:D,position:{box:"t",arrow:"c"}});this.tooltip.getNode().addClass("fz-xxs");this.listeners.push(this.body.delegate([O,ai],this.onShowTooltip,".label, .profile-img, .more, .side-button",this));this.listeners.push(this.body.delegate([S,au],this.onHideTooltip,".label, .profile-img, .more, .side-button",this));}catch(Y){}}if(a0.getContextData("playIconHoverEnabled")){this.listeners.push(this.body.delegate([O,S],this.onHoverTitle,w,this));}if(this.removalMenuEnabled){this.listeners.push(this.body.delegate(O,this.onMouseOverMenu,".remove",this));this.listeners.push(this.body.delegate(S,this.onMouseOutMenu,".remove",this));}if(this.interestFiltersEnabled){this.listeners.push(this.body.delegate([O,ai],this.onMouseOverLi,".content",this));this.listeners.push(this.body.delegate([S,au],this.onMouseOutLi,".content",this));}if(T.UA.ie&&T.UA.ie<=6){this.listeners.push(this.body.delegate([O,S],this.onHoverContent,"ul .content",this));}this.pruneClosed();if(this.filter.category===ap&&this.locationPickerEnabled===true){this.initLocation();}T.Global.fire("pane-manager:sync-nav-pane-scroll");},addActionDrawer:function(){var Y=this.moduleapi.getString("STR.ACTIONDRAWER.MARKUP"),aZ=this.body.all(ao);if(!Y||!aZ){return;}aZ.each(function(a0){if(!a0.hasClass("rmx-ad")){a0.one(".body").insert(Y,"after");}});},onviewunload:function(Y){if(Y==="default"){this.body=ag;if(this.streamLoadReqObj){this.streamLoadReqObj.abort();this.streamLoadReqObj=ag;}T.Array.each(this.listeners,function(aZ){aZ.detach();});this.listeners=[];T.Array.each(this.customEvents,function(aZ){aZ.fired=t;});this.customEvents=[];if(this.scrollListener){this.scrollListener.detach();this.scrollListener=ag;}if(this.newContentPoll){this.newContentPoll.cancel();this.newContentPoll=ag;}if(this.tooltip){this.tooltip.destroy();this.tooltip=ag;}if(this.locationPickerEnabled){this.locationService=null;if(this.locationInstance){this.locationInstance.destroy();this.locationInstance=null;}}}},onmessage:function(a1,aZ,a0){switch(a1){case Q:if(!a0||!a0.norefresh){if(this.videoManager&&this.videoManager.onmessage){this.videoManager.onmessage(a1,aZ,a0);}this.onFilter(a0);}break;case C:if(this.videoManager&&this.videoManager.onmessage){this.videoManager.onmessage(a1,aZ,a0);}this.onFilter(this.filter);break;case P:this.moduleapi.unlisten(P);this.dynamicCats=a0.dynamicCategories;var Y=this.getNode(J);if(Y){this.handleStreamEnd(Y);}break;default:}},handleLocationUpdate:function(Y){if(this.platform.getProperty("loc.cookie.persistent")&&this.statemgr){this.statemgr.setUserPageState("_fpts",Math.round(new Date().getTime()/1000));}this.woeId=Y.woe;if(this.filter.category===ap){this.onFilter(this.filter);}},onviewevent:function(aZ,Y){if(aZ==="default"){if(Y.type===aC){this.onClick(Y);}else{}}},initLocation:function(aZ){var a1=this.body.one(".loc-picker"),a0=this.moduleapi,Y;if(a1){if(!a1.one(".loc-picker-link")){return false;}if(!this.locationService){this.locationService=a0.getService("location_service");}Y={locDropSettings:{crumb:a0.getContextData("locdrop_crumb"),locale:a0.getContextData("locale"),bestLoc:a0.getContextData("best_loc"),curLoc:a0.getContextData("cur_loc"),defLoc:a0.getContextData("def_loc"),userLoc:this.userCitySelection||a0.getContextData("user_loc"),anchorClass:"",glApi:a0.getContextData("useGlApi")},beacon:{sec:a0.getContextData("beacon_sec"),slk:a0.getContextData("beacon_slk"),test:a0.getContextData("beacon_bucketid")}};if(this.locationInstance&&aZ){this.locationInstance.destroy();this.locationInstance=null;if(this.locationService){this.locationInstance=this.locationService.create(a1,this.id,a0,Y);}}else{if(!this.locationInstance){if(this.locationService){this.locationInstance=this.locationService.create(a1,this.id,a0,Y);}}}}},loadContent:function(aZ,a0,a2){var a1,Y={};if(this.pollRequestObj&&!aZ.poll){this.pollRequestObj.abort();this.pollRequestObj=ag;}if(this.filter.category===ap){Y.ups=M;}else{if(this.filter.category===v){Y.udb=M;}}a2=a2||{};a1=this.transportHelperService.makeRequest(T.merge({type:"module",moduleId:this.id,args:T.merge({_action:"show",batch:this.batchCount+1,cat:this.filter.category||"",catName:this.filter.name||"",sb:this.sortBy,ccode:this.ccode,woeid:this.woeId},aZ)},Y),{success:a2.success||this.loadContentSuccess,failure:a2.failure||this.loadContentFailure,scope:this,argument:T.merge(a0,{subAction:aZ._subAction})});return a1;},loadContentSuccess:function(a4,a2){var a0=this.moduleapi,aZ=this.getNode(a2.insertNode),a3=this.getNode(a2.removeNode),a1,Y;if(a4.html){if(aZ){aZ.insert(a4.html,a2.insertLoc);}this.pruneClosed();this.markRead();this.markFlag();this.instrumentation.refreshModuleAsRichView(this.rapidContainer);}if(a3){a3.remove();}if(a3||aZ){this.cacheNativeAdData();}if(a2.subAction===aF){this.isLoading=t;a1=a0.getContextData("dynamicCategories");if(a1&&T.Lang.isArray(a1)&&a1.length>0&&!this.inFallbackState){if(this.filter&&this.filter.category===""){this.platform.on("ready",function(){a0.broadcast(P,{dynamicCategories:a1});},this);}}Y=a0.getContextData("dynamicEntities");if(a4.hasOwnProperty("data")){if(a4.data.hasOwnProperty("contentpos")){this.contentpos=a4.data.contentpos;}if(a4.data.comscore==="pageview_candidate"){this.instrumentation.fireComscoreBeacon();}if(a4.data.hasOwnProperty("items")&&T.Lang.isArray(a4.data.items)){this.items=this.closeEnabled?this.removeDuplicates(a4.data.items,this.storage.getSet(aa,M)):a4.data.items;}if(this.interestsService&&a4.data.hasOwnProperty("interestsData")){this.interestsService.set(a4.data.interestsData);}}if(a2.firstBatch){if(this.readMixerActions){this.getMixerActionsForFirstBatch();}this.ccode=a0.getContextData("ccode");this.clientPagination=a0.getContextData("clientPagination");}}else{if(a2.subAction===aW){this.contentReqDone=M;}}this.batchCount+=1;this.moduleapi.broadcast(L,{category:this.filter.category,batchCount:this.batchCount});this.body.all("a.twitter-follow-button").each(function(a5){b.twttr.widgets.load(a5.getDOMNode());});if(this.filter.category===ap&&this.locationPickerEnabled===true){this.initLocation(true);}T.later(ah,this,function(){this.body.setStyle(aH,ag);var a5=this.getNode(J);if(a5){this.handleStreamEnd(a5);}else{this.checkScroll();}});T.Global.fire("pane-manager:sync-nav-pane-scroll");},loadContentFailure:function(a0,Y){if(this.transportHelperService.wasAborted(a0)){return;}var aZ=this.getNode(Y.removeNode);if(aZ){aZ.remove();}if(Y.subAction===aF){this.isLoading=t;if(Y.firstBatch&&this.filter.category){this.moduleapi.broadcast(Q,{category:""});}}T.later(ah,this,function(){this.body.setStyle(aH,ag);});},fetchContentIds:function(){var Y,aZ;Y={_subAction:av,listid:this.listId,blogtype:this.blogType,key:this.getContinuationKey()};if(!this.clientPagination||!Y.key){return;}this.isLoading=M;aZ={success:function(a3){var a0,a2,a1=this.body.one(aM);if(a3&&a3.data){a0=a3.data.items;a2=a3.data.dynamicCategories;if(a3.data.fbcount&&a1){a1.append("<!-- fb="+a3.data.fbcount+" uuids -->");}}this.isLoading=t;if(a0&&T.Lang.isArray(a0)){this.items=this.removeDuplicates(a0,this.items,a1?a1.all(ao):[],this.closeEnabled?this.storage.getSet(aa,M):[]);}if(a2&&T.Lang.isArray(a2)){this.moduleapi.broadcast(P,{dynamicCategories:a2});}if(this.items.length===0){this.handleStreamEnd();}else{this.checkScroll();}},failure:function(a0){if(this.transportHelperService.wasAborted(a0)){return;}this.isLoading=t;if(this.items.length===0){this.handleStreamEnd();}}};this.streamLoadReqObj=this.loadContent(Y,{},aZ);},loadNextBatch:function(aZ,a2,a5){if(this.isLoading){return;}var a3=this.body.one(ae),a1,a4,Y,a0;if(!a3){return;}if(a5){Y=parseInt(this.moduleapi.getContextData("splitSnippetCount"),10);if(this.batchSize<=Y){return;}a0=this.items.splice(0,this.batchSize-Y);}else{a0=this.items.splice(0,this.batchSize);}a1={_subAction:aF,items:a0,listid:this.listId,blogtype:this.blogType,left:this.items.length,key:this.getContinuationKey(a3),cpos:this.contentpos};if(a2){a1.data=a2;}a4={removeNode:a3,insertNode:a3,insertLoc:"after",firstBatch:aZ};if(a5){a1.partialBatch=M;}if(!aZ){this.instrumentation.fireBeacon(a3);}if(a3.hasClass("loading")&&(a1.key||a1.items.length)){this.isLoading=M;a3.setContent(this.moduleapi.getString("STR.LOADING"));this.streamLoadReqObj=this.loadContent(a1,a4);}else{if(a3){this.handleStreamEnd(a3);}}},handleStreamEnd:function(a2){a2=a2||this.getNode(ae+","+J);if(!a2){return;}var aZ=this.dynamicCats,a1=this.filter.category,Y=[],a0=0;if(this.endFiltersEnabled&&aZ&&aZ.length){a2.removeClass(aG).replaceClass("loading",ad);T.Array.each(aZ,function(a3){if(a3.id!==a1&&a0<this.endFiltersCount){Y[a0++]='<a href="#" class="interest-filter rapidnofollow whs-nw" data-action-outcome="slctfltr" data-filter="'+a3.id+'" data-ylk="rspns:nav;t1:a3;t2:strm;t3:ft;sec:strm;ft:2;elm:itm;elmt:fltr;itc:1;cpos:'+a0+';" role="button">'+a3.name+"</a>";}},this);a2.setContent(!Y.length?"":'<h4 class="fz-s">'+this.moduleapi.getString("STR.END_FILTERS_HEADING")+'</h4><p class="fz-s">'+Y.join('<span class="v-h mr-s">, </span>')+"</p>");this.instrumentation.refreshModule(this.rapidContainer);}else{a2.remove();}},setHistoryState:function(aZ,Y){if(aZ&&Y){aZ._expires=+(new Date())+Y;}if(this.restoreStateMethod==="LOCAL_STORAGE"){if(aZ){aZ.href=b.location.href;this.storage.setItem(p,aZ);}else{this.storage.removeItem(p);}}else{if(this.restoreStateMethod==="HTML5_HISTORY"&&am){b.history.replaceState(aZ,"");}else{try{this.getNode(aw).set(aS,T.JSON.stringify(aZ));}catch(a0){}}}},getHistoryState:function(){var Y=ag,a0;if(this.restoreStateMethod==="LOCAL_STORAGE"){Y=this.storage.getItem(p);if(Y&&Y.href!==b.location.href){Y=ag;}}else{if(am){Y=b.history.state;}else{a0=this.getNode(aw);if(a0&&a0.get(aS)){try{Y=T.JSON.parse(a0.get(aS));}catch(aZ){}}}}if(Y){this.setHistoryState(ag);}return(Y&&(!Y._expires||new Date()<Y._expires))?Y:ag;},saveState:function(){var aZ=[],a0=ag,Y=this.clickedItem||this.clickedLink,a1;if(Y){this.body.all(ao).each(function(a2){var a3=a2.getAttribute(n);if(a2.test(al)){return;}else{if(a2.test(ak)){a3="tweet:"+a3;}}aZ.push({u:a3,r:a2.getAttribute(u),i:a2.getAttribute(z)});});a1=this.scrollDomNode.scrollTop;a0={time:this.getNode(aw).getAttribute("data-time"),items:aZ,listId:this.listId,pending:this.items,filter:this.filter,scrollX:this.scrollDomNode.scrollLeft,scrollY:a1,sortBy:this.sortBy,relY:Y.getY()-a1,itemId:(this.clickedItem)?this.clickedItem.getAttribute(n):ag,activeItemId:this.activeItemId||T.Object.getValue(b,["YUI","type_stream","activeItemId"])};}this.setHistoryState(a0,this.restoreStateExpire);},restoreState:function(a5){var a4,aZ,a3=t,a6=this,Y=a6.getHistoryState(),a1=a6.getNode(aM),a0={},a2={};if(this.filter.category===ap&&this.locationPickerEnabled===true){this.initLocation();}if(a1&&Y&&Y.items&&Y.items.length&&T.Object.getValue(Y,["filter","category"])!==ac){a4=(Y.time===a6.getNode(aw).getAttribute("data-time"));a0._subAction=aF;a0.restore=1;a6.activeItemId=Y.activeItemId;a6.sortBy=Y.sortBy;a6.updateControls();if(a4||this.restoreStateOnCacheMiss){aZ=Y.pending;a0.items=Y.items;a0.listid=Y.listId;a0.left=aZ.length;a0.batch=1;a0.cpos=0;a2.insertNode=this.body;a3=M;}else{Y.items=a6.removeDuplicates(Y.items,a1.all(ao));a6.scrollDomNode.scrollLeft=Y.scrollX;a6.scrollDomNode.scrollTop=Y.scrollY;a6.restored=!Y.items.length;a5.call(a6);return;}a6.isLoading=M;a6.filter=Y.filter;a6.loadContent(a0,a2,{success:function(a9,a8){a9.data.items=aZ;delete a9.data.comscore;if(a3){a6.body.all(x).remove();}a6.loadContentSuccess(a9,a8);a6.restored=M;a5.call(a6);var a7=Y.itemId&&a6.getItemByUuid(Y.itemId);a6.scrollDomNode.scrollLeft=Y.scrollX;a6.scrollDomNode.scrollTop=a7?a7.getY()-Y.relY:Y.scrollY;T.later(0,a6,function(){a6.checkScroll();if(a6.pollForNewFrequency){a6.checkForNewContent();}});},failure:function(a8,a7){a6.loadContentFailure(a8,a7);a5.call(a6);}});}else{a5.call(a6);}},updateDocTitle:function(Y){if(!this.newCountInTitleEnabled){return;}if(!this.originalDocTitle){this.originalDocTitle=T.Lang.trim(ar.title);if(!this.originalDocTitle){return;}}var aZ=this.originalDocTitle;if(Y){if(Y>g){aZ=T.Lang.sub(this.moduleapi.getString("STR.NEWCONTENT.TITLE.OVERMAX"),{count:g,title:aZ});}else{aZ=T.Lang.sub(this.moduleapi.getString("STR.NEWCONTENT.TITLE"),{count:Y,title:aZ});}}ar.title=aZ;},onIdleChange:function(Y){if(this.pollForNewPauseOnIdle){this.pollForNewPaused=Y.idle;if(!this.pollForNewPaused&&this.pollForNewSkipped){this.checkForNewContent();}}},scheduleNewContentPoll:function(){if(this.newContentPoll){this.newContentPoll.cancel();}this.newContentPoll=T.later(this.pollForNewFrequency,this,this.checkForNewContent);},checkForNewContent:function(){if(this.pollForNewPaused){this.pollForNewSkipped=M;return;}if(this.isLoading||this.filter.category||this.sortBy!==a){T.log("skipping checkForNewContent: isLoading="+this.isLoading+", sort="+this.sortBy+", filter="+T.Object.getValue(this.filter,["category"]),"debug","type_stream");this.scheduleNewContentPoll();return;}var Y={_subAction:av,key:0,poll:1},aZ={},a0={success:function(a2){this.pollRequestObj=ag;var a1=T.Object.getValue(a2,["data","items"]),a3;if(a1){a3=this.body.all(ao);a1=this.removeDuplicates(a1,a3.size()?a3:[],this.closeEnabled?this.storage.getSet(aa,M):[],this.items);if(a1.length){this.pendingNewItems=a1;this.broadcastNewContentNotice(a1.length);this.onNewContent();}this.scheduleNewContentPoll();}},failure:function(a1){this.pollRequestObj=ag;}};this.pollRequestObj=this.loadContent(Y,aZ,a0);this.pollForNewSkipped=t;},onNewContent:function(){this.updateDocTitle(this.pendingNewItems.length);if(this.pollForNewAutoInsert){if(this.body.getY()>this.scrollDomNode.scrollTop){this.instrumentation.fireYwaBeacon({action:"insert",sec:"td-strm-new",slk:"insert"});this.insertNewContent();}}else{this.displayNewContentNotice(this.pendingNewItems.length);}},broadcastNewContentNotice:function(aZ){if(!this.pollForNewBroadcastEnabled){return;}var Y="STR.NEWCONTENT.BROADCAST."+(["ZERO","ONE","TWO"][aZ]||"OTHER"),a1=Y&&this.moduleapi.getString(Y)||"",a0=a1&&T.Lang.sub(a1,[aZ])||"";this.moduleapi.broadcast(d,{count:aZ,message:a0});},displayNewContentNotice:function(a0){var a4=this.moduleapi.getString("STR.NEWCONTENT.NOTICE.MESSAGE."+(a0===1?"SINGLE":(a0>g?"OVERMAX":"PLURAL"))),a3=T.Lang.sub(a4,{count:(a0>g?g:a0)}),Y=T.Lang.sub(this.moduleapi.getString("STR.NEWCONTENT.NOTICE.TEMPLATE"),{msg:a3}),a1=this.body.one(aM),a2=T.Node.create(Y),aZ=this.body.one(".newcontentnotice");if(!a1){return;}if(aZ){aZ.replace(a2);}else{a1.insert(a2,"before");this.instrumentation.fireYwaBeacon({action:"secview",sec:"td-strm-msg",outcome:"msgview"});}this.newContentNotice=a2;this.positionNewContentNotice();this.highlightNewItems(ag);},onClickNewContentNotice:function(Y){this.newContentNotice.remove();this.newContentNotice=ag;this.scrollToTop();this.instrumentation.fireBeacon({sec:"td-strm-msg",slk:"top",itc:1});this.insertNewContent();},getMixerActionsForFirstBatch:function(){if(this.filter.category===ac||this.filter.category===ap){return;}var Y=this.getUuids();if(Y.length){this.makeRequestToGetMixerActions(Y,{success:function(aZ){this.markStreamActions(aZ.data.mixerActions);},failure:function(aZ){},scope:this});}},onActionDrawerFeedback:function(Y){this.onDeclareInterest(Y.interestObj,Y.item);},removeStreamItem:function(a1){var aZ=a1.item,a2=!a1.animate?a1.uuid:aZ?aZ.getAttribute(n):ag,Y=this.moduleapi.getString("STR.REMOVE.ITEM.THANKYOU"),a0;if(a2){if(this.filter.category!==ac){if(a1.immediate){aZ.remove();}else{if(a1.animate){if(this.actionDrawerEnabled){aZ.one(".wrapper").addClass("dn");aZ.append(Y);if(aZ.hasClass("featured")){aZ.replaceClass("featured","featured-removed");}if(aZ.one(".fb-friends")){aZ.one(".fb-friends").addClass("dn");}a0=aZ.one(".action-drawer-button-wrapper");if(a0){a0.addClass("dn");}}else{aZ.setContent(Y);}aZ.addClass("remove-item");this.removalTimer=T.later(3000,this,function(){this.fancyRemove(aZ);});}}this.recordClosed(a2);}}},onFlagDone:function(a2){var aZ=a2.item,a3=!a2.animate?a2.uuid:aZ?aZ.getAttribute(n):ag,a1=this.moduleapi.getString("STR.FLAG.ITEM.THANKYOU"),a0,Y;if(a3){if(a2.animate){a0='<li class="flag-thankyou-msg-drawer">'+a1+"</li>";aZ.insert(a0,"after");Y=aZ.get("nextSibling");T.later(3000,this,function(){this.fancyRemove(Y);});}}},recordFlag:function(aZ){var Y=aZ.item,a0=Y?Y.getAttribute(n):ag;if(a0){if(aZ.flag){this.storage.addToSet(az,a0,1,aQ);}else{this.storage.removeFromSet(az,a0);}}},deleteSavedFromActionDrawer:function(Y){this.deleteSavedArticle();},restoreRemovedArticle:function(a0){var a1=a0.one(".action-drawer-button-wrapper"),a2=a0.one("h3 a").get("text").substring(0,8),aZ=a0.getAttribute(n),Y=T.merge(this.instrumentation.getBeaconKeys(a0),{sec:"td-strm-rm",slk:"undo-itm",ltxt:a2,itc:1,action:aC,outcome:"undo"});if(this.removalTimer){this.removalTimer.cancel();a0.one(".remove-wrap").remove();a0.one(".wrapper").removeClass("dn");a0.removeClass("remove-item").removeClass(A);a0.removeClass("y-pattern").removeClass("hover");this.enableStreamButtons({item:a0});if(a0.one(".fb-friends")){a0.one(".fb-friends").removeClass("dn");}if(a1){a1.removeClass("dn");}if(a0.hasClass("featured-removed")){a0.replaceClass("featured-removed","featured");}if(this.actionDrawer&&aZ){if(this.userinfo.isLoggedIn()){this.actionDrawer.markItemFeedbackInMixer(aZ,"neutral","dislike");}this.recordClosed(aZ,M);}this.instrumentation.fireBeacon(Y);}},insertNewContent:function(){var aZ=this.body.one(aM),a2=350,Y=T.Node.create('<li style="height:0">'+this.moduleapi.getString("STR.LOADING")+"</li>"),a1=+(new Date()),a0=function(a3,a4){this.newContentRequestObj=ag;T.later(Math.max(a2,+(new Date())-a1),this,function(){Y.remove();this.updateDocTitle(0);if(!a3&&a4&&a4.html){var a5=T.Node.create("<ul>"+a4.html+"</ul>").all(ao);if(aZ&&a5.size()){aZ.prepend(a5);this.highlightNewItems(a5);if(this.interestsService&&a4.data&&a4.data.interestsData){this.interestsService.set(a4.data.interestsData);}}this.instrumentation.refreshModule(this.rapidContainer);this.cacheNativeAdData();this.pollBatchCount+=1;}});};if(!aZ){return;}aZ.prepend(Y);Y.transition({height:"85px",duration:a2/1000});this.newContentRequestObj=this.loadContent({_subAction:aW,items:this.pendingNewItems,poll:1,ccode:this.ccode,woeid:this.woeId,batch:this.pollBatchCount+1},{},{success:function(a3){a0.call(this,ag,a3);},failure:function(a3){a0.call(this,a3);}});this.pendingNewItems=[];this.broadcastNewContentNotice(0);},getMastheadHeight:function(){var Y=T.one("#masthead");return Y?Y.get(B)-4:0;},scrollToTop:function(){var Y=T.one("#stream")||this.body,aZ=Y.getY()-this.getMastheadHeight();if(this.scrollDomNode.scrollTop>aZ){this.scrollDomNode.scrollTop=aZ;}},positionNewContentNotice:function(a3){if(!this.newContentNotice){return;}var a2=this.newContentNotice,a1=T.one("#stream").one(".filter-bar-section"),Y=this.getMastheadHeight(),a4=a2.hasClass("sticky"),a0,aZ=T.one("BODY");if(a1){Y+=a1.get(B);}a0=(this.scrollDomNode.scrollTop>(this.body.getY()-Y));if(a0&&(!a4||a3)&&aZ.hasClass("fixed-enabled")){a2.setStyles({top:Y+"px",left:this.body.getX()+"px",width:(this.body.get(aL)-parseInt(a2.getComputedStyle("paddingLeft"),10)-parseInt(a2.getComputedStyle("paddingRight"),10))+"px"}).addClass("sticky");}else{if(a4&&(!a0||!aZ.hasClass("fixed-enabled"))){a2.removeClass("sticky").setStyles({top:ag,left:ag,width:ag});}}},highlightNewItems:function(Y){this.body.all("."+aX).removeClass(aX).removeClass(I);if(Y&&Y.size()){Y.addClass(aX);Y.item(Y.size()-1).addClass(I);}},recordRead:function(Y){if(!this.markAsReadEnabled){return;}Y=T.one(Y);if(Y&&Y.hasAttribute(n)&&!Y.test(F)&&!Y.hasClass(aA)){this.storage.addToSet(W,Y.getAttribute(n),1,aQ);Y.addClass("read");}},markRead:function(aZ){if(!this.markAsReadEnabled){return;}var Y=this.storage.getSet(W);if(Y&&T.Object.size(Y)){aZ=aZ||this.body.all(ao);aZ.each(function(a0){var a1=a0.getAttribute(n);if(a1&&Y[a1]){a0.addClass("read");}});}},markFlag:function(aZ){if(!this.flagContentEnabled){return;}if(this.filter.category===ac||this.filter.category===ap){return;}var Y=this.storage.getSet(az);if(Y&&T.Object.size(Y)){aZ=aZ||this.body.all(ao);aZ.each(function(a0){var a1=a0.getAttribute(n);if(a1&&Y[a1]){a0.addClass("flagged");}});}},markStreamActions:function(a2){if(!a2){return;}var aZ=(a2.saveforlater&&T.Lang.isArray(a2.saveforlater))?a2.saveforlater:[],Y=(a2.like&&T.Lang.isArray(a2.like))?a2.like:[],a1=(a2.dislike&&T.Lang.isArray(a2.dislike))?a2.dislike:[],a0;T.Array.each(aZ,function(a3){a0=this.getItemByUuid(a3);if(a0){a0.addClass(aB);}},this);T.Array.each(Y,function(a3){a0=this.getItemByUuid(a3);if(a0){a0.addClass(an);}},this);T.Array.each(a1,function(a3){a0=this.getItemByUuid(a3);if(a0){a0.remove();}},this);},recordClosed:function(aZ,Y){if(!this.closeEnabled||(this.readMixerActions&&this.userinfo.isLoggedIn())){return;}if(Y){this.storage.removeFromSet(aa,aZ);}else{this.storage.addToSet(aa,aZ,1,aQ);}},pruneClosed:function(aZ){if(!this.closeEnabled||this.filter.category===ac){return;}var Y=this.storage.getSet(aa);if(Y&&T.Object.size(Y)&&(this.filter.category!==ap)){aZ=aZ||this.body.all(ao);aZ.each(function(a0){var a1=a0.getAttribute(n);if(a1&&T.Object.owns(Y,a1)){a0.remove();}});}},onDeclareInterest:function(a2,aZ){var a0=this.instrumentation.getBeaconKeys(aZ),Y={"1":"pos","0":"neu","-1":"neg"},a1=this.userinfo.isLoggedIn();if(a1){a0.dcl=Y[a2.current]+"-"+Y[a2["new"]];}a0.itc=1;a0.action=aC;switch(a2.type){case"entity":a0.sec="td-strm-dr";a0.ltxt=a2.id;a0.slk=a2.source?"prvdr":"ent";if(a1){a0.outcm="dclent";}break;case"content":a0.sec="td-strm-ctrl";a0.ltxt=aZ.one("h3 a").get("text").substring(0,8);if(a2.action==="disliked"){a0.rspns=(a2["new"]==="-1")?"rmct":"unrmct";}a0.slk=(a2.action==="liked")?"like":"rm";if(a1){a0.outcm="dclitm";}break;}this.instrumentation.fireBeacon(a0);},initPagination:function(){this.listeners.push(T.after("touchend",this.afterScroll,b,this));this.listeners.push(T.on("resize",function(){this.scrollNodeHeight=this.getScrollNodeHeight();},b,this));if(this.clientPagination){if(this.items.length===0){if(this.pollForNewFrequency||this.dynamicEnabled||this.isInScrollBuffer()){this.fetchContentIds();}else{this.listeners.push(T.onceAfter("scroll",this.fetchContentIds,b,this));}}else{if(this.closeEnabled){this.items=this.removeDuplicates(this.items,this.storage.getSet(aa,M));}}}else{if(this.getContinuationKey()===""){this.batchCount=0;this.loadNextBatch();}}this.scrollBuffer=this.moduleapi.getContextData("scrollBuffer")||this.scrollBuffer;},getContinuationKey:function(aZ){var Y=aZ||this.body.one(ae);if(Y){return Y.hasAttribute("data-key")?Y.getAttribute("data-key"):ag;}return ag;},getNode:function(Y){return T.Lang.isString(Y)?this.body.one(Y):(Y&&this.body.contains(Y)?T.one(Y):ag);},getItemByUuid:function(aZ,Y){Y=Y||this.body;return aZ?Y.one(ao+"["+n+'="'+aZ+'"]'):ag;},getUuids:function(aZ){var Y=aZ||this.body.all(ao),a0=[];Y.each(function(a2){var a1=a2.hasAttribute(n)&&a2.getAttribute(n);if(a1){a0.push(a1);}});return a0;},fancyRemove:function(aZ){var Y=this;aZ=aZ&&T.one(aZ);if(!aZ||!aZ.inDoc()){return;}aZ.transition({height:0,opacity:0,duration:0.4,easing:"ease-in"},function(){aZ.remove();aZ=ag;Y.repaint();});},repaint:function(){if(T.UA.ie&&T.UA.ie<8){this.body._node.className=this.body._node.className;}},setupScroll:function(){var Y=ar.body||T.Node.getDOMNode(T.one("body"));this.scrollDomNode=this.isRmp?T.Node.getDOMNode(this.body.ancestor(function(a0){var aZ=a0.getStyle("overflowY");return(aZ==="scroll"||aZ==="auto"||a0.compareTo(Y));})):Y;this._scrollNodeIsBody=(this.scrollDomNode===Y);if(this._scrollNodeIsBody&&!T.UA.webkit){this.scrollDomNode=ar.documentElement;}this.scrollNodeHeight=this.getScrollNodeHeight();if(this.scrollListener){this.scrollListener.detach();}this.scrollListener=T.one(this._scrollNodeIsBody?b:this.scrollDomNode).after("scroll",this.afterScroll,this);},getScrollNodeHeight:function(){var aZ=this.scrollDomNode,Y=this._scrollNodeIsBody;if(Y&&T.UA.webkit){aZ=ar.documentElement;}return(Y&&T.UA.ios)?b.innerHeight:aZ.clientHeight;},isInScrollBuffer:function(){var aZ=this.body.get("region"),Y=this.body.get("viewportRegion");if(this.registerRapidInViewport&&aZ.height>0&&aZ.top<=Y.bottom){this.registerWithRapid();this.registerRapidInViewport=t;}return(aZ.height>0&&aZ.bottom<(Y.bottom+this.scrollBuffer));},hasScrolled:function(){var aZ=this.body.get("region"),Y=this.body.get("viewportRegion");return(aZ.height>0&&Y.top>5);},checkScroll:function(){if(this.newContentNotice){this.positionNewContentNotice();}if(this.moduleapi.getContextData("splitFirstBatch")){if(this.moduleapi.getContextData("splitOnload")&&this.pageload){this.batchCount=0;this.loadNextBatch(M,null,M);}else{if(this.moduleapi.getContextData("splitOnscroll")&&!this.pagescroll&&this.hasScrolled()){this.pagescroll=M;this.batchCount=0;this.loadNextBatch(M,null,M);}}}if(this.isInScrollBuffer()){if(!this.batchPause||this.batchCount%this.batchPause){this.loadNextBatch();}}if(this.pollForNewAutoInsert&&this.pendingNewItems.length){this.onNewContent();}this.beaconVisibleNativeAds();if(this.pageload){this.pageload=false;}},onClick:function(a5){var a0=T.one(a5.target),a2="#"+T.DOM.generateID(this.body),a6=a0.ancestor(ao,M,a2),a1=a6&&"#"+T.DOM.generateID(a6),a7=a0.ancestor("a",M,a2),a3,Y="",aZ="",a4={};if(a7&&a7.hasClass("fp-article")){a3=a0.ancestor(".fp-open-inline",true);if(a3&&a6.hasClass("fp-bday")){a5.preventDefault();a4={name:a6.getData("bday-name"),bday:a6.getData("bday-date"),hash:a6.getData("bday-hash"),id:a6.getData("bday-fbid")};this.moduleapi.broadcast("fp:open-inline",{sec:"td-strm",ct:"birthday",mode:"embed",module:"birthday",subModuleView:"birthday-story",subModuleData:T.JSON.stringify(a4)});}else{if(this.inlineLightboxEnabled&&a3){if(a3.getAttribute("data-uuid")){Y=a3.getAttribute("data-uuid");}if(a3.getAttribute("href")){aZ=a3.getAttribute("href");}else{aZ=a3.one("A.rapidnofollow").getAttribute("href");}a5.preventDefault();this.moduleapi.broadcast("fp:open-inline",{uuid:Y,href:aZ,sec:"td-strm",ct:"1"});return;}}}if(a0.hasClass("fblink")){return;}if(a0.ancestor(".social-actions",M,a2)&&this.swipeMenu){this.swipeMenu.onClick(a5);return;}if(a0.test(ae+" button")){this.loadNextBatch();return;}if(a0.test('input[name="sb"]')){this.setSortMode(parseInt(a0.get(aS),10),M);return;}if(a0.ancestor(".see-more-button",M,".type_stream")){this.toggleCollapsibleStream(a0.ancestor(".see-more-button",M));return;}if(a7&&a7.test(m)){this.onAdInfoClick(a7,a6);}if(a0.hasClass("interest-filter")){a5.halt();this.moduleapi.broadcast(Q,{category:a0.getAttribute("data-filter"),name:a0.getAttribute("data-filter-name")||a0.getContent()});this.filterBeacon(a0);return;}if(a6){if(a6.hasClass("remove")&&a0.ancestor(".menu",M,a1)){this.onRemovalMenuClick(a5);}else{if(this.actionDrawer&&a0.ancestor(aJ,M,a1)){this.actionDrawer.toggleDrawer(a6,t);}else{if(this.actionDrawer&&a0.ancestor(".close,.check-icon,.save-button,.flag-content-btn",M,a1)){if(!a0.ancestor("button:disabled",M,a1)){this.handleActionDrawerTrigger(a6,a0);}}else{if(this.actionDrawer&&a0.ancestor(".undo-btn",M,a1)){this.restoreRemovedArticle(a6);}else{if(a0.ancestor(".close",M,a1)){a5.preventDefault();if(a6.hasAttribute(n)){if(this.saveForLaterWidget&&this.filter.category===ac){this.deleteSavedArticle(a0);}else{this.removeContent(a6);}}else{this.fancyRemove(a6);}}else{if(a0.hasClass("share-drawer-icon")){a5.preventDefault();}else{if(a0.ancestor(".share-drawer, .friends-string, .label, .sponsorship",M,a1)){}else{if(a6.hasClass("video-inline")&&this.handleInlineVideo(a6,a0)){a5.preventDefault();}else{if(a7){if(!a0.hasClass("interest-filter")){this.recordRead(a6);}if(a5.which!==2&&a5.button!==4&&!a5.altKey&&!a5.ctrlKey&&!a5.shiftKey&&!a5.metaKey&&a7.getAttribute("target").toLowerCase()!=="_blank"){this.clickedItem=a6;this.clickedLink=ag;if(this.restoreStateExpire&&!a6.hasClass("rss-fallback")){this.saveState();}if(this.itemClickContext){this.statemgr.setUserModuleState("context",{cat:this.filter.category,catName:this.filter.name||"",listid:this.listId||"",blogtype:this.blogType||"",u:a6.getAttribute(n)});}if(this.highlightActive){this.highlightItem(a6);}}}}}}}}}}}}this.moduleapi.broadcast(ax);},handleActionDrawerTrigger:function(a9,a0){var a2=a9&&"#"+T.DOM.generateID(a9),a1=a0.ancestor(".close",M,a2)?A:a0.ancestor(".check-icon",M,a2)?an:a0.ancestor(".flag-content-btn",M,a2)?r:aB,Y,a7=this.userinfo.isLoggedIn(),a6,a8,aZ=(a9.hasClass(ay)&&a9.get("nextSibling")&&a9.get("nextSibling").hasClass("action-drawer"))?a9.get("nextSibling"):ag,a5,a4,a3;if(a9.get("nextSibling")&&a9.get("nextSibling").hasClass("flag-thankyou-msg-drawer")){a9.get("nextSibling").remove();a9.removeClass("y-pattern").removeClass("hover");}this.onHideTooltip();if(a1===an){a5=A;a4=r;a3=aB;}else{if(a1===A){if(this.filter.category===ac){this.actionDrawer.toggleDrawer(a9,M);this.actionDrawer.handleSaveClick();return;}a5=an;a4=r;a3=aB;}else{if(a1===aB){a5=an;a4=A;a3=r;}else{if(a1===r){a5=an;a4=A;a3=aB;}}}}a9.toggleClass(a1);if(a1===aB){a6=a7;a8=a7?t:!a9.test("."+an+",."+A+",."+r);}else{a6=!a9.hasClass(ay)&&!a9.hasClass(a1);a8=a7?(!aZ||!aZ.test("."+a5+",."+a4)):(!a9.test("."+a5+",."+a4+",."+a3));}if(!a9.hasClass(ay)||a8){this.actionDrawer.toggleDrawer(a9,a6,a1);}if(a7||(this.nonPersonalStream&&(a1===A))){if(a1===an){this.actionDrawer.handleLikeClick();}else{if(a1===A){this.actionDrawer.handleDislikeClick();Y=a9.getAttribute(n);this.recordClosed(Y,!a9.hasClass(A));}else{if(a1===aB){this.actionDrawer.handleSaveClick();}else{if(a1===r){this.actionDrawer.handleFlagClick();}}}}this.instrumentation.refreshModule(this.rapidContainer);}else{a9.removeClass(a5).removeClass(a4).removeClass(a3);if(this.actionDrawer.currentDrawer){this.actionDrawer.showLoginBtns();}else{if(a1===an||a1===A){this.actionDrawer.fireItemInterestChange("0",a1===an?"1":"-1",a1);}}}a9.one("h3 a").focus();},disableStreamButtons:function(aZ){var Y=aZ?aZ.item:ag;if(Y){Y.all(".side-button").set(o,M);}},enableStreamButtons:function(aZ){var Y=aZ?aZ.item:ag;if(Y){Y.all(".side-button").set(o,t);}},handleInlineVideo:function(a0,Y){var a1,aZ,a2,a3=ag;if(!this.yepService){this.yepService=this.moduleapi.getService("videoyep");if(this.yepService){this.yepPlayer=this.yepService.create();}}if(!this.yepPlayer){return t;}a1=a0.getData();if(!a1.uuid){return t;}if(a1["poster-img"]){a3=a1["poster-img"];}aZ=this.instrumentation.getBeaconKeys(a0);a2={analytics:{sec:aZ.sec,ccode:this.ccode,cpos:aZ.cpos,ct:aZ.ct||3},config:{animated:M,attach:a0,location:"prepend",returnTabIndexTo:Y,yep:{autoplay:M,id:a1.uuid},videoPageUrl:a1.url||ag}};if(a3){a2.config.image=a3;}this.yepPlayer.init(a2);this.recordRead(a0);return M;},onRemovalMenuClick:function(ba){var a1=ba.target,a8,bc=a1.ancestor(ao,M,"#"+T.DOM.generateID(this.body)),a3=T.merge(this.instrumentation.getBeaconKeys(bc),{itc:1,pos:0}),a4,a6,a0,a2,a7,a5,Y,a9={},aZ=[],bb=this;if(a1.ancestor("button.undo",M)){this.clearRemovalTimer();Y=bc.getAttribute(n);this.recordClosed(Y,M);bc.one(".menu").remove();bc.removeClass(aY);this.currentRemovalMenu=ag;a4=bc.one(".wrapper .body h3 a").get("text");a4=(a4&&a4.length>8)?a4.substring(0,8):a4;this.instrumentation.fireBeacon(T.mix({action:aC,outcome:"undo",sec:"td-strm-rm",slk:"undo",ltxt:a4},a3));this.repaint();if(this.userinfo.isLoggedIn()&&this.writeMixerActions){a5={_subAction:"article_feedback",uuid:Y,state:"neutral",mixerAction:"dislike"};this.makeInterestRequest(a5);}bc.one(".wrapper .body a").focus();}else{if(a1.ancestor(".wikiid",M,".menu")){a8=a1.ancestor(".wikiid",M,".menu");a7=a8.hasClass(aE)?1:a8.hasClass(X)?-1:0;if(a1.hasClass("remove-title")){if(a8.hasClass(aE)){a8.replaceClass(aE,X);}else{if(a8.hasClass(X)){a8.removeClass(aE).removeClass(X);}else{a8.replaceClass(X,aE);}}}else{if(a1.ancestor(".remove-pos",M,".wikiid")){a8.toggleClass(aE).removeClass(X);}else{if(a1.ancestor(".remove-neg",M,".wikiid")){a8.toggleClass(X).removeClass(aE);}else{a8.toggleClass(X);a8.removeClass(aE);}}}a0=a8.hasClass(aE)?1:a8.hasClass(X)?-1:0;a4=a8.getAttribute(aV);a2=((a7===1)?"pos":(a7===-1)?"neg":"neu")+"-"+((a0===1)?"pos":(a0===-1)?"neg":"neu");a9[a4]={"new":a0,current:a7,type:a8.getAttribute("data-interesttype")};aZ=a9;this.handleRemovalMenuFeedback(aZ,function(be,bf){var bd;if(bb.currentRemovalMenu&&bb.currentRemovalMenu===bc){if(be===t){if(bb.interestsService){bb.interestsService.update(a4,{state:a0});}bd=a1.ancestor(".remove-menu-main",M,"div");if(!bd.getData("confirmed")){bd.append(bb.moduleapi.getString("STR.BUTTON.REMOVE_DONE"));bd.setData("confirmed",M);bb.repaint();}}else{if(a7===1){a8.replaceClass(X,aE);}else{if(a7===-1){a8.replaceClass(aE,X);}else{a8.removeClass(X).removeClass(aE);}}}}});a6=bc.one(".login");if(a6){a6.removeClass(ab);this.repaint();}if(this.userinfo.isLoggedIn()){this.instrumentation.fireBeacon(T.mix({sec:"td-strm-rm",slk:a2,ltxt:a4,action:aC,outcome:"entitydecl"},a3));}}else{if(a1.ancestor("button.remove-done",M)){bc.one(".menu").empty().setStyle("minHeight",0).append(bb.moduleapi.getString("STR.REMOVE.CONFIRM"));bc.addClass("remove-disappear");bc.removeClass("featured");this.setRemovalTimer();this.repaint();this.instrumentation.fireBeacon(T.mix({slk:"done",ltxt:"done"},a3));}}}},afterScroll:function(Y){if(this.scrollTimer){this.scrollTimer.cancel();}var aZ=+(new Date()),a0=aZ-this.lastScrollCheck;if(a0>this.scrollThrottle){this.checkScroll();this.lastScrollCheck=aZ;}else{this.scrollTimer=T.later(this.scrollThrottle-a0,this,this.checkScroll);}},onHoverContent:function(Y){var a0=Y.currentTarget,aZ=Y.relatedTarget;if(a0!==aZ&&!a0.contains(aZ)){a0.toggleClass(k,(Y.type===O));}},onHoverTitle:function(Y){var aZ=Y.target.ancestor(ao);if(aZ){aZ.toggleClass(af,Y.type===O);}},onMouseOverMenu:function(Y){this.clearRemovalTimer();},onMouseOutMenu:function(Y){this.setRemovalTimer();},onMouseOverLi:function(Y){var aZ=Y.currentTarget;this.trimEntityList(aZ);},trimEntityList:function(aZ){var Y=aZ.one(".interest-list"),a0=Y?aZ.one(".attribution").get("region"):ag,a1;if(Y&&!aZ.hasClass("remove")){Y.removeClass("dn");Y.removeClass("voh");a1=Y.all(".interest-wrap");while(a1.size()&&!Y.inRegion(a0,M)){a1.pop().remove();}}},onMouseOutLi:function(Y){var aZ=Y.currentTarget;this.hideEntityList(aZ);},hideEntityList:function(aZ){var Y=aZ.one(".interest-list");if(Y){Y.addClass("voh");}},onShowTooltip:function(Y){this.showTooltip(Y.currentTarget);},showTooltip:function(a1){var a0=this.tooltip.getNode(),aZ=this.moduleapi,Y=a1.ancestor(ao),a3,a2;if(a1.hasClass("side-button")&&this.actionDrawerEnabled){a0.addClass("whs-nw");if(a1.hasClass("save-button")){a2=Y.hasClass("saved")?aZ.getString("STR.TOOLTIP.UNDO"):aZ.getString("STR.SAVE.SAVETEXT");a0.addClass(aT);}else{if(a1.hasClass("check-icon")){a2=Y.hasClass("liked")?aZ.getString("STR.TOOLTIP.UNDO"):aZ.getString("STR.INTERESTS.LIKETEXT");a0.addClass(aR);}else{if((this.filter.category===ac)||this.nonPersonalStream){a2=aZ.getString("STR.INTERESTS.REMOVETEXT");a3=this.nonPersonalStream?aP:aO;a0.addClass(a3);}else{if(a1.hasClass("close")){a2=Y.hasClass("disliked")?aZ.getString("STR.TOOLTIP.UNDO"):aZ.getString("STR.INTERESTS.DISLIKETEXT");a0.addClass(aP);}else{if(a1.hasClass("flag-content-btn")){a2=Y.hasClass("flagged")?aZ.getString("STR.TOOLTIP.UNDO"):aZ.getString("STR.INTERESTS.FLAGTEXT");a0.addClass(aN);}}}}}}else{if(a1.hasClass("profile-img")){a2=a1.one("img").get("alt");}else{if(a1.hasClass("more")){a2=a1.getAttribute("data-friendlist").split(",").join("<br/>");}}}if(a2){this.tooltip.show(a1,{msg:a2});}},onHideTooltip:function(Y){this.tooltip.hide();this.tooltip.getNode().removeClass(aT).removeClass(aR).removeClass(aP).removeClass(aO).removeClass(aN).removeClass("whs-nw");},onFilter:function(Y){if(this.streamLoadReqObj){this.streamLoadReqObj.abort();this.streamLoadReqObj=ag;}if(this.newContentRequestObj){this.newContentRequestObj.abort();this.newContentRequestObj=ag;}this.filter=Y||{};this.listId=(Y.category&&Y.category.indexOf("LISTID:")===0)?Y.category.slice(7):"";this.batchCount=0;this.contentpos=0;this.isLoading=t;this.items=[];this.pendingNewItems=[];this.broadcastNewContentNotice(0);this.body.setStyle(aH,Math.max(parseInt(this.body.get(B),10),60)+"px");this.body.all(x).remove();this.body.append(this.moduleapi.getString("STR.LOADING.CONTENT"));T.later(ah,this,this.scrollToTop);this.clearRemovalTimer();this.currentRemovalMenu=ag;this.updateDocTitle(0);this.updateControls();this.clearNativeAdData();this.loadNextBatch(M);if(this.saveForLaterWidget&&(Y.category===ac)){this.saveForLaterWidget.onSavedFilter();}if(this.actionDrawer){this.actionDrawer.onFilter(Y);}if(this.swipeMenu){this.swipeMenu.onFilter(Y);}},removeDuplicates:function(Y){var a0={},aZ=[];if(Y&&Y.length){if(arguments.length>1){T.each(T.Array(arguments).slice(1),function(a1){T.each(a1,function(a2){if(!a2){return;}if(a2 instanceof T.Node){a0[a2.getAttribute(n)]=1;if(a2.hasAttribute(G)){a0[a2.getAttribute(G)]=1;}if(a2.hasAttribute(E)){a0[a2.getAttribute(E)]=1;}}else{if(T.Lang.isObject(a2)){a0[a2.u]=1;if(a2.ka){a0[a2.ka]=1;}if(a2.kb){a0[a2.kb]=1;}}else{a0[a2]=1;}}});});T.each(Y,function(a1){if((!a0.hasOwnProperty(a1.u))&&(!a1.ka||!a0.hasOwnProperty(a1.ka))&&(!a1.kb||!a0.hasOwnProperty(a1.kb))){aZ.push(a1);}});}else{aZ=Y.slice(0);}}return aZ;},showRemovalMenu:function(a1){var a5=a1.one(".wrapper"),a0=this.parseInterests(a1),Y=a5.get(B),a3,aZ,a4,a2;a1.addClass(aY);aZ=this.moduleapi.getString("STR.REMOVE.MENU");a3=a1.appendChild(aZ);a4=a3.one(".remove-menu-main");a2=a3.one(".profile-link");a3.setStyle("minHeight",Y);if(a0.length){a4.append(this.moduleapi.getString("STR.SHOW.LESS"));if(a2){a2.removeClass(V);}T.Array.each(a0,function(a6){a6.type=a6.declared?"declared":"";a6.selected=a6.state===1?aE:a6.state===-1?X:"";a4.append(T.Lang.sub(this.moduleapi.getString("STR.BUTTON.WIKIID"),a6));},this);}this.repaint();this.currentRemovalMenu=a1;},handleRemovalMenuFeedback:function(aZ,a3){if(!this.userinfo.isLoggedIn()){return;}var Y,a1;function a2(a4){if(T.Lang.isFunction(a3)){a3(t,a4);}}function a0(a4){if(T.Lang.isFunction(a3)){a3(M,a4);}}Y={_subAction:"int_manage",interest:aZ};a1={success:a2,failure:a0,scope:this};this.makeInterestRequest(Y,a1);},makeRequestToGetMixerActions:function(Y,aZ){this.transportHelperService.makeRequest({type:"module",moduleId:this.id,args:{_action:"show",_subAction:"getMixerActions",uuids:Y}},aZ);},makeInterestRequest:function(Y,aZ){var a0=aZ?aZ:{};this.transportHelperService.makeRequest({type:"module",moduleId:R,args:T.merge({_action:"show"},Y)},a0);},onRemovalMenuLoginClick:function(a1){var a0=a1.ancestor(ao,M,"#"+T.DOM.generateID(this.body)),aZ=T.mix(this.instrumentation.getBeaconKeys(a0),{itc:1,pos:0}),a3=a1.get("text"),a4={},a2=t,Y=[];a3=(a3&&a3.length>8)?a3.substring(0,8):a3;this.clearRemovalTimer();this.currentRemovalMenu=ag;a0.all("span.wikiid").each(function(a6){var a8=a6.getAttribute(aV),a5="neu-"+(a6.hasClass(aE)?"pos":a6.hasClass(X)?"neg":""),a7=a6.hasClass(aE)?1:a6.hasClass(X)?-1:0;if(a6.hasClass(aE)||a6.hasClass(X)){a4[a8]={"new":a7,current:0,type:"declared"};a2=M;Y.push(T.merge(aZ,{slk:a5,ltxt:a8}));}});if(a2){this.storage.setItem(aK,{wikiids:a4,beacons:Y});}this.storage.setItem(aj,a1.hasClass("fblogin")?aU:h);},updateDislikedInterests:function(){if(!this.removalMenuEnabled){return;}var Y;if(!this.userinfo.isLoggedIn()){this.loginService.configClick({selector:".type_stream .remove a",clickHandler:T.bind(this.onRemovalMenuLoginClick,this)});}else{Y=this.storage.getItem(aK);if(Y){if(T.Object.size(Y.wikiids)>0){this.handleRemovalMenuFeedback(Y.wikiids,M);}T.Array.each(Y.beacons,function(aZ){this.instrumentation.fireBeacon(aZ);},this);this.storage.removeItem(aK);}this.storage.removeItem(aj);}},parseInterests:function(aZ){var Y=aZ&&aZ.hasAttribute(c)?aZ.getAttribute(c):ag,a0=Y?T.Object.values(this.interestsService.get(Y.split("|"))):[];T.Array.each(a0,function(a1){a1.streamEligible=(a1.url&&(a1.count>=this.minArticleCount));},this);return a0;},clearRemovalTimer:function(Y){if(this.itemRemovalTimer){this.itemRemovalTimer.cancel();this.itemRemovalTimer=ag;}},setRemovalTimer:function(){this.itemRemovalTimer=T.later(5000,this,function(){this.fancyRemove(this.currentRemovalMenu);this.currentRemovalMenu=ag;});},removeContent:function(a0){var aZ,Y;a0=T.one(a0);if(a0&&a0.hasAttribute(n)){aZ=a0.getAttribute(n);this.recordClosed(aZ);if(this.removalMenuEnabled){if(this.currentRemovalMenu){this.clearRemovalTimer();this.fancyRemove(this.currentRemovalMenu);this.currentRemovalMenu=ag;}this.showRemovalMenu(a0);}else{if(!this.swipeMenu){this.fancyRemove(a0);}}if(this.userinfo.isLoggedIn()&&this.writeMixerActions){Y={_subAction:"article_feedback",uuid:aZ,state:"disliked",mixerAction:"dislike"};this.makeInterestRequest(Y);}this.instrumentation.fireYwaBeacon(T.mix({itc:1,action:aC,outcome:"rmct",slk:"rm",sec:"td-strm-ctrl"},this.instrumentation.getBeaconKeys(a0)));}},setSortMode:function(a1,aZ){var a0=this.instrumentation,Y;if(a1===this.sortBy){return;}this.sortBy=a1;this.statemgr.saveUserSetting("sb",a1,this.moduleapi);this.onFilter(this.filter);if(aZ){this.updateControls();Y=(a1===a?"sort-t":"sort-c");a0.fireBeacon({sec:"set-strm",itc:1,slk:Y,action:aC,outcome:"sort"});}},toggleCollapsibleStream:function(a1){var a2=this.body.all(ao),a0=a2.filter(".expanded-item"),aZ=a1.one("i"),a3,Y={sec:"td-strm",elm:"btn",itc:1,action:aC};if(a1.hasClass("expand")){a1.setHTML(this.moduleapi.getString("STR.STREAM.COLLAPSE")+" "+aZ.get("outerHTML"));a3=M;Y.slk="xpnd";Y.elmt="xpnd";a1.removeClass("expand");a0.removeClass("dn");}else{a1.setHTML(this.moduleapi.getString("STR.STREAM.EXPAND")+" "+aZ.get("outerHTML"));a3=t;Y.slk="clps";Y.elmt="clps";a1.addClass("expand");a0.addClass("dn");}a2.removeClass("no-bottom-border").filter(":not(.dn)").pop().addClass("no-bottom-border");this.instrumentation.fireBeacon(Y);this.statemgr.saveUserSetting("es",a3,this.moduleapi);T.Global.fire("pane-manager:sync-nav-pane-scroll");},updateControls:function(){var Y=this.body.one(".controls"),aZ,a0,a1=this.filter.category,a2=this.sortBy;if(!Y){return;}aZ=Y.one(".sort");Y.all(at).removeClass(i);if(aZ){if(a1===ap){aZ.addClass(o).setAttribute(o,o);a2=a;}else{aZ.removeClass(o).removeAttribute(o);}a0=aZ.one('input[value="'+a2+'"]');if(a0){a0.set(i,M).ancestor(at).addClass(i);}}},filterBeacon:function(a0){var aZ,a1,Y={ltxt:a0.getContent(),cpos:a0.get("parentNode").all(".interest-filter").indexOf(a0)+1,itc:1};if(a0.ancestor(J)){Y.sec="fltr-strm-ft";Y.slk="filter-d";this.instrumentation.fireBeacon(Y);}else{if(a0.ancestor(".interest-list")){aZ=a0.ancestor(ao);a1=this.instrumentation.getBeaconKeys(aZ);Y.slk="filter-i";Y.sec=a1.sec;Y.g=a1.g;Y.woe=this.woeid;Y.ccode=this.ccode;Y.intl=this.intl;this.instrumentation.fireBeacon(Y);}}},deleteSavedArticle:function(Y){if(this.saveForLaterWidget){this.saveForLaterWidget.deleteArticle(Y);}var aZ=this.body.all(ao),a0=this.body.one(".strm-error-msg");if(this.filter.category===ac&&a0&&aZ&&aZ.size()===0){a0.removeClass(V);}this.updateSflHeader(aZ.size());},updateSflHeader:function(aZ){var a0=this.body.one(".saved-stories-header"),Y;if(a0){Y=a0.one(".saved-header-count");if(Y){Y.setHTML(aZ);}if(aZ===0){a0.one(".saved-header-count-wrap").addClass("d-n");}}},onSaveArticle:function(a0,Y){if(!a0){return;}var aZ=T.merge(this.instrumentation.getBeaconKeys(a0),{sec:"td-strm-ctrl",slk:Y,itc:1,action:aC,outcome:((Y==="sv")?"svct":"undo")});this.instrumentation.fireBeacon(aZ);},onSignedOutSaveClick:function(aZ){if(!aZ){return;}var Y=T.merge(this.instrumentation.getBeaconKeys(aZ),{sec:"td-strm-ctrl",action:aC,outcome:"login"});this.instrumentation.fireYwaBeacon(Y);},registerWithRapid:function(){var a0=this.instrumentation,aZ=this.rapidContainer,Y=a0.getBeaconKeys(aZ);if(a0.isModuleTracked(aZ)){a0.refreshModule(aZ);}else{a0.addModule(aZ,Y&&Y.sec?Y.sec:"td-strm");}},cacheNativeAdData:function(){var Y=this.body.all(al+"["+aI+"]");this.clearNativeAdData();if(Y.size&&Y.size()>0){Y.each(function(a0,aZ){this.nativeAds.push({node:a0,y:a0.getY(),height:a0.get(B)});},this);return true;}return false;},clearNativeAdData:function(){this.nativeAds=[];},beaconVisibleNativeAds:function(){var a0,aZ,Y,a1;if(this.nativeAds.length>0){a0=this.scrollDomNode;aZ=this.getScrollNodeHeight();Y=this.nativeAds.length-1;while(Y>=0){a1=this.nativeAds[Y];if(((a0.scrollTop+aZ)>(a1.y+(a1.height/2)))&&(a0.scrollTop<a1.y)){this.fireNativeAdBeaconWhenReady(a1);this.nativeAds.splice(Y,1);}Y--;}}},fireNativeAdBeaconWhenReady:function(Y){T.later(1000,this,function(){var a0,a2,a1=this.scrollDomNode,aZ=this.getScrollNodeHeight();if(((a1.scrollTop+aZ)>(Y.y+(Y.height/2)))&&(a1.scrollTop<Y.y)){a0=Y.node.getAttribute(aI);a2=Y.node.getAttribute(e);if(a0){this.instrumentation.getBeaconImage(a0);Y.node.removeAttribute(aI);}if(a2){this.instrumentation.getBeaconImage(a2);Y.node.removeAttribute(e);}}else{this.nativeAds.push(Y);}});},onAdInfoClick:function(a1,a0){var aZ=this.instrumentation.getBeaconKeys(a0),Y=a1.test(aq)?"sp":a1.test(f)?"adv":"info";this.instrumentation.fireYwaBeacon(T.mix(aZ,{slk:Y,ad:1,action:"click",rspns:"nav"}));},initGlobalListeners:function(){this.listeners.push(T.Global.on("media:remove-node",function(Y){if(Y.node.contains(this.body)){this.onviewunload("default");}},this));this.listeners.push(T.Global.on(K+":initialized",this.onReqMgrInitialized,this));this.listeners.push(T.Global.on(K+":active-content-changed",this.onReqMgrActiveContentChange,this));this.listeners.push(T.Global.on("pane-manager:scroll-mode-change",this.setupScroll,this));this.listeners.push(T.Global.on(Q,function(Y){this.moduleapi.broadcast(Q,Y);},this));},onReqMgrInitialized:function(Y){if(Y&&Y.metadata){this.substituteDataInTemplate(Y.metadata);}},onReqMgrActiveContentChange:function(a0){var Y=T.Object.getValue(a0,["uuid"]),aZ=Y&&this.getItemByUuid(Y)||ag;b.YUI.namespace("type_stream").activeItemId=this.activeItemId=Y;if(aZ&&this.interestFiltersBroadcast){this.broadcastEntities(aZ);}if(this.highlightActive){this.highlightItem(aZ);}},substituteDataInTemplate:function(aZ){var Y=aZ&&aZ.uuid&&this.getItemByUuid(aZ.uuid);if(Y&&Y.hasClass(V)){if(aZ.url&&aZ.title){aZ=T.merge({summary:aZ.description||"",pubdate:"",attribution:""},aZ);Y.setHTML(T.Lang.sub(Y.getHTML(),aZ)).removeClass(V);}else{Y.remove();}}},highlightItem:function(Y){this.body.all(l).removeClass(q);if(Y&&!Y.hasClass(aA)){Y.addClass(q);}},broadcastEntities:function(aZ){var a0={url:"",uuid:"",entities:[]},Y;if(aZ){Y=aZ.one("h3 a");if(Y){a0.url=Y.getAttribute("href");}if(aZ.hasAttribute(n)){a0.uuid=aZ.getAttribute(n);}if(this.interestFiltersBroadcast&&aZ.hasAttribute(c)){a0.entities=this.parseInterests(aZ);}}if(!this.evtStreamEntities){this.evtStreamEntities=T.Global.publish(U,{fireOnce:M,async:M});this.customEvents.push(this.evtStreamEntities);}else{if(this.evtStreamEntities.fireOnce){this.evtStreamEntities.applyConfig({fireOnce:t,async:t},M);}}this.evtStreamEntities.fire(a0);},broadcastDynamicFilters:function(Y){if(!this.evtStreamDynamicFilters){this.evtStreamDynamicFilters=T.Global.publish(H,{fireOnce:M,async:M});this.customEvents.push(this.evtStreamDynamicFilters);}else{if(this.evtStreamDynamicFilters.fireOnce){this.evtStreamDynamicFilters.applyConfig({fireOnce:t,async:t},M);}}this.evtStreamDynamicFilters.fire(Y);}};}());/* Copyright (c) 2014, Yahoo! Inc.  All rights reserved. */
YUI.add("interests_service",function(b){var i="MPServices",d="InterestsProvider",e=true,f=null,j=b.guid(),g="interests_service|",h="interests:change",c={},k=f;function a(){b.Global.detachAll(g+"*");b.Global.on(g+h,this._onInterestsChange,this);}a.prototype={_fireWithOrigin:function(l,n){var m={origin:j,data:n};this.fire(l,m);},_onInterestsChange:function(l){if(l.origin!==j){this.set(l.data);}},get:function(n,m){var o,l={};b.Array.each(n||b.Object.keys(c),function(p){o=b.Object.owns(c,p)?b.merge(c[p]):f;if(o&&(!m||m(o,p))){l[p]=o;}});return l;},getById:function(l){return this.get([l])[l]||f;},set:function(m){var l={};b.Object.each(m,function(n,o){this.update(o,n,e);l[o]=b.merge(c[o]);},this);this._fireWithOrigin(h,l);return this;},update:function(o,m,l){var n={};if(b.Object.owns(c,o)){b.mix(c[o],m,e);}else{m.id=o;c[o]=b.merge(m);}if(!l){n[o]=b.merge(c[o]);this._fireWithOrigin(h,n);}return this;}};b.augment(a,b.EventTarget,e,f,{broadcast:2,emitFacade:e});b.namespace(i)[d]={name:"interests",getService:function(m,l){if(!k){k=new a();}return k;}};if(b.ModulePlatform){b.ModulePlatform.registerService(b[i][d]);}},"0.0.1",{requires:["event-custom-base"]});/* Copyright (c) 2014, Yahoo! Inc.  All rights reserved. */
YUI.add("stream_action_drawer",function(Q){var W=null,J=true,v=false,aj="click",am=5*60*1000,at=2*24*60*60*1000,al=80,c="data-uuid",av="YPROP:SAVE",ao="height",U="MPServices",H="StreamSocialProvider",e=Q.ModulePlatform,h={LIKE:1,NEUTRAL:0,DISLIKE:-1},q=Q.Node.create('<span class="action-drawer-login"></span>'),k="like",aa="dislike",ah="saveforlater",D=".social-actions",a=".social-icon",G=".save-button",I=".check-button",L=".remove",j=".delete",m=G+","+I+","+L+","+j,Z=".saved,.liked,.disliked,.flagged",an=".entity",r=".entity-list",S=".entity-msg",t=".done-button",ak=".action-drawer-login",u="li",ab=".menu",R=".flag-content-item",ae="drawer-open",F="drawer-transition",ag="highline",ai="saved",X="liked",K="neutral",A="disliked",p="pos",ar="neu",ay="neg",s="flagged",n="put-update",au="delete-update",x="savedarticles",B="actionRestore",E="flagDetailsRestore",l="declareFeedback",z="removeStreamItem",d="onFlagDone",ad="recordFlag",O="deleteSaved",f="drawerToggleStart",ap="drawerToggleComplete",i="checked",P="input",g="saveforlater:newsaved",T="p_30345860",M="p_30345831",aq,N,w,C,V,ac,af,b,ax="",o=J,aw=0,y;y=function(Y){var az=W,aA=w.isLoggedIn();if(C&&!aA){if(af.getString("STR.ACTIONDRAWER.LOGIN.TEMPLATE")){q.setContent(af.getString("STR.ACTIONDRAWER.LOGIN.TEMPLATE"));}else{C.getButtons(q,{sec:"td-strm-dr",layout:"horizontal",title:af.getString("STR.ACTIONDRAWER.LIKEDCTA"),narrow:1});}C.configClick({selector:ak+" a",clickHandler:Q.bind(this.onLoginBtnClick,this)});}if(N){N.removeItem(x);az=N.getItem(B);if(az){if(aA){this.restoreAction(az);}N.removeItem(B);}}this.viewingSavedStories=ac?ac.isSflPage:v;this.flagContentEnabled=ac?ac.flagContentEnabled:v;this.sourceDeclarationEnabled=ac?ac.sourceDeclarationEnabled:v;this.timerInProcess=null;};y.prototype={disableButtons:function(){o=v;},restoreAction:function(az){var aA={},Y;if(az.type===ai){this.makeSaveRequest(n,az.uuid,J);aq.fireBeacon(az.beacon);}else{aq.fireBeacon(az.beacon);if(az.type===A){this.fire(z,{uuid:az.uuid,animate:v});aA={uuid:az.uuid,state:h.DISLIKE};}else{aA={uuid:az.uuid,state:h.LIKE};}this.fire(l,aA);Y=(az.type===X)?k:aa;this.markItemFeedbackInMixer(az.uuid,az.type,Y);}},handleSaveClick:function(aB){var aC=this.currentItem.hasClass(ai),aA,az=this.currentItem.getAttribute(c),Y=Q.merge(aq.getBeaconKeys(this.currentItem),{sec:"td-strm-ctrl",itc:1,action:aj});if(!aC||this.viewingSavedStories){if(this.viewingSavedStories){Y.slk="rm";Y.outcm="rmsvct";Y.rspns="rmct";}else{Y.slk="unsv";Y.outcm="unsvct";}aA=au;}else{Y.slk="sv";Y.outcm="svct";aA=n;Q.Global.fire(g);}aq.fireBeacon(Y);this.makeSaveRequest(aA,az);if(this.viewingSavedStories){if(o){this.closeDrawer(this.currentDrawer);}this.currentItem.remove();this.fire(O,{});}},handleLikeClick:function(aA){var aD=this.currentItem.hasClass(X),az=this.currentItem.hasClass(A),Y=this.currentItem.getAttribute(c),aC=aD?"1":"0",aB=az?"-1":aD?"0":"1";if(!o){this.currentItem.removeClass(A);if(this.currentDrawer){this.currentDrawer.removeClass(A);if(aD){this.currentDrawer.addClass(X);}else{this.currentDrawer.removeClass(X);}}}this.fireItemInterestChange(aC,aB,X);this.markItemFeedbackInMixer(Y,aD?X:K,k);if(az){this.markItemFeedbackInMixer(Y,K,aa);}if(!aD){if(this.currentItem.hasClass(ae)&&this.currentDrawer&&this.currentDrawer.hasClass(s)){this.buildFlagEntityList();}if(o){this.closeDrawer(this.currentDrawer);}}else{this.buildEntityList(v);}},handleDislikeClick:function(aA){var aD=this.currentItem.hasClass(X),az=this.currentItem.hasClass(A),Y=this.currentItem.getAttribute(c),aC=az?"-1":"0",aB=aD?"1":az?"0":"-1";if(!o){this.currentItem.removeClass(X);if(this.currentDrawer){this.currentDrawer.removeClass(X);if(az){this.currentDrawer.addClass(A);}else{this.currentDrawer.removeClass(A);}}}this.fireItemInterestChange(aC,aB,A);this.markItemFeedbackInMixer(Y,az?A:K,aa);if(aD){this.markItemFeedbackInMixer(Y,K,k);}if(!az){if(this.currentItem.hasClass(ae)&&this.currentDrawer&&this.currentDrawer.hasClass(s)){this.buildFlagEntityList();}if(o){this.closeDrawer(this.currentDrawer);}}else{this.buildEntityList(v);this.updateConfirmationMsg(af.getString("STR.ENTITY.LIST.DISLIKED.MSG"));}},handleFlagClick:function(aA){var az=this.currentItem.hasClass(s),Y=Q.merge(aq.getBeaconKeys(this.currentItem),{sec:"td-strm-ctrl",elm:"btn",elmt:"flag",itc:1,intl:ac.intl,action:aj});if(this.currentDrawer){if(az){this.currentDrawer.addClass(s);}else{this.currentDrawer.removeClass(s);}}if(!az){Y.slk="unflag";Y.outcm="unflagitm";Y.rspns="clps";Q.later(300,this,function(){this.fire(ad,{item:this.currentItem,flag:v});});if(this.currentItem.hasClass(ae)&&this.currentDrawer&&this.currentDrawer.hasClass(X)){this.buildEntityList(J);}else{if(this.currentItem.hasClass(ae)&&this.currentDrawer&&this.currentDrawer.hasClass(A)){this.buildEntityList(J);this.updateConfirmationMsg(af.getString("STR.ENTITY.LIST.DISLIKED.MSG"));}}if(o){this.closeDrawer(this.currentDrawer);}}else{Y.slk="flag";Y.outcm="flagitm";Y.rspns="xpnd";Q.later(300,this,function(){this.fire(ad,{item:this.currentItem,flag:J});});this.buildFlagEntityList();}aq.fireBeacon(Y);},markItemFeedbackInMixer:function(Y,aA,az){if(!ac.writeMixerActions||!w.isLoggedIn()){return;}if(!ax&&ac.listId){ax="LISTID:"+ac.listId;}this.makeInterestRequest({_subAction:"article_feedback",uuid:Y,state:aA,mixerAction:az,curFilter:ax});},updateConfirmationMsg:function(az){var Y=this.currentDrawer.one(S);if(Y){Y.setHTML(az);}},buildEntityList:function(aN){var aH=o?af.getString("STR.ENTITY.LIST.TEMPLATE"):af.getString("STR.REMOVE.MENU"),aP=af.getString("STR.ENTITY.ITEM.TEMPLATE"),aO="",az,Y,aD,aL=this.currentDrawer.one(S),aE=this.currentDrawer.one(r),aJ=this.currentDrawer.one(t),aG=this.currentDrawer.one(ab),aA,aM="",aB={},aK,aC=J,aQ=0,aF=this.currentDrawer,aI=this;if(aE&&aJ&&aL){aE.remove();aJ.remove();aL.remove();}if(aG){aG.remove();}aA=V.get(this.currentItem.getAttribute("data-wikiids").split("|"));Q.Object.each(aA,function(aR){aB={state:(aR.state===1)?p:(aR.state===-1)?ay:ar,type:aR.declared?"declared":"inferred",id:aR.id,name:aR.name};aM+=Q.Lang.sub(aP,aB);});if(!o){this.currentItem.addClass("y-pattern").addClass("hover");aF.removeClass("dn");}if(this.sourceDeclarationEnabled){aD=this.currentItem.getAttribute("data-sourceid");if(aD){aO=af.getString("STR.SOURCE.ITEM.TEMPLATE");Y=V.getById(aD);az={state:Y?((Y.state===1)?p:((Y.state===-1)?ay:ar)):ar,id:aD,name:Y.name};aO=Q.Lang.sub(aO,az);}}if(Q.Object.size(aA)>0){aM=Q.Lang.sub(aH,{source:aO,entities:aM});aF.append(aM);if(o){aF.one(D).setStyle(ao,al+"px");aK=al+aF.one(r).get("clientHeight")+aF.one(t).get("clientHeight")+aF.one(S).get("clientHeight")+30;}else{aF.all(an).addClass("d-ib");aK=aF.one(ab).get("offsetHeight");aJ=aF.one(t);}aC=v;}else{if(!aN){if(o){aF.one(D).remove();}aM=af.getString("STR.ACTIONDRAWER.NOENTITIESLIKE");aF.append(aM);aK=aF.one(".no-entities").get("clientHeight");aC=v;aQ=aF.hasClass(A)?0:3000;this.timerInProcess=Q.later(aQ,this,function(){if(aI.currentDrawer===aF){aI.closeDrawer(aF,ac.nonPersonalStream);}});if(aF.hasClass(A)){aF.addClass("dn");this.currentItem.removeClass(ae);return aC;}}}aF.transition({height:aK+"px",duration:0.3,easing:"ease-in",on:{start:function(){aI.fire(f,{item:aI.currentItem});},end:function(){aI.fire(ap,{item:aI.currentItem});if(aJ){aJ.removeClass("dn");}aI.repaint();}}});return aC;},showLoginBtns:function(){if(!this.currentItem||!this.currentDrawer){return;}var az=this.currentItem.hasClass(ai)?af.getString("STR.ACTIONDRAWER.SAVEDCTA"):this.currentItem.hasClass(X)?af.getString("STR.ACTIONDRAWER.LIKEDCTA"):this.currentItem.hasClass(s)?af.getString("STR.ACTIONDRAWER.FLAGGEDCTA"):af.getString("STR.ACTIONDRAWER.DISLIKEDCTA"),aC,Y=this.currentDrawer.one(ak),aA,aE,aD,aB=this;if(Y){Y.remove();}Y=this.currentDrawer.appendChild(q.cloneNode(J));if(this.currentItem.hasClass(A)){aC=Y.appendChild(af.getString("STR.ACTIONDRAWER.DONE"));}aD=this.currentDrawer.one(".title");if(aD){aD.setHTML(az);if(o){this.currentDrawer.one(D).setStyle(ao,al+"px");aA=al+this.currentDrawer.one(".embed").get("clientHeight");if(aC){aA+=(aC.get("clientHeight")+5);}}else{this.currentItem.addClass("y-pattern").addClass("hover");this.currentDrawer.removeClass("dn");aA=this.currentDrawer.one(".embed").get("offsetHeight");if(this.currentItem.hasClass(X)||this.currentItem.hasClass(A)){aE=this.currentItem.hasClass(X);this.fireItemInterestChange(aE?"1":"-1","0",aE?X:A);}}this.currentDrawer.transition({height:aA+"px",duration:0.3,easing:"ease-in",on:{start:function(){aB.fire(f,{item:aB.currentItem});},end:function(){aB.fire(ap,{item:aB.currentItem});aB.repaint();}}});}},onLoginBtnClick:function(Y){var aB=Q.merge(aq.getBeaconKeys(this.currentItem),{sec:"td-strm-ctrl",action:aj}),aA=this.currentItem.getAttribute(c),az;if(this.currentItem.hasClass(X)){az=X;aB.slk="neu-pos";aB.outcome="itemdecl";}else{if(this.currentItem.hasClass(A)){az=A;aB.slk="neu-neg";aB.outcome="itemdecl";}else{if(this.currentItem.hasClass(ai)){az=ai;aB.slk="sv";aB.outcome="svct";}else{if(this.currentItem.hasClass(s)){az=s;aB.slk="flag";aB.outcome="flagitm";}}}}N.setItem(B,{type:az,uuid:aA,beacon:aB},am);},onDoneClick:function(Y){aq.fireBeacon({sec:"td-strm-dr",slk:"btn-dn",itc:1,action:aj});this.closeDrawer(this.currentDrawer);},onFilter:function(Y){this.currentItem=W;this.currentDrawer=W;ax=Y.category;this.viewingSavedStories=v;if(ax===av){this.viewingSavedStories=J;}},populateHighlineMenu:function(){var aA=this.currentItem.getAttribute("data-highline-id"),az={id:encodeURIComponent(aA)},Y=this.currentDrawer.all("a");Y.each(function(aB){aB.setAttribute("href",Q.Lang.sub(aB.getAttribute("data-base-url"),az));});},onEntityClick:function(aI){var aC=aI.target,aH=aC.ancestor(an,J),aA=aH.getAttribute("data-interestid"),aF=aH.hasClass(p)?h.LIKE:aH.hasClass(ay)?h.DISLIKE:h.NEUTRAL,aB=aH.hasClass("inferred")?"inferred":"declared",Y,aD=aH.hasClass("source"),az={},aE={},aG={};if(this.currentDrawer.hasClass(X)&&!aH.hasClass(p)){aH.addClass(p);aH.removeClass(ar).removeClass(ay);Y=h.LIKE;}else{if(this.currentDrawer.hasClass(A)&&!aH.hasClass(ay)){aH.addClass(ay);aH.removeClass(ar).removeClass(p);Y=h.DISLIKE;}else{aH.addClass(ar);aH.removeClass(p).removeClass(ay);Y=h.NEUTRAL;}}aG={"new":Y.toString(),current:aF.toString(),type:"entity",id:aA};if(aD){aG.source=1;}this.fire(l,{interestObj:aG,item:this.currentItem,markFeedback:v});az={"new":Y,current:aF,type:aB};if(aD){az.name=aH.get("text");}aE[aA]=az;this.makeInterestRequest({_subAction:"int_manage",interest:aE});V.update(aA,{state:Y});},toggleDrawer:function(aH,aC,aA){var aE=w.isLoggedIn(),aD="",aI,aF=J,Y,aG=aH.get("nextSibling"),aJ=this,aB=this.currentItem&&this.currentItem.hasClass(ae)&&aH!==this.currentItem,az={sec:"td-strm-ctrl",itc:1,action:aj};if(aG&&aG.hasClass("flag-thankyou-msg-drawer")){aG.remove();}if(aB){this.closeDrawer(this.currentDrawer,true);}this.currentItem=aH;Y=this.currentItem.getAttribute(c);if(!aC&&this.currentItem&&!this.currentItem.hasClass(ae)){if(o){if(this.viewingSavedStories){aD=af.getString("STR.SAVE.BTN.TEMPLATE");}else{if(aH.hasClass(ag)){aD=af.getString("STR.HIGHLINE.BTN.TEMPLATE");}else{aD=af.getString("STR.SHARE.BTN.TEMPLATE");}}}aI='<li class="action-drawer y-pattern">'+aD+"</li>";this.currentItem.insert(aI,"after");this.currentDrawer=this.currentItem.get("nextSibling");if(o){this.currentDrawer.one(D).removeClass("v-h").removeClass("closed");this.actionBtnListner=this.currentDrawer.delegate(aj,this.onActionDrawerClick,m,this);}if(this.flagContentEnabled){this.flagItemListner=this.currentDrawer.delegate("change",this.onFlagItemClick,R+" "+P,this);}this.entityListner=this.currentDrawer.delegate(aj,this.onEntityClick,an,this);this.doneBtnListner=this.currentDrawer.delegate(aj,this.onDoneClick,t,this);if(!this.viewingSavedStories&&(o||aE)){if(aA){this.currentDrawer.addClass(aA);}else{if(this.currentItem.hasClass(ai)){this.currentDrawer.addClass(ai);}if(this.currentItem.hasClass(X)){this.currentDrawer.addClass(X);if(o){aF=this.buildEntityList(J);}}if(this.currentItem.hasClass(A)){this.currentDrawer.addClass(A);if(o){aF=this.buildEntityList(J);}this.updateConfirmationMsg(af.getString("STR.ENTITY.LIST.DISLIKED.MSG"));}if(this.currentItem.hasClass(s)){this.currentDrawer.addClass(s);if(o){this.buildFlagEntityList();}}}if(this.currentItem.hasClass(ag)){this.currentDrawer.addClass(ag);this.populateHighlineMenu();}}else{if(!o&&!aE){aF=v;}}if(aF&&o){this.currentDrawer.transition({height:al+"px",duration:0.3,easing:"ease-in",on:{start:function(){aJ.currentDrawer.addClass(F);},end:function(){aJ.currentDrawer.removeClass(F);}}});Q.config.win.scrollTo(0,aJ.currentItem.getY()-aw);}this.currentItem.addClass(ae);if(!o){this.currentDrawer.addClass("dn");}az.rspns="xpnd";}else{if(!aC&&this.currentItem&&this.currentItem.hasClass(ae)){this.closeDrawer(this.currentDrawer);this.currentDrawer=W;az.rspns="clps";if(o){this.actionBtnListner.detach();}this.entityListner.detach();this.doneBtnListner.detach();if(this.flagContentEnabled){this.flagItemListner.detach();}}}if(o){az.slk="btn-dr";aq.fireBeacon(az);}},closeDrawer:function(aE,aA){var aF=w.isLoggedIn(),aD=this.currentItem,aB=this.currentDrawer,az=aE.one(t),Y=this,aC={};if(az){az.addClass("dn");}if(aD.hasClass(s)&&aB.one(".flag-entity-msg")){Q.later(300,this,function(){this.fire(d,{item:aD,drawer:aB,animate:J});});}if(aD.hasClass(A)){if(aD.hasClass(s)&&aB.one(".flag-entity-msg")){Q.later(300,this,function(){this.fire(z,{item:aD,animate:J,immediate:J});});}else{Q.later(300,this,function(){this.fire(z,{item:aD,animate:J,immediate:v});});}}if(!aF&&this.currentItem){aD.removeClass(ai).removeClass(X).removeClass(A).removeClass(s);}aC.start=function(){Y.fire(f,{item:aD});if(!aE.one(r)&&!aE.one(ak)){aE.addClass(F);}};aC.end=function(){Y.fire(ap,{item:aD});aE.remove();aD.removeClass(ae);if(!o){aD.removeClass("y-pattern").removeClass("hover");}Y.repaint();};if(aA){aC.start();aE.setStyle("height","0px");aC.end();}else{aE.transition({height:"0px",duration:0.3,easing:"default",on:aC});}},fireItemInterestChange:function(aA,az,Y){this.fire(l,{interestObj:{"new":aA,current:az,type:"content",action:Y},item:this.currentItem,markFeedback:v});},onActionDrawerClick:function(Y){var aB=Y.target,az=aB.ancestor(u),aA=aB.ancestor(a,J),aD=w.isLoggedIn(),aC;Y.preventDefault();if(aA.test(G)){az.toggleClass(ai);this.currentItem.toggleClass(ai);if(aD){this.handleSaveClick(aA);}else{az.removeClass(X).removeClass(A);this.currentItem.removeClass(X).removeClass(A);}}else{if(aA.test(j)){this.handleSaveClick(aA);}else{if(aA.test(I)){az.toggleClass(X);this.currentItem.toggleClass(X);if(aD){this.handleLikeClick(aA);}else{aC=az.hasClass(X);this.fireItemInterestChange(aC?"0":"1",aC?"1":"0",X);az.removeClass(ai).removeClass(A);this.currentItem.removeClass(ai).removeClass(A);}az.removeClass(A);this.currentItem.removeClass(A);}else{az.toggleClass(A);this.currentItem.toggleClass(A);if(aD){this.handleDislikeClick(aA);}else{aC=az.hasClass(A);this.fireItemInterestChange(aC?"0":"-1",aC?"-1":"0",A);az.removeClass(ai).removeClass(X);this.currentItem.removeClass(ai).removeClass(X);}az.removeClass(X);this.currentItem.removeClass(X);}}}if(!aD){if(this.currentDrawer.test(Z)&&(!ac.nonPersonalStream||!aA.test(L))){this.showLoginBtns();}else{this.closeDrawer(this.currentDrawer);}}},buildFlagEntityList:function(){var aK=this.currentDrawer,aA=this.currentItem.getAttribute(c),aL=this.currentDrawer.one(".flag-content-form"),aH=this.currentDrawer.one(S),aD=this.currentDrawer.one(r),aE=this.currentDrawer.one(t),az=this.currentDrawer.one(ab),aI=this.currentDrawer.one(".no-entities"),aG=N.getItem(E)||{},aB=[],aF,Y=0,aC=0,aJ=this;if(aD&&aE&&aH){aD.remove();aE.remove();aH.remove();}if(this.timerInProcess){this.timerInProcess.cancel();this.timerInProcess=null;if(this.currentDrawer){if(this.currentDrawer.hasClass(X)){this.currentDrawer.removeClass(X);this.currentItem.addClass(X);}}if(aI){aI.remove();}}if(az){az.remove();}if(!o){this.currentItem.addClass("y-pattern").addClass("hover");aK.removeClass("dn");}aK.addClass(s);aF=af.getString("STR.ACTIONDRAWER.FLAGMENU");if(aF){aL=aK.append(aF);Y=120;}aB=aG[aA];if(aB&&aB.length>0){for(aC=0;aC<aB.length;aC++){aK.one('[value="'+aB[aC]+'"]').set("checked",true);}}this.currentDrawer.transition({height:Y+"px",duration:0.3,easing:"ease-in",on:{end:function(){aJ.repaint();}}});},onFlagItemClick:function(aC){var aE=aC.target,aB=aE.ancestor(R,J,ab),aD=aC.target.getAttribute("value"),aF=this.currentItem.getAttribute(c),aA=N.getItem(E)||{},az=[],Y=Q.merge(aq.getBeaconKeys(this.currentItem),{sec:"td-strm-dr",slk:aB.get("text"),elm:"inpt",elmt:"flag",itc:1,intl:ac.intl,action:aj});az=aA[aF]||[];if(aE.get(i)){Y.outcm="flagcat";if(az.indexOf(aD)<0){az.push(aD);}}else{Y.outcm="unflagcat";if(az.indexOf(aD)>-1){az.splice(az.indexOf(aD),1);}}aA[aF]=az;N.setItem(E,aA,at);aq.fireBeacon(Y);},repaint:function(){var Y=this.currentItem?this.currentItem.get("parentNode"):W;if(Q.UA.ie&&Q.UA.ie<8&&Y){Y._node.className=Y._node.className;}},makeSaveRequest:function(az,Y){if(!ax&&ac.listId){ax="LISTID:"+ac.listId;}af.makeRequest({type:"module",moduleId:T,args:{_action:"save",_subAction:az,noups:1,uuid:Y,mixerAction:ah,curFilter:ax}},{});},makeInterestRequest:function(Y){b.makeRequest({type:"module",moduleId:M,args:Q.merge({_action:"show"},Y)},{});}};Q.augment(y,Q.EventTarget);Q.namespace(U);Q[U][H]={name:"stream_action_drawer",getService:function(aA,az){var Y;b=aA.getService("transport_helper",az);af=aA.getModuleApi(az);aq=aA.getService("instrumentation");N=aA.getService("storage");w=aA.getService("userinfo");C=aA.getService("login",az);V=af.getService("interests");ac=af.getContextData();if((!Q.UA.android||Q.UA.android>=3)){Y=Q.one(".banner-wrapper")||Q.one(".type_masthead")||Q.one(".type_mastheadlite")||Q.one(".yog-hd");if(Y){aw=Y.get("offsetHeight");}}return new y();}};if(e){e.registerService(Q[U][H]);}},"1.0");/* Copyright (c) 2014, Yahoo! Inc.  All rights reserved. */
var yasearch,fxsearch;(function(){var T=null,G=true,v=false,S="undefined",r="ymobilizerouter",R="hidden",k="browser",af="showOnlySetHP",az="focus",j="SP",P="v=1&a=1",ap="v=1&a=0",C=5,Z=10,aa=5,ay="web",s="innerHTML",f="value",aq="title",b="action",Y="name",al="text",I="parentNode",ak="tagName",w="href",K="height",M="width",H="auto",u="disabled",ao="focus",n="blur",c="submit",aB="mouseover",h="click",ax="4em",J="8em",g="1.6",ab="hide-completely",an="ds-b",a="open",V="bottom",A="denabled",X="uenabled",E="selected",ad="sa-results",ac="ghosttext",d=".promo",Q=".stabs",t=".more-tab",ar=".input-query",ae=".search-form",au=".searchwrapper",aA=".searchwrapper-inner",x=".sa-window",B=".sa-drawer",W=".sa-results",aC=".aria-announce",O="px",ah="allow.redirected.ult.links",z="pa:ready",aj="search.tab.",N=".showdrawer",L=".showdrawerhandle",p={kr:G,jp:G,tw:G,cn:G},q="ulm:defaultlocation",av="ldw:defaultlocation",at="pmh:searchtext",ai="pmh:show",F="sayt:open",aw="sayt:close",ag="mh:web_srch_inp",y="AREA",o=150,e=1000,m=100,l="interactive",am="srch-pl",D="srch-pl-s",i="srch-plu",aD="srch-plu-s",U="$q";YModules.type_masthead={id:"",body:T,moduleapi:T,platform:T,instrumentation:T,tablistService:T,tablist:T,autoHide:T,autoHideId:T,paService:T,viewevents:[h,"keyup"],formData:T,dummyYLT:T,ywaObject:T,YWATracker:T,textboxBlurred:T,searchOverlayDiv:T,saConfig:{enabled:G,minQueryLength:0,queryDelay:0,containerOpen:v,timeoutId:T,abortId:T,cachedResults:T,delayedRequests:0,numResults:0,normalizationRules:T,isAutoOpen:v,isManualOpen:v,selectedIndex:-1,lastAnimHeight:0,lastVisibleItem:0,hideNavColEnable:0,hideNavColAnimationDuration:0,connectionPriming:{enabled:v,throttleRate:15000,beacon:null,beaconFunc:null}},currentTab:"",form:T,textbox:T,hood:T,saWindow:T,saDrawer:T,saResults:T,searchwrapperInner:T,searchwrapper:T,aria:T,secondInput:T,hiddenInputNodes:T,suggestions:T,searchQuery:"",lastSearchQuery:"",lastQueryLength:0,defLoc:"",currentSelectedListItem:T,menu:T,useFxjsonp:v,keyUpSupported:G,handleKeyUpObject:T,allowRedirectedULTLinks:G,ebayInputField:T,numberOfVisibleItems:C,horizontalPadding:"0",moreLink:T,displayNameInMoreDropDown:v,logoContainer:T,trendData:T,numCycles:0,ghostTextIndex:0,ghostTextCharPosition:1,ghostTextId:T,restartId:T,uraPromo:T,usingDoubleByte:v,ywaTrackingEnabled:0,setHomepageService:T,browser:"",compactFilter:false,compactDimensions:{},adPromoNodeHack:false,clearBtn:null,search_focused:false,search_wrapper:T,blur_interval:1000,blur_timer:T,init:function(aI){this.Y=aI.getService("yui");this.moduleapi=aI;this.hiddenInputNodes=[];this.id=aI.getId();this.platform=aI.getService("moduleplatform");this.instrumentation=aI.getService("instrumentation");this.defLoc=aI.getContextData("defLoc");this.currentTab=ay;this.preloadSRP=aI.getContextData("preloadSRP")?G:v;this.srpAssetURL=aI.getContextData("srpAssetURL");this.ywaTrackingEnabled=parseInt(aI.getContextData("ywaTrackingEnabled"),10);this.saytEnabled=parseInt(aI.getContextData("saytEnabled"),10);this.browser=aI.getContextData(k);this.compactFilter=aI.getContextData("search.filter.compact.enabled")?!!aI.getContextData("search.filter.compact.enabled"):false;this.saConfig.connectionPriming.enabled=aI.getContextData("sayt.connection.priming")?!!aI.getContextData("sayt.connection.priming"):false;this.clearBtn=this.Y.one("#btn-clear");if(aI.getContextData("visibleItems")){this.saConfig.lastVisibleItem=this.numberOfVisibleItems=parseInt(aI.getContextData("visibleItems"),10);this.saConfig.lastVisibleItem--;}if(this.moduleapi.getContextData("saData")){this.saConfig.hideNavColEnable=parseInt(this.moduleapi.getContextData("saData").hideNavColEnable,10);this.saConfig.hideNavColAnimationDuration=parseInt(this.moduleapi.getContextData("saData").hideNavColAnimationDuration,10);}var aF=aI.getContextData("saData"),aK=aF.cssSAWindowMaxHeightIE6,aJ=aI.getContextData("horizontalPadding"),aL=aF.cssSAWindowSuggestionHeightIE6,aE,aH,aG;this.tpcGif=aF.tpcGifUrl;this.horizontalPadding=aJ?aJ:"0";if(aK&&aK.length>0){J=aK;}if(aL&&aL.length>0){g=aL;}this.formData=aI.getContextData("formData");aI.listen(q);aI.listen(av);aI.listen(z);aE=aI.getProperty("channels");if(aE){aH=aE.length;for(aG=0;aG<aH;aG++){aI.listen(aE[aG]);}}aI.listen(ai);aI.listen(at);},onviewload:function(aL){if(aL==="default"){var aJ=this.moduleapi,aK=this.Y,aH,aF=aJ.getViewNode(aL),aI=aJ.getContextData("searchIntl")?aJ.getContextData("searchIntl").toLowerCase():T,aE=this.trendData=aJ.getContextData("trendData"),aG;aH=aJ.getContextData(af);this.usingDoubleByte=p[aI]?G:v;this.allowRedirectedULTLinks=aJ.getContextData(ah);this.useFxjsonp=aJ.getContextData("use.fxjsonp")?G:v;this.keyUpSupported=(aK.UA.gecko&&p[aI])?v:G;this.body=aF;this.searchOverlayDiv=this.Y.one("#search-overlay");this.form=aF.one(ae);aG=this.textbox=aF.one(ar);this.searchwrapper=aF.one(au);this.searchwrapperInner=aF.one(aA);this.aria=aF.one(aC);this.uraPromo=aF.one(d);if(aG.hasClass("ime-enabled")){aG.removeClass("ime-enabled");}if(this.saytEnabled){this.initSA();}this.form.on(c,this.handleSubmit,this);this.form.on(ao,this.handleFocus,this);this.form.on(n,this.handleBlur,this);this.search_wrapper=aF.one(".searchwrapper-border");aG.on(n,this.handleTextBlur,this);aG.on(ao,this.handleTextFocus,this);this.registerAutoHide();this.dummyYLT=aJ.getContextData("dummyYLT");if(!this.keyUpSupported){aG.on(ao,this.handleFFDoubleByte,this);aG.on(n,this.clearFFDoubleByte,this);}this.logoContainer=aF.one(".logo-container");if(aE){aG.blur();aG.on(ao,this.cancelGhostWriting,this,ac);this.numCycles=aJ.getContextData("numCycles");this.ghostTextId=aK.later(o,this,this.ghostWrite,aE,true);}}},handleFocus:function(aF){var aE=this.blur_interval;this.search_focused=true;if(this.search_wrapper){this.search_wrapper.addClass(az);if(this.blur_timer){this.blur_timer.cancel();}this.blur_timer=this.Y.later(aE,this,function(){this.search_focused=false;},false);}},handleBlur:function(aE){if(this.search_wrapper&&!this.search_focused){this.search_wrapper.removeClass(az);}},setMobilizer:function(){var aF="100%",aJ=document.documentElement.clientHeight+"px",aH=document.body.scrollTop||document.documentElement.scrollTop,aI=document.createElement("iframe"),aG="99999",aE=this.moduleapi.getContextData("locale"),aK=this.moduleapi.getContextData("mobilizerUrl");if(document.getElementById(r)){document.body.removeChild(document.getElementById(r));}aI.src=aK+"&lang="+aE;aI.setAttribute("id",r);aI.setAttribute("name",r);aI.setAttribute("allowTransparency","allowTransparency");aI.setAttribute("frameborder",0);aI.setAttribute("scrolling","no");aI.setAttribute("width",aF);aI.setAttribute("height",aJ);aI.style.position="absolute";aI.style.left="0px";aI.style.top=aH+"px";aI.style.zoom="1";aI.style.zIndex=aG;aI.style.overflow="hidden";aI.setAttribute("style","z-index:"+aG+";position:absolute;top:"+aH+"px;left:0px;width:"+aF+";height:"+aJ+";");document.body.appendChild(aI);if(typeof window.addEventListener!=S){window.addEventListener("message",this.closeMobilizer,v);}else{if(typeof window.attachEvent!=S){window.attachEvent("onmessage",this.closeMobilizer);}}},closeMobilizer:function(aE){if(aE.data=="closeYMBZ"){if(document.getElementById(r)){document.body.removeChild(document.getElementById(r));}}},hideOverlay:function(){this.overlay.addClass(R);},ghostWrite:function(aG){var aJ="",aF=this.textbox,aH=arguments.length,aL=this.ghostTextIndex,aE=this.ghostTextCharPosition,aI,aK;if(this.ghostTextIndex>=aH){aK=--this.numCycles;this.ghostTextIndex=this.ghostTextCharPosition=0;if(aK===0){this.cancelGhostWriting(T,ac);}}else{aI=arguments[aL].text;if(aI&&aE<aI.length+1){aJ=aI.substring(0,this.ghostTextCharPosition++);aF.set(f,aJ).addClass(ac);}else{this.ghostTextIndex++;this.ghostTextCharPosition=0;this.cancelGhostWriting();this.restartId=this.Y.later(e,this,this.restartGhostText);}}},restartGhostText:function(){this.ghostTextId=this.Y.later(o,this,this.ghostWrite,this.trendData,true);},cancelGhostWriting:function(aG,aF){var aH=this.ghostTextId,aE=this.restartId;if(aH||aE){if(aH){aH.cancel();aH=T;}if(aE){aE.cancel();aE=T;}if(aF){this.textbox.removeClass(aF);}}},initSA:function(){var aG=this.moduleapi,aE=this.saConfig,aF=aG.getContextData("saData");aE.minQueryLength=aF.minQueryLength;aE.queryDelay=aF.queryDelay;aE.normalizationRules=aF.normalizationRules;aE.lastVisibleItem=this.numberOfVisibleItems-1;aE.cachedResults={};aE.cachedResults[ay]={};if(this.Y.Cookie.get(j)===ap){aE.enabled=v;}yasearch=fxsearch=this.Y.bind(function(aH){this.handleSearch(aH);},this);this.createDropdown();},onviewunload:function(aG){var aE=this.textbox,aF=this.ghostWriteId;if(aF){aF.cancel();this.ghostWriteId=T;}this.closeDropdown();this.unregisterAutoHide();this.form.detach(c,this.handleSubmit);this.form.detach(ao,this.handleFocus);this.form.detach(n,this.handleBlur);aE.detach(n,this.handleTextBlur);if(!this.keyUpSupported){aE.detach(ao,this.handleFFDoubleByte);aE.detach(n,this.clearFFDoubleByte);}if(this.trendData){aE.detach(ao,this.cancelGhostWriting);}this.clearFFDoubleByte();this.body=this.paService=this.textbox=this.form=this.searchwrapper=this.searchwrapperInner=this.aria=this.hood=this.saWindow=this.saDrawer=this.secondInput=this.hiddenInputNodes=this.restartId=this.ghostTextId=this.logoContainer=this.trendData=this.formData=this.saConfig=T;},registerAutoHide:function(){var aH=this.id,aF=this.body,aG=this.Y,aE=this.moduleapi.getService("autohide");this.autoHideId=aE.register({targets:[this.hood,this.textbox,aF.getById(aH+"-masthead-stabs")],hide:aG.bind(this.closeDropdown,this)});this.autoHide=aE;},unregisterAutoHide:function(){var aE=this.autoHide;if(aE){aE.unregister(this.autoHideId);}},playLogoAnimation:function(){if(typeof Aniden!="undefined"&&Aniden.play){Aniden.play();}},createDropdown:function(){var aE=this.body,aG,aH,aF;aG=aE.one(".hood");aH=aG.one(x);aF=aG.one(B);this.hood=aG;this.saWindow=aH;this.saDrawer=aF;},openDropdown:function(){var aF=this.saConfig,aE=this.body,aI=this.saWindow,aK,aJ=this.moduleapi,aG=aE.one(".search-promo"),aL=this.Y,aH=this.saConfig.hideNavColEnable;aJ.broadcast(F);aJ.broadcast(l);if(aF.isAutoOpen===G){this.instrumentation.fireUltBeacon(this.formData[this.currentTab].bcnAutoOpen);aF.isAutoOpen=v;}if(aL.UA.ie===6&&aF.containerOpen===v){this.syncDropdown();}this.saDrawer.set("innerHTML",aJ.getString("STR.SA.TOGGLE.OFF"));aF.selectedIndex=-1;this.hood.addClass(a);aK=aI.get("offsetHeight");if(aK>aF.lastAnimHeight&&aF.containerOpen===v){aI.setStyle(K,"0");aI.transition({height:aK+"px",easing:"ease-out",duration:parseFloat(aJ.getContextData("saData").openAnimDuration)},this.Y.bind(this.afterDropdownOpened,this));aF.lastAnimHeight=aK;}aF.containerOpen=G;this.textbox.set(aq,aJ.getString("STR.SA.DROPDOWN.DESCRIPTION")).focus();aE.one(au+" .rc-bl").addClass(ab);aE.one(au+" .rc-br").addClass(ab);if(aG){if(aL.UA.ie&&aL.UA.ie<8){aG.addClass(ab);}else{aL.Node.getDOMNode(aG).style.zIndex=0;}}if(aH===1){this.showOrHideNavCol(false);}},closeDropdown:function(aG){var aF=this.moduleapi,aE=this.saConfig.hideNavColEnable;if(this.hood&&this.hood.hasClass("open")){this.saWindow.transition({height:0,easing:"ease-in",duration:parseFloat(aF.getContextData("saData").closeAnimDuration)});this.afterCloseDropdown(aG);if(aE===1){this.showOrHideNavCol(true);}}},showOrHideNavCol:function(aF){var aG=this.searchOverlayDiv||this.Y.one("#search-overlay"),aE;if(aG){aE=aG.get(I);if(this.Y.UA.ie&&this.Y.UA.ie<=8){return;}else{if(this.saConfig.hideNavColAnimationDuration>0){if(aF){aE.removeClass("search-overlay");aG.removeAttribute("style");}else{aE.addClass("search-overlay");aG.transition({duration:this.saConfig.hideNavColAnimationDuration,easing:"ease-out",opacity:0.7,"-moz-opacity":0.7,filter:"alpha(opacity=70)"});}}}}},afterDropdownOpened:function(){var aE=this.saWindow,aF=aE.get("offsetHeight");if(this.Y.UA.ie!==6){aE.setStyle(K,H);}else{aE.setStyle(K,aF+"px");}},afterCloseDropdown:function(aL){var aI=this.hood,aF=this.saConfig,aG=this.textbox,aE=this.body,aJ=this.moduleapi,aK=this.Y,aH=aE.one(".search-promo");this.moduleapi.broadcast(aw);this.saDrawer.set("innerHTML",aJ.getString("STR.SA.TOGGLE.ON"));this.saWindow.setStyle(K,H);aF.lastAnimHeight=0;aF.lastVisibleItem=this.numberOfVisibleItems-1;aI.removeClass(a);aF.containerOpen=v;aG.set(aq,this.formData[this.currentTab].button);if(!aL){aG.focus();if(!this.usingDoubleByte){aG.set(f,aG.get(f));}}aE.one(au+" .rc-bl").removeClass(ab);aE.one(au+" .rc-br").removeClass(ab);aI.detach(aB,this.handleMouseover);if(aK.UA.ie===6){document.getElementById(this.id+"-hood").style.width="";aI.addClass(an);}if(aH){if(aK.UA.ie&&aK.UA.ie<8){aH.removeClass(ab);}else{aK.Node.getDOMNode(aH).style.zIndex=6;}}aJ.broadcast(ag,aG.get(f));},syncDropdown:function(){var aI=this.saWindow,aG=this.searchwrapperInner,aF=this.hood,aJ,aE,aH=this.saConfig.numResults;aJ=parseFloat(aG.get("offsetWidth"))+2+O;aF.removeClass(an);aF.setStyle(M,aJ);if(!this.suggestions){aE=ax;}else{if(aH>this.numberOfVisibleItems){aE=J;}else{aE=g*aH+0.4+"em";}}aI.setStyle(K,aE);},highlightItem:function(aI,aH,aG,aJ){var aF=aI.item(aH),aK=aF.get("parentNode"),aE=this.currentSelectedListItem;if(aE){aE.removeClass(E);}aI.removeClass(E);aF.addClass(E);aK.addClass(E);this.currentSelectedListItem=aK;this.saConfig.selectedIndex=aH;if(!aG){this.textbox.set(f,aF.get(al));}},scroll:function(){var aK,aI=this.saConfig,aL=this.body,aE=this.id,aN=aI.lastVisibleItem+1,aG=aN-this.numberOfVisibleItems>0?aN-this.numberOfVisibleItems:0,aH=aL.getById(aE+"-arr-up"),aF=aL.getById(aE+"-arr-down"),aJ=aL.getById(aE+"-results"),aM=this.moduleapi,aO=aM.getContextData("saData").cssFontSizeSAYT;if(aO&&aO.length>0){aO=ad+" "+aO;}else{aO=ad;}aJ.set("className",aO);aG=aG>aN?aN:aG;if(aI.selectedIndex>=aN){aG++;}aJ.addClass(aN>this.numberOfVisibleItems?V+aG:"");if(aH){aK=this.numberOfVisibleItems-aN;if(aK===0||aK===1){aH.removeClass(X);}else{aH.addClass(X);}}if(aF){if(aI.numResults-aN===0){aF.removeClass(A);}else{aF.addClass(A);}}},scrollSelection:function(aH,aG){var aE=this.saConfig,aI=this.numberOfVisibleItems,aF;if(aG){aH=--aH;}aF=aI-(Z-1-aH);if(aE.numResults>aE.lastVisibleItem){if(aF<0){aE.lastVisibleItem=aI-1;}else{if(aF+aI<=Z){aE.lastVisibleItem=aF+aI-1;}else{if(aE.lastVisibleItem<aI){aE.lastVisibleItem++;}}}if(aE.numResults>aI){this.scroll();}}else{if(aG){aE.lastVisibleItem--;}}},moveSelectionDown:function(){var aE=this.saConfig,aG=aE.selectedIndex,aF=this.suggestions;if(aF&&aF.size()>0){if(aG<aE.numResults-1){aF.removeClass(E);this.highlightItem(aF,++aE.selectedIndex,v);this.scrollSelection(aG);}}},moveSelectionUp:function(){var aE=this.saConfig,aG=aE.selectedIndex,aF=this.suggestions;if(aG!==-1){aF.removeClass(E);if(aG===0){this.textbox.set(f,this.lastSearchQuery);aE.selectedIndex=-1;}else{this.highlightItem(aF,aE.selectedIndex===0?0:--aE.selectedIndex,v,G);this.scrollSelection(aG,G);}}},blurText:function(aE){var aF=aE.target;if(aF.get(f)===""){aF.set(f,aF.get("defaultValue"));}},resetSA:function(){var aF=this.saConfig,aE,aG=aF.containerOpen;this.suggestions=T;if(aF.enabled===G){aF.lastVisibleItem=this.numberOfVisibleItems-1;aF.numResults=0;aF.selectedIndex=-1;aF.isAutoOpen=v;aF.isManualOpen=v;aF.containerOpen=v;aE=this.body.getById(this.id+"-sa-info");if(aE){aE.setAttribute(w,this.formData[this.currentTab].yltInfoPage);}}if(aG){this.Y.later(150,this,this.resetHood);}else{this.resetHood();}},resetHood:function(){this.saWindow.set(s,this.moduleapi.getContextData(this.saConfig.enabled?"HTML_HOODCONTENT_ENABLED":"HTML_HOODCONTENT_DISABLED"));if(this.moduleapi.getContextData(aj+this.currentTab+L)){this.saDrawer.removeClass(ab);}},hideSA:function(){this.saDrawer.addClass(ab);},fireYodelBeacon:function(){var aE={sec:"ylogo",slk:"yodel",ltxt:"yodel",pos:0,own:"Y",ld:0,itc:1};this.instrumentation.fireUltBeacon(aE);},handleMouseover:function(aL){var aM=aL.target,aJ,aH,aN,aE,aI,aK=this.body.getById(this.id+"-results"),aG=this.suggestions,aF=aM.get(ak);if(aG){if((aF==="A"||aF==="STRONG")&&aK.contains(aM)){aE=aG.size();if(aF==="A"){aN=aM.get("id");aH=aM.get(al);}else{aH=aM.get(I).get(al);}for(aI=0;aI<aE;aI++){aJ=aG.item(aI);if(aN){if(aN==aJ.get("id")&&aH===aM.get(I).get(al)){this.highlightItem(aG,aI,G);break;}}else{if(aH===aJ.get(al)){this.highlightItem(aG,aI,G);break;}}}}else{aG.removeClass(E);}}},isYHSAction:function(){var aE=this.form.getAttribute(b);return(aE.indexOf("="+U)!==-1&&window.location.search.indexOf("yhs")!==-1);},submitYHS:function(aI,aH,aG){var aJ,aF,aE;this.Y.all(".srch-hidden").set(u,true);this.Y.use("querystring-parse",function(aK){aJ=aI.substr((aI.indexOf("?")+1),(aI.length-1));aF=aK.QueryString.parse(aJ);aK.each(aF,function(aM,aL){if(aM===U){aH.one(".input-query").setAttribute("name",aL);}else{aE=aK.Node.create('<input type="hidden">');aE.setAttribute("name",aL);aE.setAttribute("value",aM);aH.append(aE);}});aH.set("action",aI);aH.submit();});},onviewevent:function(aP,aV){if(aP==="default"){var aL=this.instrumentation,aK=this.body,aO=this.id,aT,aX=this.saResults,aS=this.currentTab,aR=this.formData[aS],aE=this.saConfig,aN=this.textbox,aI=this.secondInput,aU=aN.get(f),aG,aH,aY=aV.target,aM=aV.type,aJ="",aF=this.trendData,aW=aK.one(t),aQ=(aY===aN);this.searchQuery=aU;if(aQ){this.moduleapi.broadcast(l);}if(aM==="keyup"&&aQ){this.handleKeyUp(aV.keyCode);this.inputValueChange();}else{if(aM===h){aH=aK.one(Q);if(aH&&aH.contains(aY)){if(!aW||!aW.contains(aY)){aN.focus();if(this.Y.UA.ie===8){aN.set(f,aU);}}}if(this.search_wrapper){this.search_wrapper.addClass(az);}aJ=aY.get("id");aG=aY.get(ak);if(aG&&aG===y){this.fireYodelBeacon();}if(aJ){if(this.hood&&this.hood.contains(aY)&&aY.get(ak)==="A"&&aY.getAttribute(w).indexOf("ylt")===-1){aV.preventDefault();switch(aJ){case (aO+"-arr-up"):aL.fireUltBeacon(aR.bcnScroll);if(aY.hasClass(X)){aE.lastVisibleItem--;this.scroll();}break;case (aO+"-arr-down"):aL.fireUltBeacon(aR.bcnScroll);if(aY.hasClass(A)){aE.lastVisibleItem++;this.scroll();}break;case (aO+"-sa-drawer"):if(aE.containerOpen===G){aL.fireUltBeacon(aR.bcnDrawerClose);this.closeDropdown();}else{aL.fireUltBeacon(aR.bcnDrawerOpen);this.manualOpenDropdown();}break;case (aO+"-onswitch"):case (aO+"-sa-hintswitch"):this.toggleSA(true);break;case (aO+"-offswitch"):this.toggleSA(false);break;default:break;}}else{switch(aJ){case (aO+"-location"):if(aI.get(f)===aR.locationGhostText){aI.set(f,"");}break;case aO+"-close-overlay":aV.preventDefault();this.hideOverlay();break;case aO+"-mobilizer":aV.preventDefault();this.setMobilizer();break;default:break;}}}else{if(aF){aV.preventDefault();if(!aX){aX=this.saResults=aK.one(W);}if(aX&&aX.contains(aY)){this.beaconPreloadedSearch(aN.get(f),G);aT=aY.get(w);if(!aT){aT=aY.ancestor("A").get(w);}this.moduleapi.navigate(aT);}}}}}if(this.clearBtn&&aY.hasClass("btn-clear")){aV.preventDefault();this.emptyInputValue();}}},primeSearch:function(){var aE=this.saConfig.connectionPriming;if(aE.enabled){if(aE.beaconFunc===null){this.Y.use("yui-throttle",this.Y.bind(function(aF){aE.beaconFunc=aF.throttle(aF.bind(this.primeSearchConnection,this),aE.throttleRate);this.primeSearchConnection();},this));}else{aE.beaconFunc();}}},primeSearchConnection:function(){var aE=this.saConfig.connectionPriming,aF=new Date();aE.beacon=null;aE.beacon=new Image();aE.beacon.src=this.tpcGif+aF.getTime();},handleKeyUp:function(aM){var aK=this.aria,aH=this.moduleapi,aG=this.saConfig,aE=this.currentTab,aL=this.searchQuery,aI=aL.length,aF=this.lastQueryLength,aJ=this.srpAssetURL;if(this.preloadSRP&&aJ){this.Y.Get.script(aJ,{onSuccess:function(){this.preloadSRP=false;},context:this});}if(this.keyUpSupported){aL=this.textbox.get(f);aI=aL.length;if(aM==8){if(aI>aG.minQueryLength&&aG.enabled){if((aL&&aI>0)&&aL!=this.lastSearchQuery){this.sendQuery();}}else{this.closeDropdown();}}}switch(aM){case 13:break;case 27:if(aG.containerOpen===G){this.closeDropdown();}break;case 37:case 39:break;case 38:if(aG.enabled===G&&aG.containerOpen===G){this.clearFFDoubleByte();this.moveSelectionUp();}break;case 40:this.clearFFDoubleByte();if(aH.getContextData(aj+ay+N)){this.manualOpenDropdown();}break;default:if(aI===aF&&!this.keyUpSupported){break;}if(!this.keyUpSupported&&!this.handleKeyUpObject){this.handleFFDoubleByte();}if(aG.enabled===G){if(aI===0){aK.set(s,"<p></p>");this.closeDropdown();}else{if(aI>aG.minQueryLength){if(aG.timeoutId){aG.timeoutId.cancel();}if(aG.containerOpen===v){aG.isAutoOpen=G;}if(aE===ay){this.primeSearch();}aG.timeoutId=this.Y.later(aG.queryDelay,this,this.sendQuery);if(aG.containerOpen){aG.lastVisibleItem=this.numberOfVisibleItems-1;}}else{aK.set(s,"<p>"+aH.getString("STR.MASTHEAD.NO_SUGGESTION")+"</p>");if(aG.containerOpen){this.closeDropdown();}}}this.lastQueryLength=aI;}this.moduleapi.broadcast(ag,aL);break;}},manualOpenDropdown:function(){var aE=this.saConfig;if(aE.enabled===G){if(aE.containerOpen===v){if(this.searchQuery.length>aE.minQueryLength){aE.isManualOpen=true;this.sendQuery();}else{this.resetSA();this.openDropdown();}}else{if(this.suggestions){this.moveSelectionDown();}}}else{this.resetSA();this.openDropdown();}},toggleSA:function(aJ){var aK=this.instrumentation,aI=this.formData[this.currentTab],aE="yahoo.com",aH=new Date(),aG,aF;if(aJ===G){aG=P;aF="on";}else{aG=ap;aF="off";}aK.fireUltBeacon(aI.bcnOnOff);this.Y.Cookie.set(j,aG,{expires:aH.setDate(aH.getDate()+120),path:"/",domain:aE});this.saConfig.enabled=aJ;this.resetSA();this.closeDropdown();},handleSubmit:function(aM){aM.preventDefault();var aL=this.moduleapi,aG=this.saConfig,aI=this.trendData,aJ=this.body,aE=this.id,aO,aN,aH=this.textbox.get(f),aF=this.formData[this.currentTab],aK;if(aH.length===0){aM.preventDefault();return;}aG.enabled=v;if(this.ywaTrackingEnabled&&YWA!==null){this.ywaObject=YWA;}if(this.ywaTrackingEnabled&&this.ywaObject!==T){aK=this.moduleapi.getContextData("ywaProjectId")+"";this.YWATracker=this.ywaObject.getTracker(aK);this.Y.later(m,this,function(){if(this.YWATracker!==T){this.YWATracker.setAction("INTERNAL_SEARCH");this.YWATracker.setISK(aH);this.YWATracker.setISR("100");if(aH.length===0){this.YWATracker.setISR("0");}this.YWATracker.setDocumentGroup("Search");this.YWATracker.setDocumentName("Search Results");this.YWATracker.submit();}},T);}if(aI){this.beaconPreloadedSearch(this.textbox.get(f));}if(aG.selectedIndex!==-1){this.setFRCode(true);aO=aJ.getById(aE+"-results").all("li a");aN=aO.item(aG.selectedIndex).get(w);if(aI){this.Y.later(m,this,function(){this.moduleapi.navigate(aN);},aN);}else{aL.navigate(aN);}}else{this.setFRCode(false);if(aI){this.Y.later(m,this,function(){this.form.submit();},T);}else{if(this.isYHSAction()){this.submitYHS(aF.action,this.form,aH);}else{this.form.set("action",aF.action);this.form.submit();}}}},handleTextBlur:function(){this.textboxBlurred=true;this.aria.set(s,"<p></p>");},handleTextFocus:function(){this.textboxBlurred=false;},sendQuery:function(){if(this.moduleapi.getContextData(aj+this.currentTab+N)&&this.saytEnabled){var aI=this.saConfig,aJ=this.moduleapi,aO=this.searchQuery,aK=""+aO,aN=aK.replace(/%20/g," "),aG=this.currentTab,aE=aI.cachedResults[aG][aN],aH,aL=0,aM,aF;if(typeof aE==="object"){aI.numResults=aE.length;this.populateList(aE);if(aO.length>aI.minQueryLength&&aI.numResults>0||aI.isManualOpen){this.openDropdown();}}else{if(aI.delayedRequests<aa){aK=encodeURIComponent(aK.replace(/"/g,""));aH=aJ.getContextData("saData").webGossipUrl;aL=aJ.getContextData("saData").newWebGossipUrlEnable;if(aK.length>0){aM=aH+aK;if(aL==1){aF=this.textbox.get("selectionStart");if(aF<aN.length){aM+="&ipos="+aF;}}aI.abortId=this.Y.Get.script(aM,{timeout:1000,onTimeout:this.Y.bind(this.increaseDelayedRequests,this)});}}}this.lastSearchQuery=""+aO;}},increaseDelayedRequests:function(){this.saConfig.delayedRequests++;},handleSearch:function(aE){var aG=[],aF=this.saConfig,aH=this.useFxjsonp?aE[1].length:aH=aE.r.length;aF.numResults=aH;aG=this.formatResults(aE);if(this.useFxjsonp){aF.cachedResults[this.currentTab][aE[0]]=aG;}else{aF.cachedResults[this.currentTab][aE.q]=aG;}this.populateList(aG);if(this.searchQuery.length>aF.minQueryLength&&aH>0){this.openDropdown();}},populateList:function(aU){var aG=this.Y.DOM,aS=this.id,aI=this.moduleapi,aE=this.saConfig,aW=this.formData,aX=this.currentTab,a0=aW[aX],aK=this.aria,aP=this.body,aV=aG.byId(aS+"-sayt"),aQ=aU.length,aF=aI.getContextData("frCode"),aO=aI.getContextData("typeCode"),aZ=aO?"type="+aO+"&":"",aR="",a2="",aM="",aY,aL="",a1,aT,aN,aH,aJ=/<\S[^><]*>/g;if(aQ>0){aK.set(s,"<p>"+aI.getString("STR.MASTHEAD.HAS_SUGGESTION")+"</p>");if(!aV){this.resetHood();aV=aG.byId(aS+"-sayt");}aR=aI.getContextData("ilcValue")?"ilc="+aI.getContextData("ilcValue")+"&":"";aV.innerHTML=aI.getContextData("HTML_RESULTSLIST");a1=document.getElementById(aS+"-results");a2=aI.getContextData("searchTracking")?aI.getContextData("searchTracking")+"&":"";for(aY=0;aY<aQ;aY++){if(this.useFxjsonp){if(!this.isYHSAction()){aM="?fr="+aF+"-s&toggle=1&"+aZ+aR+a2+"cop=mss&ei=UTF-8"+aL+"&p="+encodeURIComponent(aU[aY].replace(aJ,""));}else{aM=a0.yltClickSuggestion.replace(U,encodeURIComponent(aU[aY].replace(aJ,"")));}a1.innerHTML+=aI.getContextData("HTML_RESULTSITEM");aT=a1.lastChild.firstChild;aT.href=a0.yltClickSuggestion+aM;aT.innerHTML=aU[aY];}else{aN=aU[aY].formattedResults;if(!this.isYHSAction()){aM="?fr="+aF+"-s&toggle=1&"+aZ+aR+a2+"cop=mss&ei=UTF-8"+aL+"&p="+encodeURIComponent(aN.replace(aJ,""));}else{aM=a0.yltClickSuggestion.replace(U,encodeURIComponent(aN.replace(aJ,"")));}a1.innerHTML+=aI.getContextData("HTML_RESULTSITEM");aH=a1.lastChild;aT=aH.firstChild;if(this.isYHSAction()){aT.href=aM;}else{aT.href=a0.yltClickSuggestion+aM;}aT.innerHTML=aN;}}if(aE.numResults>this.numberOfVisibleItems){aV.innerHTML+=aI.getContextData("HTML_RESULTS_SCROLLARROWS");}this.suggestions=aP.getById(aS+"-results").all("li a");if(this.Y.UA.ie===6){this.syncDropdown();}this.hood.on(aB,this.handleMouseover,this);}else{if(this.suggestions||!this.saWindow.one("ul")){this.resetSA();this.closeDropdown();aK.set(s,"<p>"+aI.getString("STR.MASTHEAD.NO_SUGGESTION")+"</p>");}this.suggestions=T;}},formatResults:function(aK){var aU=this.saConfig.normalizationRules,aL,aT,aO,aJ=aU.length,aI,aM,aH,aG,aF,aP,aS=[],aN,aQ,aE,aR;if(this.useFxjsonp){aT=this.Y.Lang.trim(this.normalize(aK[0].toUpperCase()));aO=aK[1].length;}else{aL=aK.r;aT=this.Y.Lang.trim(this.normalize(aK.q));aO=aL.length;}aT=aT.replace(/\(+/g,"").replace(/\)+/g,"").replace(/\{+/g,"").replace(/\}+/g,"").replace(/\[+/g,"").replace(/\]+/g,"").replace(/\\+/g,"");aG=aT.split("");aI=aG.length-1;while(aI-->0){aN=aG[aI+1];switch(aG[aI]){case"A":if(aG[aI+1]==="E"){aG[aI]="AE";}break;case"O":if(aG[aI+1]==="E"){aG[aI]="OE";}break;case"U":if(aG[aI+1]==="E"){aG[aI]="UE";}break;case"T":if(aG[aI+1]==="H"){aG[aI]="TH";}break;case"S":if(aG[aI+1]==="S"){aG[aI]="SS";}break;default:break;}if(aG[aI].length>1){aG.splice(aI+1,1);}}aM=aG.length;while(aM-->0){while(aJ-->0){if(aG[aM]===aU[aJ][0]){aG[aM]="("+aU[aJ][1]+")";}}aJ=aU.length;}aF="("+aG.join("")+")";aF=aF.replace(/(\$|\^|\*|\+|\?|\\|\[|\]\{|\}\|\|)/g,"\\$1");aP=new RegExp(aF,"i");for(aH=0;aH<aO;aH++){aR=this.useFxjsonp?aK[1][aH]:aL[aH][0];aE=(aP)?aR.replace(aP,"<strong>$1</strong>"):aK[1][1];if(this.useFxjsonp){aS[aH]=aE;}else{aQ=aL[aH][3];aS[aH]={formattedResults:aE,suid:aQ};}}return aS;},normalize:function(aE){var aG=this.saConfig.normalizationRules,aF=aG.length-1;while(aF--){aE=aE.replace(new RegExp(aG[aF][1],"g"),aG[aF][0]);}return aE;},setFRCode:function(aE){var aG=this.body.getById(this.id+"-frcode"),aF=this.moduleapi.getContextData("frCode");if(aG){aG.set(f,aE?aF+"-s":aF);}},removeYLT:function(aF){var aE=aF.lastIndexOf("http");return aF.substr(aE,aF.length);},saveSetting:function(aF,aG){var aE={type:"module",moduleId:this.id,args:{_action:"save",_subAction:aF,value:aG}},aH={success:function(aJ,aI){},failure:function(aJ,aI){},scope:this};this.moduleapi.makeRequest(aE,aH);},onmessage:function(aG,aF,aI){var aL=this.body,aJ=this.secondInput,aM=aI?aI.displayName:T,aN,aH,aK,aE;if((aG===q||aG===av)&&aM){this.defLoc=aM;if(aJ){aJ.set(f,aM);}aN=aL.getById(this.id+"-weather");if(aN){aH=aN.next();if(aH){aH.set(s,aM.substring(0,aM.indexOf(",")));}}}else{if(aG.substr(0,5)==="/user"){aK=aG.substr(aG.lastIndexOf("/")+1);aE=aL.getById(this.id+"-"+aK);if(aE){aE.set(s,aI.data);aE.removeClass(ab);}}else{if(aG===at){if(true===this.textboxBlurred){this.textbox.focus();this.textbox.set(f,aI);}}else{if(aG===ai){this.closeDropdown(true);if(this.textbox.get(f)){this.moduleapi.broadcast(ag,this.textbox.get(f));}}}}}},getEms:function(aF){var aE,aG,aH=this.Y;aE=aF.appendChild(document.createElement("div"));aE.setStyle("height","1em");aE.setStyle("width","1em");aG=aH.DOM.region(aH.Node.getDOMNode(aE));aE.remove();return aG;},handleFFDoubleByte:function(){this.handleKeyUpObject=this.Y.later(500,this,this.handleFFDoubleByteKeyUp,T,G);},handleFFDoubleByteKeyUp:function(){var aE;this.searchQuery=this.textbox.get(f);if(this.searchQuery!=this.lastSearchQuery){aE=this.saConfig;aE.timeoutId=this.Y.later(aE.queryDelay,this,this.sendQuery);}this.handleKeyUp();},clearFFDoubleByte:function(){if(this.handleKeyUpObject){this.handleKeyUpObject.cancel();}this.handleKeyUpObject=T;},createHiddenInputFieldForTab:function(aF,aH){var aG=this.body.getById(this.id+"-p"),aE=aG.get(I),aI=aE.create("<input type='hidden'>");if(aF&&aH){aI.setAttribute(Y,aF);aI.setAttribute(f,aH);}return aE.insertBefore(aI,aG);},removeYNode:function(aE){if(aE){aE.get(I).removeChild(aE);}},removeHiddenInputFields:function(){var aE,aF=0,aG=this.hiddenInputNodes;if(aG){aF=aG.length;for(aE=aF-1;aE>=0;aE--){this.removeYNode(aG[aE]);aG[aE]=T;}}},disableHiddenInputField:function(aF){var aE=this.body.getById(aF);if(aE){aE.set(u,G);}},updateLandingPage:function(){var aE,aF,aG,aH=this.formData[this.currentTab];if(aH.noQueryURL){aF=this.form;aG=aF.getAttribute(b);aE=this.extractURL(aG);if(this.searchQuery.length===0){aG=aG.replace(aE,aH.noQueryURL);}else{aG=aG.replace(aE,this.extractURL(aH.action));}aF.setAttribute(b,aG);}},extractURL:function(aF){var aG,aE=T;if(aF){aG=aF.indexOf("http://");if(aG===-1){aG=0;}aE=aF.substr(aG,aF.length);}return aE;},isStringInArray:function(aG,aH){var aF,aI,aE=v;if(aG&&aH){aF=aH.length;aI=aG.toLowerCase();while(aF--){if(aI===aH[aF].text.toLowerCase()){aE=G;break;}}}return aE;},isArrayStringInString:function(aG,aH){var aF,aI,aE=v;if(aG&&aH){aF=aH.length;aI=aG.toLowerCase();while(aF--){if(aI.indexOf(aH[aF].text.toLowerCase())>-1){aE=G;break;}}}return aE;},beaconPreloadedSearch:function(aF,aI){var aH={slk:"sa_link",pos:1,own:"Y",ld:0,itc:0},aE=this.trendData,aG=this.hood.hasClass(a);if(aG){if(this.isStringInArray(aF,aE)){aH.sec=D;aH.ltxt=aF;}else{if(this.isArrayStringInString(aF,aE)){aH.sec=aD;aH.ltxt="sa_click";}}}else{aH.slk="btn";if(this.isStringInArray(aF,aE)){aH.sec=am;aH.ltxt=aF;}else{if(this.isArrayStringInString(aF,aE)){aH.sec=i;aH.ltxt="srch-"+this.currentTab;}}}if(aH.sec){this.instrumentation.fireUltBeacon(aH);}},inputValueChange:function(aE){if(this.clearBtn){if(this.textbox.get("value")){if(!this.clearBtn.hasClass("enabled")){this.clearBtn.addClass("enabled");}}else{this.clearBtn.removeClass("enabled");}}},emptyInputValue:function(){var aE=this.textbox||this.body.one(ar);if(this.clearBtn&&aE){this.clearBtn.removeClass("enabled");aE.set("value","");aE.focus();}}};})();/* Copyright (c) 2014, Yahoo! Inc.  All rights reserved. */
