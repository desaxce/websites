
define('gdt:comm/comm.js',function(require,exports,module){var J=require("jquery");var Util={getTime:function(){return+new Date();},getParameter:function(name,cancelBubble){var r=new RegExp("(\\?|#|&)"+name+"=([^&#]*)(&|#|$)");var m=location.href.match(r);return(!m?"":m[2]);},tmpl:(function(){var cache={};function tmpl(str,data){var fn=!(/\W/).test(str)?cache[str]=cache[str]||tmpl(document.getElementById(str).innerHTML):new Function("obj","var p=[],print=function(){p.push.apply(p,arguments);};"+"with(obj){p.push('"+
str.replace(/[\r\t\n]/g," ").split("<%").join("\t").replace(/((^|%>)[^\t]*)'/g,"$1\r").replace(/\t=(.*?)%>/g,"',$1,'").split("\t").join("');").split("%>").join("p.push('").split("\r").join("\\'")
+"');}return p.join('');");return data?fn(data):fn;}
return tmpl;})()};(function(){var CssFileUrlCache={};var plugin={insertCSSLink:function(url,opts){var sid,doc,t,cssLink,head;if(CssFileUrlCache[url]){return;}
if(typeof opts=="string"){sid=opts;}
opts=(typeof opts=="object")?opts:{};sid=opts.linkID||sid;doc=opts.doc||document;head=doc.getElementsByTagName("head")[0];cssLink=((t=doc.getElementById(sid))&&(t.nodeName=="LINK"))?t:null;if(!cssLink){cssLink=doc.createElement("link");sid&&(cssLink.id=sid);cssLink.rel=cssLink.rev="stylesheet";cssLink.type="text/css";cssLink.media=opts.media||"screen";head.appendChild(cssLink);}
try{url&&(cssLink.href=url);}catch(ign){}
CssFileUrlCache[url]=true;},insertStyleSheet:function(sheetId,rules){var node=document.createElement("style");node.type='text/css';sheetId&&(node.id=sheetId);document.getElementsByTagName("head")[0].appendChild(node);if(rules){if(node.styleSheet){node.styleSheet.cssText=rules;}else{node.appendChild(document.createTextNode(rules));}}
return node.sheet||node;}};J.extend(plugin);J.extend(Util);})();var Helper={getPerpageByPosCfg:function(poscfg){var cfg=poscfg&&poscfg.playcfg||{},hnum,wnum;hnum=cfg.hnum||1;wnum=cfg.wnum||1;return hnum*wnum;},poller:function(pollopts){var pl,polltime=pollopts.polltime,pollcount=pollopts.pollcount,container=pollopts.container,numcn=pollopts.numcn,numtag=pollopts.numtag||'',direction=pollopts.direction,pollobjcn=pollopts.pollobjcn;pl=new GDT.Poller(polltime,pollcount);pl.onflip=function(num){var setCurrentnum=pollopts.setCurrentnum||Helper.setCurrentnum;setCurrentnum(num,pollopts);pollopts.onflip&&pollopts.onflip(num,pollopts);};pl.play();container=J('#'+container);container.find('.'+numcn+' '+numtag).hover(function(evt){var target,index;target=J(this);index=parseInt(target.attr('gdtoid'),10);if(!isNaN(index)){pl.setFrame(index);}
pl.pause();},function(evt){pl.goon();});var hov=function(obj){obj.hover(function(evt){pl.pause();},function(evt){pl.goon();});};hov(container.find('.'+pollobjcn));if(pollcount>1){container.find('.'+numcn).show();}else{pl.pause();}
if(direction){pl.goDirect=function(dir){if(!dir){return;}
dir=(dir==1)?1:-1;var curPoll=(pl.prePoll+dir+pl.pollNum)%pl.pollNum;pl.curPoll=curPoll;pl.setFrame(curPoll);};if(direction.left){var l=container.find("."+direction.left);l.bind('click',function(){pl.goDirect(-1);});hov(l);}
if(direction.right){var r=container.find("."+direction.right);r.bind('click',function(){pl.goDirect(1);});hov(r);}}
return pl;},setCurrentnum:function(num,pollopts){var hightlightcn=pollopts.hightlightcn||'current',container=pollopts.container,numcn=pollopts.numcn,numtag=pollopts.numtag||'',pollobjcn=pollopts.pollobjcn,container=pollopts.container;container=J('#'+container);container.find('.'+numcn+' '+numtag).removeClass(hightlightcn).eq(num).addClass(hightlightcn);container.find('.'+pollobjcn).hide().eq(num).show();},pinged:{},ping:function(num,pollopts){var str,cda={},nums,perpage,posId,data,poscfg;opts=pollopts||{};polldata=opts.data;if(!polldata){return;}
perpage=polldata.perpage||1;data=polldata.list;var tmp=data.slice(num*perpage,num*perpage+perpage);J.each(tmp,function(k,cda){if(!Helper.pinged[cda.cl]){posId=cda.posId||polldata.posId;GDT.view(posId,cda.cl);Helper.pinged[cda.cl]=1;}});},showLogo:function(cnt){var container=cnt?J('#'+cnt):J(document.body);J('<a class="logo-arrow" title="广点通  腾讯效果推广" href="http://e.qq.com/" target="_blank"></a>').appendTo(container);},showClose:function(cnt){var container=cnt?J('#'+cnt):J(document.body);J('<a href="javascript:;" class="icon-close">关闭</a>').appendTo(container);}}
var comm={Util:Util,Helper:Helper}
module.exports=comm;});;define('gdt:comm/clickmanage.js',function(require,exports,module){var J=require('jquery'),Util=require('gdt:comm/comm.js').Util;var PageClickManage={none:-999,entertime:0,bindFrameevent:function(){var cm=GDT.ClickManage;J(document.body).hover(function(evt){cm.entertime=Util.getTime();});},init:function(){PageClickManage.bindFrameevent();GDT.ClickManage.mouseover=function(){};GDT.ClickManage.setPoscn('_js_pos_container');require.async(['gdt:comm/manage.js'],function(Manage){GDT.ClickManage.getDisplayedTime=Manage.getDisplayedTime;});}};module.exports=PageClickManage;});;define('gdt:comm/manage.js',function(require,exports,module){var commMod=require('gdt:comm/comm.js'),PageClickManage=require('gdt:comm/clickmanage.js');var Util=commMod.Util,Helper=commMod.Helper;var J=require("jquery");var Manage={lastFrameTime:0,getDisplayedTime:function(){var now=Util.getTime();return now-Manage.lastFrameTime;},getDisplayDimensions:function(){return{w:parseInt(Util.getParameter('width'),10),h:parseInt(Util.getParameter('height'),10)};},renderImgTxt:function(posId,o){var tplTxt,tplImg,logotpl,rs='',data,w='100%',h='100%',cda={},ellist=[],htmlstr;tplImg='<div class="sns_img"> <a  {olink} class="img_link"><img src="{img}" alt="{txt}" width="{w}" height="{h}" /></a> </div>';tplTxt='<div class="sns_txt" style="width:{w}px"> <p><a  {olink}>{txt}</a></p> </div>';data=o.data[0];data.img&&(rs+=tplImg);data.txt&&(rs+=tplTxt);GDT.mix(cda,data);GDT.mix(cda,o.cfg.playcfg);J.insertCSSLink('./css/imgtxt.css');htmlstr=['<div class="mod_sns _js_pos_container" id="container">','<div class="sns_inner">'+GDT.format(rs,cda)+'</div>','</div>'].join('\r\n');J(htmlstr).appendTo(J(document.body));Helper.showLogo('container');Manage.updateFrameTime();GDT.view(posId,data.cl);},config:{polltime:5000,BORDERWIDTH:2,BORDERHEIGHT:2,defaultAdUrl:'gdt:mod/default.js'},renderPoll:function(posId,o){var data,i,len,da,numarr=[],str,container,oda={},pl,pdata={},poscfg,playcfg,polltime=Manage.config.polltime,tpl=['<div class="ads-blk-border"  style="width: <%=cfg.bpw%>px;height: <%=cfg.bph%>px;">','<div class="<%=containerclass%> _js_pos_container" id="container">','<span>','<% var len = pages;   for (var i = 0; i < len; i++) { %>','<span class="__js_crtcnt" gdtoid="<%=i%>" style="display: none;">','<% for(var j=0; j<perpage; j++ ) { var index = i*perpage+j; var da = data[index]; if(!da) {break;} %>','<a <%=da.olink%>"><img src="<%=da.img%>" width="<%=cfg.w%>" height="<%=cfg.h%>" /></a>','<% }  %>','</span>','<% }  %>','</span>','<div class="<%=numclass%> __js_numlist" style="display: none;">','<% var len = pages;  for (var i = 0; i < len; i++) { %>','<span gdtoid="<%=i%>" style="cursor: pointer;"></span>','<% } %>','</div>','</div>','</div>',].join('\r\n');Manage.insertCSS();data=o.data;len=data.length;poscfg=o.cfg||{};playcfg=poscfg.playcfg||{};pdata.data=data;pdata.numclass=(playcfg.w>200&&playcfg.h>200)?"foucs_num_b":"foucs_num_s";pdata.numclass='foucs_num_b';playcfg.wnum=playcfg.wnum||1;playcfg.hnum=playcfg.hnum||1;pdata.perpage=Helper.getPerpageByPosCfg(o.cfg);pdata.pages=Math.ceil(len/pdata.perpage);pdata.containerclass=(playcfg.hnum==playcfg.wnum)?'ads-blk':(playcfg.hnum>playcfg.wnum?'ads-blk-db02':'ads-blk-db01');pdata.cfg=playcfg;pdata.cfg.bph=pdata.cfg.ph-Manage.config.BORDERHEIGHT;pdata.cfg.bpw=pdata.cfg.pw-Manage.config.BORDERHEIGHT;J(J.tmpl(tpl,pdata)).appendTo(J(document.body));Helper.poller({polltime:Manage.config.polltime,pollcount:pdata.pages,container:'container',pollobjcn:'__js_crtcnt',numcn:'__js_numlist',numtag:'span',onflip:function(num,pollopts){Manage.updateFrameTime();Helper.ping(num,pollopts);},data:{posId:posId,list:data,perpage:pdata.perpage,poscfg:playcfg}});Helper.showLogo('container');},renderTips:function(posId,o){var poscfg,data,len,pdata={},tpl=['<div class="ads-blk-tips _js_pos_container" id="container" style="">','<a <%=data.olink%>><img src="<%=data.img%>" alt="广告物料" width="<%=cfg.w%>" height="<%=cfg.h%>"></a>','</div>'].join('\r\n');Manage.insertCSS();data=o.data;len=data.length;poscfg=o.cfg.playcfg;pdata.data=data[0];pdata.cfg=poscfg;J(J.tmpl(tpl,pdata)).appendTo(J(document.body));Manage.updateFrameTime();GDT.view(posId,pdata.data.cl);Helper.showLogo('container');Helper.showClose();},insertCSS:function(){J.insertCSSLink('./css/style.css');},imgToSpeedTest:function(){J('#container img').on('load',function(evt){var url=J(this).attr("src");setTimeout(function(){require.async("gdt:mod/stat.js",function(stat){stat.resourceTimeTest(url);});},0);});},updateFrameTime:function(){Manage.lastFrameTime=Util.getTime();},prepareAndRender:function(pid,o,opts){var type=opts.type;PageClickManage.init();var data=[],poscfg,perpage,w,h,_render,dim=Manage.getDisplayDimensions();if(o&&o.ret){data=o.data;poscfg=o.cfg;}else{o.data=data;}
_render=function(o){var showtype=o.cfg&&o.cfg.showtype;if(showtype==='tips'){Manage.renderTips(pid,o);}else{if(o.data&&o.data.length==1&&o.data[0].img&&o.data[0].txt){Manage.renderImgTxt(pid,o);}else{Manage.renderPoll(pid,o);}}
Manage.imgToSpeedTest();};if(!poscfg){w=dim.w;h=dim.h;perpage=1;o.cfg={showtype:type,playcfg:{pw:w,ph:h,w:w,h:h}};}else{w=poscfg.playcfg.w;h=poscfg.playcfg.h;perpage=Helper.getPerpageByPosCfg(poscfg);}
if(data.length<perpage||data.length%perpage!=0){var remain=perpage-(data.length%perpage);require.async(Manage.config.defaultAdUrl,function(def){var remainlist=[],defaultAds;defaultAds=def.list[w+'_'+h];if(defaultAds){remainlist=defaultAds.slice(0,remain);o.data=o.data.concat(remainlist);}
_render(o);});}else{_render(o);}},pinged:{},init:function(){var pid=Util.getParameter('posid'),type=Util.getParameter('type');if(isNaN(pid)){return;}
if(type!='ecc'){GDT.load({posId:pid,context:{common:{title:encodeURIComponent(decodeURIComponent(Util.getParameter('title'))),url:encodeURIComponent(decodeURIComponent(Util.getParameter('url')))}},onComplete:function(o){Manage.prepareAndRender(pid,o,{type:type});}});}else{var dealer=require("gdt:mod/preset.js");dealer.init(pid);}
GDT.timepot.push(+new Date);require.async('gdt:mod/stat.js',function(stat){stat.report(GDT.timepot);})}};module.exports=Manage;});